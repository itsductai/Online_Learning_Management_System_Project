{"question":"List all accounts.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts;"}
{"question":"Show full names and emails of all users.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT FullName, Email FROM Accounts;"}
{"question":"Get active accounts only.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE IsActive = 1;"}
{"question":"Return all categories.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT * FROM Categories;"}
{"question":"Show category codes and names.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT Code, Name FROM Categories;"}
{"question":"List all courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses;"}
{"question":"Display published courses only.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE IsPublished = 1;"}
{"question":"Return titles and difficulty for all courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Title, Difficulty FROM Courses;"}
{"question":"List all lessons.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons;"}
{"question":"Get only quiz-type lessons.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons WHERE LessonType = N'quiz';"}
{"question":"Show all quizzes.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT * FROM Quizzes;"}
{"question":"Return quiz titles with total questions.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT Title, TotalQuestions FROM Quizzes;"}
{"question":"Show text of questions and correct option.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);","answer":"SELECT Question, CorrectOption FROM QuizQuestions;"}
{"question":"List all enrollments.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments;"}
{"question":"Get only completed enrollments.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE IsCompleted = 1;"}
{"question":"Show all quiz attempts.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts;"}
{"question":"Return attempt scores and submitted time.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Score, SubmittedAt FROM QuizAttempts;"}
{"question":"Show only ratings from reviews.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT Rating FROM CourseReviews;"}

{"question":"Find accounts created today (UTC).","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE CAST(CreatedAt AS DATE) = CAST(SYSUTCDATETIME() AS DATE);"}
{"question":"Get top 5 newest accounts.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT TOP (5) * FROM Accounts ORDER BY CreatedAt DESC;"}
{"question":"Find all instructors.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE Role = N'Instructor';"}
{"question":"Search accounts whose name contains 'Nguyễn'.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE FullName LIKE N'%Nguyễn%';"}
{"question":"Find categories whose code starts with 'CAT1'.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT * FROM Categories WHERE Code LIKE N'CAT1%';"}
{"question":"Return courses cheaper than 150000 VND.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE Price < 150000;"}
{"question":"Get advanced courses only.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE Difficulty = N'advanced';"}
{"question":"Find courses with 'SQL' in the title.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE Title LIKE N'%SQL%';"}
{"question":"Show lessons ordered by newest first.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons ORDER BY CreatedAt DESC;"}
{"question":"List only video lessons.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons WHERE LessonType = N'video';"}
{"question":"Find quizzes with at least 3 questions.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT * FROM Quizzes WHERE TotalQuestions >= 3;"}
{"question":"Search questions that mention 'JOIN'.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);","answer":"SELECT * FROM QuizQuestions WHERE Question LIKE N'%JOIN%';"}
{"question":"Find enrollments with progress over 70%.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE ProgressPercent > 70;"}
{"question":"Get enrollments registered this month (UTC).","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE YEAR(EnrolledOn) = YEAR(SYSUTCDATETIME()) AND MONTH(EnrolledOn) = MONTH(SYSUTCDATETIME());"}
{"question":"Show attempts with score >= 80.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE Score >= 80;"}
{"question":"Return attempts submitted today.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE CAST(SubmittedAt AS DATE) = CAST(SYSUTCDATETIME() AS DATE);"}
{"question":"Get reviews with 5-star rating.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE Rating = 5;"}
{"question":"Find reviews that contain the word 'hữu ích'.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE Comment LIKE N'%hữu ích%';"}
{"question":"Top 10 most recent reviews.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT TOP (10) * FROM CourseReviews ORDER BY CreatedAt DESC;"}

{"question":"List courses with their category names (join 1 table).","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT c.CourseId, c.Title, g.Name AS CategoryName FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId;"}
{"question":"Show courses and their instructor names.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT c.CourseId, c.Title, a.FullName AS InstructorName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId;"}
{"question":"List lessons with course titles.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT l.LessonId, l.Title AS LessonTitle, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId;"}
{"question":"Return quizzes with their lesson titles.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT q.QuizId, q.Title AS QuizTitle, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId;"}
{"question":"Get quiz questions with quiz titles.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT qq.QuestionId, qq.Question, q.Title AS QuizTitle FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId;"}
{"question":"Show enrollments with account names.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT e.EnrollmentId, a.FullName, e.CourseId, e.ProgressPercent FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId;"}
{"question":"List enrollments with course titles (one join).","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT e.EnrollmentId, e.AccountId, c.Title AS CourseTitle, e.IsCompleted FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId;"}
{"question":"Return attempts with account names.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT qa.AttemptId, a.FullName, qa.Score FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId;"}
{"question":"Return attempts with quiz titles.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT qa.AttemptId, q.Title AS QuizTitle, qa.Score FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId;"}
{"question":"Show course reviews with course titles.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT r.ReviewId, c.Title AS CourseTitle, r.Rating FROM CourseReviews r JOIN Courses c ON r.CourseId = c.CourseId;"}
{"question":"List course reviews with reviewer names.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT r.ReviewId, a.FullName, r.Rating FROM CourseReviews r JOIN Accounts a ON r.AccountId = a.AccountId;"}
{"question":"Get lessons with their instructor names (via course, one join only allowed → join Lessons to Courses and select instructorId).","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT l.LessonId, l.Title AS LessonTitle, c.InstructorId FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId;"}
{"question":"Show quizzes and total questions for their lessons.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT q.QuizId, l.Title AS LessonTitle, q.TotalQuestions FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId;"}
{"question":"List courses along with category codes.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT c.CourseId, c.Title, g.Code AS CategoryCode FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId;"}
{"question":"Show course-instructor pairs from the mapping table.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT ci.CourseId, a.FullName, ci.RoleInCourse FROM CourseInstructors ci JOIN Accounts a ON ci.AccountId = a.AccountId;"}
{"question":"Get enrollments with progress and course titles.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT e.EnrollmentId, e.ProgressPercent, c.Title FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId;"}
{"question":"Return accounts and their enrollment ids (if any).","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT a.AccountId, a.FullName, e.EnrollmentId FROM Accounts a LEFT JOIN Enrollments e ON a.AccountId = e.AccountId;"}
{"question":"Show quiz attempts joined to accounts (one join).","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT qa.AttemptId, a.FullName, qa.Score, qa.CorrectAnswers FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId;"}
{"question":"Show course reviews joined to accounts (reviewer names).","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT r.ReviewId, a.FullName AS Reviewer, r.Rating FROM CourseReviews r JOIN Accounts a ON r.AccountId = a.AccountId;"}
{"question":"List lessons and their course ids (simple join).","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT l.LessonId, l.Title, c.CourseId FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId;"}
{"question":"Show course titles with their category names, ordered by title.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT c.Title, g.Name AS CategoryName FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId ORDER BY c.Title;"}
{"question":"List course ids with instructor full names.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT c.CourseId, a.FullName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId;"}
{"question":"Find lessons and the titles of their courses for quiz lessons only.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT l.LessonId, l.Title AS LessonTitle, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE l.LessonType = N'quiz';"}
{"question":"Show quiz titles together with their course ids.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT q.Title AS QuizTitle, l.CourseId FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId;"}
{"question":"List quiz questions along with the quiz they belong to.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT qq.QuestionId, q.Title AS QuizTitle, qq.Question FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId;"}
{"question":"Get enrollments with student names and progress.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT e.EnrollmentId, a.FullName, e.ProgressPercent FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId;"}
{"question":"Return enrollments joined to course titles for completed ones.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT e.EnrollmentId, c.Title AS CourseTitle, e.CompletionDate FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId WHERE e.IsCompleted = 1;"}
{"question":"Show attempts and the account names of test takers, score descending.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT qa.AttemptId, a.FullName, qa.Score FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId ORDER BY qa.Score DESC;"}
{"question":"List course reviews with reviewer names and ratings.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT r.ReviewId, a.FullName AS Reviewer, r.Rating FROM CourseReviews r JOIN Accounts a ON r.AccountId = a.AccountId;"}
{"question":"Get courses with their category codes and instructor ids.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT c.CourseId, c.Title, g.Code AS CategoryCode, c.InstructorId FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId;"}
{"question":"Show course instructors mapping with instructor names.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT ci.CourseId, a.FullName, ci.RoleInCourse FROM CourseInstructors ci JOIN Accounts a ON ci.AccountId = a.AccountId;"}
{"question":"Return lessons and course titles for published courses only.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT l.Title AS LessonTitle, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE c.IsPublished = 1;"}
{"question":"List quizzes with total questions and lesson titles sorted by lesson title.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT q.Title AS QuizTitle, q.TotalQuestions, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId ORDER BY l.Title;"}
{"question":"Show quiz attempts with the quiz titles.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT qa.AttemptId, q.Title AS QuizTitle, qa.Score FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId;"}
{"question":"Return course reviews with course titles.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT r.ReviewId, c.Title AS CourseTitle, r.Rating FROM CourseReviews r JOIN Courses c ON r.CourseId = c.CourseId;"}
{"question":"Show accounts with their enrollment ids using left join.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT a.AccountId, a.FullName, e.EnrollmentId FROM Accounts a LEFT JOIN Enrollments e ON a.AccountId = e.AccountId;"}
{"question":"List courses with category names for beginner difficulty.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT c.Title, g.Name AS CategoryName FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId WHERE c.Difficulty = N'beginner';"}
{"question":"Get enrollments joined to account names for progress over 50%.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT a.FullName, e.CourseId, e.ProgressPercent FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId WHERE e.ProgressPercent > 50;"}
{"question":"Show quiz questions with correct options and quiz titles for verification.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT q.Title AS QuizTitle, qq.Question, qq.CorrectOption FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId;"}
{"question":"List lessons with instructor ids via courses (single join).","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT l.LessonId, l.Title AS LessonTitle, c.InstructorId FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId;"}

{"question":"Count how many accounts per role.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT Role, COUNT(*) AS Total FROM Accounts GROUP BY Role;"}
{"question":"Find the number of courses in each difficulty.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Difficulty, COUNT(*) AS NumCourses FROM Courses GROUP BY Difficulty;"}
{"question":"Total enrollments per course.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT CourseId, COUNT(*) AS EnrollCount FROM Enrollments GROUP BY CourseId;"}
{"question":"Average progress percent by course.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT CourseId, AVG(ProgressPercent) AS AvgProgress FROM Enrollments GROUP BY CourseId;"}
{"question":"Average quiz score by quiz id.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT QuizId, AVG(Score) AS AvgScore FROM QuizAttempts GROUP BY QuizId;"}
{"question":"Count quiz questions per quiz.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);","answer":"SELECT QuizId, COUNT(*) AS QuestionCount FROM QuizQuestions GROUP BY QuizId;"}
{"question":"Number of courses per category id.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT CategoryId, COUNT(*) AS CourseCount FROM Courses GROUP BY CategoryId;"}
{"question":"Find highest, lowest, and average course price.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT MAX(Price) AS MaxPrice, MIN(Price) AS MinPrice, AVG(Price) AS AvgPrice FROM Courses;"}
{"question":"Sum of prices by difficulty level.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Difficulty, SUM(Price) AS TotalPrice FROM Courses GROUP BY Difficulty;"}
{"question":"Top 5 courses with most enrollments.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT TOP (5) CourseId, COUNT(*) AS EnrollCount FROM Enrollments GROUP BY CourseId ORDER BY EnrollCount DESC;"}
{"question":"Number of completed enrollments by course.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT CourseId, COUNT(*) AS CompletedCount FROM Enrollments WHERE IsCompleted = 1 GROUP BY CourseId;"}
{"question":"Average score per account across all attempts.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AccountId, AVG(Score) AS AvgScore FROM QuizAttempts GROUP BY AccountId;"}
{"question":"Get course count by instructor id.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT InstructorId, COUNT(*) AS NumCourses FROM Courses GROUP BY InstructorId;"}
{"question":"Average rating per course from reviews.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT CourseId, AVG(CAST(Rating AS DECIMAL(10,2))) AS AvgRating FROM CourseReviews GROUP BY CourseId;"}
{"question":"Count reviews per rating value.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT Rating, COUNT(*) AS ReviewCount FROM CourseReviews GROUP BY Rating;"}
{"question":"Find number of lessons by lesson type.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT LessonType, COUNT(*) AS TotalLessons FROM Lessons GROUP BY LessonType;"}
{"question":"List categories having more than 1 course (by id).","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT CategoryId, COUNT(*) AS CourseCount FROM Courses GROUP BY CategoryId HAVING COUNT(*) > 1;"}
{"question":"Highest score achieved for each quiz.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT QuizId, MAX(Score) AS MaxScore FROM QuizAttempts GROUP BY QuizId;"}
{"question":"Average correct answers per quiz.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT QuizId, AVG(CAST(CorrectAnswers AS DECIMAL(10,2))) AS AvgCorrect FROM QuizAttempts GROUP BY QuizId;"}
{"question":"Get the number of attempts submitted today per account.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AccountId, COUNT(*) AS TodayAttempts FROM QuizAttempts WHERE CAST(SubmittedAt AS DATE) = CAST(SYSUTCDATETIME() AS DATE) GROUP BY AccountId;"}
{"question":"Total enrollments by month of the current year (UTC).","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT MONTH(EnrolledOn) AS MonthNum, COUNT(*) AS EnrollCount FROM Enrollments WHERE YEAR(EnrolledOn) = YEAR(SYSUTCDATETIME()) GROUP BY MONTH(EnrolledOn) ORDER BY MonthNum;"}

{"question":"Find accounts created in the last 7 days (UTC).","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE CreatedAt >= DATEADD(DAY, -7, SYSUTCDATETIME());"}
{"question":"Get courses created this month (UTC).","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE YEAR(CreatedAt) = YEAR(SYSUTCDATETIME()) AND MONTH(CreatedAt) = MONTH(SYSUTCDATETIME());"}
{"question":"List enrollments from the last 30 days.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE EnrolledOn >= DATEADD(DAY, -30, SYSUTCDATETIME());"}
{"question":"Return attempts submitted within the last hour (UTC).","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE SubmittedAt >= DATEADD(HOUR, -1, SYSUTCDATETIME());"}
{"question":"Find reviews posted today.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE CAST(CreatedAt AS DATE) = CAST(SYSUTCDATETIME() AS DATE);"}
{"question":"List attempts started this week (UTC).","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE DATEDIFF(WEEK, StartedAt, SYSUTCDATETIME()) = 0;"}
{"question":"Get enrollments completed in the current year.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE IsCompleted = 1 AND YEAR(CompletionDate) = YEAR(SYSUTCDATETIME());"}
{"question":"Return courses published in the last 90 days.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE IsPublished = 1 AND CreatedAt >= DATEADD(DAY, -90, SYSUTCDATETIME());"}
{"question":"Find lessons created yesterday (UTC).","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons WHERE CAST(CreatedAt AS DATE) = CAST(DATEADD(DAY, -1, SYSUTCDATETIME()) AS DATE);"}
{"question":"Show reviews in the last 14 days with rating >= 4.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE CreatedAt >= DATEADD(DAY, -14, SYSUTCDATETIME()) AND Rating >= 4;"}
{"question":"Get attempts between two UTC timestamps.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE SubmittedAt BETWEEN '2025-10-01T00:00:00' AND '2025-10-31T23:59:59';"}
{"question":"Find accounts created in Q4 of this year (UTC).","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE YEAR(CreatedAt) = YEAR(SYSUTCDATETIME()) AND DATEPART(QUARTER, CreatedAt) = 4;"}
{"question":"List enrollments with enrolled date in the same month as today (UTC).","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE YEAR(EnrolledOn) = YEAR(SYSUTCDATETIME()) AND MONTH(EnrolledOn) = MONTH(SYSUTCDATETIME());"}
{"question":"Show attempts started before submitted date (data sanity).","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE StartedAt <= SubmittedAt;"}
{"question":"Get reviews posted within the last 6 months (UTC).","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE CreatedAt >= DATEADD(MONTH, -6, SYSUTCDATETIME());"}
{"question":"Return courses created in the same week number as today (UTC).","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE DATEPART(YEAR, CreatedAt) = DATEPART(YEAR, SYSUTCDATETIME()) AND DATEPART(WEEK, CreatedAt) = DATEPART(WEEK, SYSUTCDATETIME());"}
{"question":"Find lessons created within the last 3 days.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons WHERE CreatedAt >= DATEADD(DAY, -3, SYSUTCDATETIME());"}
{"question":"List attempts submitted on the same date as a given timestamp.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE CAST(SubmittedAt AS DATE) = CAST('2025-10-25T00:00:00' AS DATE);"}

{"question":"Search course titles that begin with 'Intro'.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE Title LIKE N'Intro%';"}
{"question":"Find courses whose titles end with '101'.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE Title LIKE N'%101';"}
{"question":"Search lessons containing the phrase 'Quiz'.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons WHERE Title LIKE N'%Quiz%';"}
{"question":"Find accounts with emails from example.com domain.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE Email LIKE N'%@example.com';"}
{"question":"Exclude courses whose title contains 'Crash'.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE Title NOT LIKE N'%Crash%';"}
{"question":"Find quiz questions mentioning 'HTTP' (case-insensitive).","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);","answer":"SELECT * FROM QuizQuestions WHERE Question LIKE N'%HTTP%';"}
{"question":"Search reviews that include the word 'rõ ràng' in comments.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE Comment LIKE N'%rõ ràng%';"}
{"question":"Return accounts whose name has 'Anh' anywhere.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE FullName LIKE N'%Anh%';"}
{"question":"Find categories whose code matches pattern CAT1_.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT * FROM Categories WHERE Code LIKE N'CAT1_';"}
{"question":"Get courses with price between 100000 and 200000 VND inclusive.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE Price BETWEEN 100000 AND 200000;"}
{"question":"Find enrollments with progress in the 60–80 range.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE ProgressPercent BETWEEN 60 AND 80;"}
{"question":"Search attempts whose score is not in 60,70,80.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE Score NOT IN (60,70,80);"}
{"question":"Find courses where difficulty is in beginner or intermediate.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE Difficulty IN (N'beginner', N'intermediate');"}
{"question":"Return lessons whose type is either quiz or video.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons WHERE LessonType IN (N'quiz', N'video');"}
{"question":"Search reviews not containing 'hữu ích'.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE Comment NOT LIKE N'%hữu ích%';"}
{"question":"Find quizzes whose title starts with 'Course Quiz — 1'.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT * FROM Quizzes WHERE Title LIKE N'Course Quiz — 1%';"}
{"question":"Get accounts whose full name ends with 'Hải'.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE FullName LIKE N'%Hải';"}
{"question":"Return categories having the word 'data' (case-insensitive via LIKE).","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT * FROM Categories WHERE Name LIKE N'%data%' OR Description LIKE N'%data%';"}
{"question":"Search questions containing the substring 'JOIN' or 'WHERE'.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);","answer":"SELECT * FROM QuizQuestions WHERE Question LIKE N'%JOIN%' OR Question LIKE N'%WHERE%';"}
{"question":"Find courses whose summary contains 'CI/CD' or 'REST'.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE Summary LIKE N'%CI/CD%' OR Summary LIKE N'%REST%';"}
{"question":"Exclude enrollments with zero progress.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE ProgressPercent > 0;"}
{"question":"List attempts where correct answers equals total questions (perfect score logical check).","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE CorrectAnswers = TotalQuestions;"}
{"question":"Find reviews with comments length greater than 10 characters.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE LEN(Comment) > 10;"}
{"question":"Get courses whose title has 'to' as a separate token (LIKE with spaces).","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE Title LIKE N'% to %';"}
{"question":"Return accounts with emails not ending in '.vn'.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE Email NOT LIKE N'%.vn';"}

{"question":"Top 10 most expensive published courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT TOP (10) * FROM Courses WHERE IsPublished = 1 ORDER BY Price DESC;"}
{"question":"Oldest 5 accounts by CreatedAt.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT TOP (5) * FROM Accounts ORDER BY CreatedAt ASC;"}
{"question":"Courses ordered by title ascending then price descending.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses ORDER BY Title ASC, Price DESC;"}
{"question":"First 3 lessons by newest created time.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT TOP (3) * FROM Lessons ORDER BY CreatedAt DESC;"}
{"question":"Top 5 attempts with highest scores.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT TOP (5) * FROM QuizAttempts ORDER BY Score DESC, SubmittedAt DESC;"}
{"question":"Latest 10 reviews with rating then time.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT TOP (10) * FROM CourseReviews ORDER BY Rating DESC, CreatedAt DESC;"}
{"question":"Paginate courses: page 2 with page size 5, title ascending.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses ORDER BY Title OFFSET 5 ROWS FETCH NEXT 5 ROWS ONLY;"}
{"question":"Paginate accounts: first page size 10 by CreatedAt desc.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts ORDER BY CreatedAt DESC OFFSET 0 ROWS FETCH NEXT 10 ROWS ONLY;"}
{"question":"Top 3 categories by number of courses (using ORDER BY).","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT TOP (3) CategoryId, COUNT(*) AS CourseCount FROM Courses GROUP BY CategoryId ORDER BY CourseCount DESC;"}
{"question":"Last 5 attempts by SubmittedAt for a quick view.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT TOP (5) * FROM QuizAttempts ORDER BY SubmittedAt DESC;"}

{"question":"Find courses whose category id is in (1,2,3).","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE CategoryId IN (1,2,3);"}
{"question":"Return accounts whose role is not in Admin or Instructor.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE Role NOT IN (N'Admin', N'Instructor');"}
{"question":"Get enrollments with course id not in (101,102).","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE CourseId NOT IN (101,102);"}
{"question":"List lessons where ordering between 1 and 3 inclusive.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons WHERE Ordering BETWEEN 1 AND 3;"}
{"question":"Find attempts with score between 70 and 100 and submitted not null.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE Score BETWEEN 70 AND 100 AND SubmittedAt IS NOT NULL;"}
{"question":"Get reviews with rating in (4,5) and comment not null.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE Rating IN (4,5) AND Comment IS NOT NULL;"}
{"question":"Return courses where difficulty is not null and price > 0.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE Difficulty IS NOT NULL AND Price > 0;"}
{"question":"Find accounts active and role in (Student, Instructor).","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE IsActive = 1 AND Role IN (N'Student', N'Instructor');"}
{"question":"Exclude reviews created before 2025-01-01 UTC.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE CreatedAt >= '2025-01-01T00:00:00';"}
{"question":"Get enrollments where completion date is null and progress < 50.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE CompletionDate IS NULL AND ProgressPercent < 50;"}
{"question":"Show all accounts.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts;"}
{"question":"List every account with id and name.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT AccountId, FullName FROM Accounts;"}
{"question":"Display active user records only from accounts.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE IsActive = 1;"}
{"question":"Get me all instructor accounts (teacher role).","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE Role = N'Instructor';"}
{"question":"Return account emails only.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT Email FROM Accounts;"}
{"question":"Fetch account names and roles, newest first.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT FullName, Role FROM Accounts ORDER BY CreatedAt DESC;"}
{"question":"Show me admin users.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE Role = N'Admin';"}
{"question":"Dump account ids and created time.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT AccountId, CreatedAt FROM Accounts;"}
{"question":"Give me students who are inactive.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE Role = N'Student' AND IsActive = 0;"}
{"question":"Show the full roster of names (accounts).","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT FullName FROM Accounts;"}

{"question":"Show all categories.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT * FROM Categories;"}
{"question":"List category codes and names only.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT Code, Name FROM Categories;"}
{"question":"Display category dictionary (id, code, name).","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT CategoryId, Code, Name FROM Categories;"}
{"question":"Give me category descriptions.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT Description FROM Categories;"}
{"question":"Fetch categories sorted by code.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT * FROM Categories ORDER BY Code;"}
{"question":"Return categories whose name includes 'Data'.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT * FROM Categories WHERE Name LIKE N'%Data%';"}
{"question":"Show top 5 categories by id ascending.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT TOP (5) * FROM Categories ORDER BY CategoryId ASC;"}
{"question":"Get category codes starting with CAT0.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT * FROM Categories WHERE Code LIKE N'CAT0%';"}
{"question":"Display unique category names.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT DISTINCT Name FROM Categories;"}
{"question":"Return categories where description is not null.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT * FROM Categories WHERE Description IS NOT NULL;"}

{"question":"Show all courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses;"}
{"question":"List course titles only.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Title FROM Courses;"}
{"question":"Display published courses (isPublished).","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE IsPublished = 1;"}
{"question":"Get beginner-level courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE Difficulty = N'beginner';"}
{"question":"Return course ids, titles, and price tags.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT CourseId, Title, Price FROM Courses;"}
{"question":"Fetch the 10 newest courses by CreatedAt.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT TOP (10) * FROM Courses ORDER BY CreatedAt DESC;"}
{"question":"Show courses whose title contains 'SQL'.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE Title LIKE N'%SQL%';"}
{"question":"Dump all intermediate and advanced courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE Difficulty IN (N'intermediate', N'advanced');"}
{"question":"Give me cheap courses (price < 120000).","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE Price < 120000;"}
{"question":"Show unpublished courses only.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE IsPublished = 0;"}

{"question":"Show all course–instructor mappings.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR);","answer":"SELECT * FROM CourseInstructors;"}
{"question":"List mapping ids with role in course.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR);","answer":"SELECT Id, RoleInCourse FROM CourseInstructors;"}
{"question":"Display courseId and accountId pairs.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR);","answer":"SELECT CourseId, AccountId FROM CourseInstructors;"}
{"question":"Get only 'Lead' role rows in course instructors.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR);","answer":"SELECT * FROM CourseInstructors WHERE RoleInCourse = N'Lead';"}
{"question":"Return distinct courseIds from CourseInstructors.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR);","answer":"SELECT DISTINCT CourseId FROM CourseInstructors;"}
{"question":"Fetch instructor accounts that appear more than once (by mapping id count).","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR);","answer":"SELECT AccountId FROM CourseInstructors GROUP BY AccountId HAVING COUNT(*) > 1;"}
{"question":"Show course instructors sorted by CourseId then AccountId.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR);","answer":"SELECT * FROM CourseInstructors ORDER BY CourseId, AccountId;"}
{"question":"Give me mappings where role is not 'Lead'.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR);","answer":"SELECT * FROM CourseInstructors WHERE RoleInCourse <> N'Lead';"}
{"question":"Display the first 10 mappings (top).","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR);","answer":"SELECT TOP (10) * FROM CourseInstructors;"}
{"question":"Return mapping ids only.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR);","answer":"SELECT Id FROM CourseInstructors;"}

{"question":"Show all lessons.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons;"}
{"question":"List lesson titles and types.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT Title, LessonType FROM Lessons;"}
{"question":"Display only quiz lessons.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons WHERE LessonType = N'quiz';"}
{"question":"Get lessons ordered by newest first.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons ORDER BY CreatedAt DESC;"}
{"question":"Return lessons with ordering greater than 1.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons WHERE Ordering > 1;"}
{"question":"Fetch lesson ids and course ids.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT LessonId, CourseId FROM Lessons;"}
{"question":"Show lessons whose title contains 'Quiz'.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons WHERE Title LIKE N'%Quiz%';"}
{"question":"Give me lesson titles only.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT Title FROM Lessons;"}
{"question":"Display lessons for course id greater than 105.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons WHERE CourseId > 105;"}
{"question":"Return the top 3 most recent lessons.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT TOP (3) * FROM Lessons ORDER BY CreatedAt DESC;"}

{"question":"Show all quizzes.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT * FROM Quizzes;"}
{"question":"List quiz titles with total questions.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT Title, TotalQuestions FROM Quizzes;"}
{"question":"Display quizzes where total questions = 3.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT * FROM Quizzes WHERE TotalQuestions = 3;"}
{"question":"Get the latest 5 quizzes by id desc.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT TOP (5) * FROM Quizzes ORDER BY QuizId DESC;"}
{"question":"Return quiz ids only.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT QuizId FROM Quizzes;"}
{"question":"Fetch quizzes whose title starts with 'Course Quiz —'.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT * FROM Quizzes WHERE Title LIKE N'Course Quiz —%';"}
{"question":"Show quiz titles sorted alphabetically.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT Title FROM Quizzes ORDER BY Title ASC;"}
{"question":"Give me quizzes for lesson ids less than 10.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT * FROM Quizzes WHERE LessonId < 10;"}
{"question":"Display quizzes having at least 1 question.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT * FROM Quizzes WHERE TotalQuestions > 0;"}
{"question":"Return quiz titles only.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT Title FROM Quizzes;"}

{"question":"Show all quiz questions.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);","answer":"SELECT * FROM QuizQuestions;"}
{"question":"List question text with the correct option number.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);","answer":"SELECT Question, CorrectOption FROM QuizQuestions;"}
{"question":"Display the first 20 questions ordered by id.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);","answer":"SELECT TOP (20) * FROM QuizQuestions ORDER BY QuestionId ASC;"}
{"question":"Get questions that contain the word 'JOIN'.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);","answer":"SELECT * FROM QuizQuestions WHERE Question LIKE N'%JOIN%';"}
{"question":"Return distinct quiz ids present in questions.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);","answer":"SELECT DISTINCT QuizId FROM QuizQuestions;"}
{"question":"Fetch options A and B for all questions.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);","answer":"SELECT OptionA, OptionB FROM QuizQuestions;"}
{"question":"Show only questions where correct option equals 1.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);","answer":"SELECT * FROM QuizQuestions WHERE CorrectOption = 1;"}
{"question":"Give me question text only (no options).","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);","answer":"SELECT Question FROM QuizQuestions;"}
{"question":"Display questions for quiz id greater than 5.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);","answer":"SELECT * FROM QuizQuestions WHERE QuizId > 5;"}
{"question":"Return top 10 latest questions by id desc.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);","answer":"SELECT TOP (10) * FROM QuizQuestions ORDER BY QuestionId DESC;"}

{"question":"List enrollment ids with progress percent.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT EnrollmentId, ProgressPercent FROM Enrollments;"}
{"question":"Display completed enrollments only.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE IsCompleted = 1;"}
{"question":"Get enrollments with progress >= 80%.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE ProgressPercent >= 80;"}
{"question":"Return enrollments created today (UTC).","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE CAST(EnrolledOn AS DATE) = CAST(SYSUTCDATETIME() AS DATE);"}
{"question":"Fetch enrollment ids with course ids.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT EnrollmentId, CourseId FROM Enrollments;"}
{"question":"Show enrollments not yet completed (in progress).","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE IsCompleted = 0;"}
{"question":"Give me enrollments for course id 101.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE CourseId = 101;"}
{"question":"Display enrollments with AccountId and EnrolledOn fields.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT AccountId, EnrolledOn FROM Enrollments;"}
{"question":"Return top 5 most recent enrollments.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT TOP (5) * FROM Enrollments ORDER BY EnrolledOn DESC;"}

{"question":"Show all quiz attempts.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts;"}
{"question":"List attempt scores only.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Score FROM QuizAttempts;"}
{"question":"Display attempts submitted today (UTC).","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE CAST(SubmittedAt AS DATE) = CAST(SYSUTCDATETIME() AS DATE);"}
{"question":"Get attempts with perfect correctness (correct = total).","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE CorrectAnswers = TotalQuestions;"}
{"question":"Return attempts where score >= 90.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE Score >= 90;"}
{"question":"Fetch attempt ids and account ids.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AttemptId, AccountId FROM QuizAttempts;"}
{"question":"Show attempts started this week (UTC).","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE DATEDIFF(WEEK, StartedAt, SYSUTCDATETIME()) = 0;"}
{"question":"Give me attempts for quiz id 1.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE QuizId = 1;"}
{"question":"Display attempts sorted by score then submitted time.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts ORDER BY Score DESC, SubmittedAt DESC;"}
{"question":"Return last 10 attempts by SubmittedAt.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT TOP (10) * FROM QuizAttempts ORDER BY SubmittedAt DESC;"}

{"question":"Show all course reviews.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews;"}
{"question":"List ratings only from course reviews.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT Rating FROM CourseReviews;"}
{"question":"Display 5-star reviews.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE Rating = 5;"}
{"question":"Get reviews with comment text containing 'hữu ích'.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE Comment LIKE N'%hữu ích%';"}
{"question":"Return latest 5 reviews by CreatedAt.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT TOP (5) * FROM CourseReviews ORDER BY CreatedAt DESC;"}
{"question":"Fetch review ids and course ids only.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT ReviewId, CourseId FROM CourseReviews;"}
{"question":"Show reviews with rating >= 4.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE Rating >= 4;"}
{"question":"Give me comments that are not null from reviews.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT Comment FROM CourseReviews WHERE Comment IS NOT NULL;"}
{"question":"Display reviews posted this month (UTC).","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE YEAR(CreatedAt) = YEAR(SYSUTCDATETIME()) AND MONTH(CreatedAt) = MONTH(SYSUTCDATETIME());"}
{"question":"Return reviews grouped by rating count (simple aggregate).","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT Rating, COUNT(*) AS Total FROM CourseReviews GROUP BY Rating;"}
{"question":"Show all courses with their category names.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT c.CourseId, c.Title, g.Name AS CategoryName FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId;"}
{"question":"List each course title and the instructor name.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT c.Title, a.FullName AS InstructorName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId;"}
{"question":"Display lessons with their related course titles.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT l.Title AS LessonTitle, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId;"}
{"question":"Get all enrollments with student names and course titles.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT e.EnrollmentId, a.FullName, c.Title AS CourseTitle FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId JOIN Courses c ON e.CourseId = c.CourseId;"}
{"question":"Show reviews with reviewer names and rated course titles.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT r.ReviewId, a.FullName, c.Title AS CourseTitle, r.Rating FROM CourseReviews r JOIN Accounts a ON r.AccountId = a.AccountId JOIN Courses c ON r.CourseId = c.CourseId;"}
{"question":"List quizzes with their lesson and course names.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, Title NVARCHAR);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT q.QuizId, q.Title AS QuizTitle, l.Title AS LessonTitle, c.Title AS CourseTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId JOIN Courses c ON l.CourseId = c.CourseId;"}
{"question":"Show quiz questions along with quiz titles.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT qq.QuestionId, qq.Question, q.Title AS QuizTitle FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId;"}
{"question":"Display quiz attempts with quiz title and student name.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, Score INT);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT qa.AttemptId, a.FullName, q.Title AS QuizTitle, qa.Score FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId JOIN Quizzes q ON qa.QuizId = q.QuizId;"}
{"question":"Get the number of enrollments for each course.","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, COUNT(e.EnrollmentId) AS TotalEnrollments FROM Courses c LEFT JOIN Enrollments e ON c.CourseId = e.CourseId GROUP BY c.Title;"}
{"question":"Find total number of courses in each category.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT g.Name AS CategoryName, COUNT(c.CourseId) AS TotalCourses FROM Categories g LEFT JOIN Courses c ON g.CategoryId = c.CategoryId GROUP BY g.Name;"}

{"question":"Count how many lessons each course has.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, COUNT(l.LessonId) AS LessonCount FROM Courses c LEFT JOIN Lessons l ON c.CourseId = l.CourseId GROUP BY c.Title;"}
{"question":"Find the average course price by difficulty level.","context":"CREATE TABLE Courses (CourseId INT, Difficulty NVARCHAR, Price DECIMAL);","answer":"SELECT Difficulty, AVG(Price) AS AveragePrice FROM Courses GROUP BY Difficulty;"}
{"question":"Calculate the average quiz score per student.","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, AVG(qa.Score) AS AvgScore FROM Accounts a JOIN QuizAttempts qa ON a.AccountId = qa.AccountId GROUP BY a.FullName;"}
{"question":"Get total number of reviews each course received.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, COUNT(r.ReviewId) AS ReviewCount FROM Courses c LEFT JOIN CourseReviews r ON c.CourseId = r.CourseId GROUP BY c.Title;"}
{"question":"Find the highest rated course average rating.","context":"CREATE TABLE CourseReviews (CourseId INT, Rating INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT TOP (1) c.Title, AVG(r.Rating) AS AvgRating FROM CourseReviews r JOIN Courses c ON c.CourseId = r.CourseId GROUP BY c.Title ORDER BY AvgRating DESC;"}
{"question":"Show how many students are enrolled in each category.","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);\nCREATE TABLE Courses (CourseId INT, CategoryId INT);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT g.Name AS CategoryName, COUNT(e.EnrollmentId) AS StudentCount FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId JOIN Categories g ON c.CategoryId = g.CategoryId GROUP BY g.Name;"}
{"question":"Find the number of published courses per instructor.","context":"CREATE TABLE Courses (CourseId INT, InstructorId INT, IsPublished BIT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, COUNT(c.CourseId) AS PublishedCourses FROM Accounts a JOIN Courses c ON a.AccountId = c.InstructorId WHERE c.IsPublished = 1 GROUP BY a.FullName;"}
{"question":"Get the average progress percent per student.","context":"CREATE TABLE Enrollments (AccountId INT, ProgressPercent REAL);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, AVG(e.ProgressPercent) AS AvgProgress FROM Accounts a JOIN Enrollments e ON a.AccountId = e.AccountId GROUP BY a.FullName;"}
{"question":"Calculate total number of quizzes per course.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, COUNT(q.QuizId) AS QuizCount FROM Courses c JOIN Lessons l ON c.CourseId = l.CourseId JOIN Quizzes q ON q.LessonId = l.LessonId GROUP BY c.Title;"}
{"question":"Show total attempts per quiz.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, COUNT(qa.AttemptId) AS AttemptCount FROM Quizzes q LEFT JOIN QuizAttempts qa ON q.QuizId = qa.QuizId GROUP BY q.Title;"}

{"question":"Find the top 5 students with most enrollments.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT TOP (5) a.FullName, COUNT(e.EnrollmentId) AS EnrollCount FROM Accounts a JOIN Enrollments e ON a.AccountId = e.AccountId GROUP BY a.FullName ORDER BY EnrollCount DESC;"}
{"question":"Show courses with average rating above 4.","context":"CREATE TABLE CourseReviews (CourseId INT, Rating INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, AVG(r.Rating) AS AvgRating FROM Courses c JOIN CourseReviews r ON c.CourseId = r.CourseId GROUP BY c.Title HAVING AVG(r.Rating) > 4;"}
{"question":"Display the total quiz attempts for each student.","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, COUNT(qa.AttemptId) AS TotalAttempts FROM Accounts a LEFT JOIN QuizAttempts qa ON a.AccountId = qa.AccountId GROUP BY a.FullName;"}
{"question":"Get total quizzes per lesson ordered by count desc.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT);\nCREATE TABLE Lessons (LessonId INT, Title NVARCHAR);","answer":"SELECT l.Title, COUNT(q.QuizId) AS TotalQuizzes FROM Lessons l LEFT JOIN Quizzes q ON l.LessonId = q.LessonId GROUP BY l.Title ORDER BY TotalQuizzes DESC;"}
{"question":"Find students who completed at least one course.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT DISTINCT a.FullName FROM Accounts a JOIN Enrollments e ON a.AccountId = e.AccountId WHERE e.IsCompleted = 1;"}
{"question":"Show the average quiz score per quiz title.","context":"CREATE TABLE QuizAttempts (QuizId INT, Score INT);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, AVG(qa.Score) AS AvgScore FROM Quizzes q LEFT JOIN QuizAttempts qa ON q.QuizId = qa.QuizId GROUP BY q.Title;"}
{"question":"Display lessons count and quiz count for each course.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, COUNT(DISTINCT l.LessonId) AS LessonCount, COUNT(DISTINCT q.QuizId) AS QuizCount FROM Courses c LEFT JOIN Lessons l ON c.CourseId = l.CourseId LEFT JOIN Quizzes q ON q.LessonId = l.LessonId GROUP BY c.Title;"}
{"question":"Calculate total revenue assuming each enrollment costs 100000.","context":"CREATE TABLE Enrollments (EnrollmentId INT, EnrollmentDate DATETIME2);","answer":"SELECT COUNT(*) * 100000 AS TotalRevenue FROM Enrollments;"}
{"question":"Show total number of active instructors.","context":"CREATE TABLE Accounts (AccountId INT, Role NVARCHAR, IsActive BIT);","answer":"SELECT COUNT(*) AS ActiveInstructors FROM Accounts WHERE Role = N'Instructor' AND IsActive = 1;"}
{"question":"Get the number of completed vs ongoing enrollments.","context":"CREATE TABLE Enrollments (IsCompleted BIT);","answer":"SELECT IsCompleted, COUNT(*) AS Total FROM Enrollments GROUP BY IsCompleted;"}

{"question":"Find the most enrolled course.","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT TOP (1) c.Title, COUNT(e.EnrollmentId) AS EnrollCount FROM Courses c JOIN Enrollments e ON c.CourseId = e.CourseId GROUP BY c.Title ORDER BY EnrollCount DESC;"}
{"question":"Show students with their average progress.","context":"CREATE TABLE Enrollments (AccountId INT, ProgressPercent REAL);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, AVG(e.ProgressPercent) AS AvgProgress FROM Accounts a JOIN Enrollments e ON a.AccountId = e.AccountId GROUP BY a.FullName;"}
{"question":"List courses that have no lessons yet.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR);\nCREATE TABLE Lessons (LessonId INT, CourseId INT);","answer":"SELECT c.Title FROM Courses c LEFT JOIN Lessons l ON c.CourseId = l.CourseId WHERE l.LessonId IS NULL;"}
{"question":"Get average rating and review count per course.","context":"CREATE TABLE CourseReviews (CourseId INT, Rating INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, AVG(r.Rating) AS AvgRating, COUNT(r.Rating) AS ReviewCount FROM Courses c LEFT JOIN CourseReviews r ON c.CourseId = r.CourseId GROUP BY c.Title;"}
{"question":"Show total attempts per student and their max score.","context":"CREATE TABLE QuizAttempts (AccountId INT, Score INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, COUNT(*) AS AttemptCount, MAX(Score) AS MaxScore FROM Accounts a LEFT JOIN QuizAttempts qa ON a.AccountId = qa.AccountId GROUP BY a.FullName;"}
{"question":"Find courses with more than 5 lessons.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR);\nCREATE TABLE Lessons (LessonId INT, CourseId INT);","answer":"SELECT c.Title FROM Courses c JOIN Lessons l ON c.CourseId = l.CourseId GROUP BY c.Title HAVING COUNT(l.LessonId) > 5;"}
{"question":"Display category names with total lessons across their courses.","context":"CREATE TABLE Categories (CategoryId INT, Name NVARCHAR);\nCREATE TABLE Courses (CourseId INT, CategoryId INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT);","answer":"SELECT g.Name, COUNT(l.LessonId) AS TotalLessons FROM Categories g JOIN Courses c ON g.CategoryId = c.CategoryId JOIN Lessons l ON l.CourseId = c.CourseId GROUP BY g.Name;"}
{"question":"Calculate overall average course price.","context":"CREATE TABLE Courses (Price DECIMAL);","answer":"SELECT AVG(Price) AS OverallAveragePrice FROM Courses;"}
{"question":"Find the most recent course published.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT TOP (1) * FROM Courses ORDER BY CreatedAt DESC;"}
{"question":"Count how many distinct instructors exist.","context":"CREATE TABLE Courses (InstructorId INT);","answer":"SELECT COUNT(DISTINCT InstructorId) AS InstructorCount FROM Courses;"}
{"question": "Show all accounts.", "context": "CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Accounts;"}
{"question": "List account names and emails.", "context": "CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT FullName, Email FROM Accounts;"}
{"question": "Display active users only.", "context": "CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Accounts WHERE IsActive = 1;"}
{"question": "Get instructor accounts.", "context": "CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Accounts WHERE Role = N'Instructor';"}
{"question": "Show admin users.", "context": "CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Accounts WHERE Role = N'Admin';"}
{"question": "Return account ids and created time.", "context": "CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT AccountId, CreatedAt FROM Accounts;"}
{"question": "List student accounts.", "context": "CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Accounts WHERE Role = N'Student';"}
{"question": "Get newest 5 accounts.", "context": "CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT TOP (5) * FROM Accounts ORDER BY CreatedAt DESC;"}
{"question": "Display account emails only.", "context": "CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT Email FROM Accounts;"}
{"question": "Show inactive accounts.", "context": "CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Accounts WHERE IsActive = 0;"}
{"question": "Show all categories.", "context": "CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);", "answer": "SELECT * FROM Categories;"}
{"question": "List category codes and names.", "context": "CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);", "answer": "SELECT Code, Name FROM Categories;"}
{"question": "Display categories ordered by code.", "context": "CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);", "answer": "SELECT * FROM Categories ORDER BY Code;"}
{"question": "Get top 5 categories by id.", "context": "CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);", "answer": "SELECT TOP (5) * FROM Categories ORDER BY CategoryId;"}
{"question": "Return category names only.", "context": "CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);", "answer": "SELECT Name FROM Categories;"}
{"question": "Show categories where description is not null.", "context": "CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);", "answer": "SELECT * FROM Categories WHERE Description IS NOT NULL;"}
{"question": "Get categories with code starting with CAT1.", "context": "CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);", "answer": "SELECT * FROM Categories WHERE Code LIKE N'CAT1%';"}
{"question": "List distinct category names.", "context": "CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);", "answer": "SELECT DISTINCT Name FROM Categories;"}
{"question": "Show categories whose name contains Data.", "context": "CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);", "answer": "SELECT * FROM Categories WHERE Name LIKE N'%Data%';"}
{"question": "Display categories with code length 5.", "context": "CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);", "answer": "SELECT * FROM Categories WHERE LEN(Code) = 5;"}
{"question": "Show all courses.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Courses;"}
{"question": "List course titles only.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT Title FROM Courses;"}
{"question": "Display published courses.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Courses WHERE IsPublished = 1;"}
{"question": "Get beginner courses.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Courses WHERE Difficulty = N'beginner';"}
{"question": "Return course ids, titles, and price.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT CourseId, Title, Price FROM Courses;"}
{"question": "Show courses cheaper than 150000.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Courses WHERE Price < 150000;"}
{"question": "Get courses containing SQL in title.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Courses WHERE Title LIKE N'%SQL%';"}
{"question": "List intermediate or advanced courses.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Courses WHERE Difficulty IN (N'intermediate', N'advanced');"}
{"question": "Display newest 10 courses.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT TOP (10) * FROM Courses ORDER BY CreatedAt DESC;"}
{"question": "Show unpublished courses.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Courses WHERE IsPublished = 0;"}
{"question": "Show all lessons.", "context": "CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Lessons;"}
{"question": "List lesson titles and types.", "context": "CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);", "answer": "SELECT Title, LessonType FROM Lessons;"}
{"question": "Display quiz lessons only.", "context": "CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Lessons WHERE LessonType = N'quiz';"}
{"question": "Get lessons ordered by newest first.", "context": "CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Lessons ORDER BY CreatedAt DESC;"}
{"question": "Return lessons with ordering greater than 1.", "context": "CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Lessons WHERE Ordering > 1;"}
{"question": "Show all quizzes.", "context": "CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);", "answer": "SELECT * FROM Quizzes;"}
{"question": "List quiz titles with total questions.", "context": "CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);", "answer": "SELECT Title, TotalQuestions FROM Quizzes;"}
{"question": "Display quizzes where total questions = 3.", "context": "CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);", "answer": "SELECT * FROM Quizzes WHERE TotalQuestions = 3;"}
{"question": "Get the latest 5 quizzes by id desc.", "context": "CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);", "answer": "SELECT TOP (5) * FROM Quizzes ORDER BY QuizId DESC;"}
{"question": "Show quiz titles sorted alphabetically.", "context": "CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);", "answer": "SELECT Title FROM Quizzes ORDER BY Title;"}
{"question": "Find accounts created today (UTC).", "context": "CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Accounts WHERE CAST(CreatedAt AS DATE) = CAST(SYSUTCDATETIME() AS DATE);"}
{"question": "Get accounts from example.com domain.", "context": "CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Accounts WHERE Email LIKE N'%@example.com';"}
{"question": "Search accounts whose name contains Anh.", "context": "CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Accounts WHERE FullName LIKE N'%Anh%';"}
{"question": "Exclude admin accounts.", "context": "CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Accounts WHERE Role <> N'Admin';"}
{"question": "Top 10 newest accounts.", "context": "CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT TOP (10) * FROM Accounts ORDER BY CreatedAt DESC;"}
{"question": "Find categories with code like CAT1_.", "context": "CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);", "answer": "SELECT * FROM Categories WHERE Code LIKE N'CAT1_';"}
{"question": "Search categories where description contains test.", "context": "CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);", "answer": "SELECT * FROM Categories WHERE Description LIKE N'%test%';"}
{"question": "Top 3 categories by id desc.", "context": "CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);", "answer": "SELECT TOP (3) * FROM Categories ORDER BY CategoryId DESC;"}
{"question": "List categories whose name ends with Basics.", "context": "CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);", "answer": "SELECT * FROM Categories WHERE Name LIKE N'%Basics';"}
{"question": "Return categories not starting with CAT.", "context": "CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);", "answer": "SELECT * FROM Categories WHERE Code NOT LIKE N'CAT%';"}
{"question": "Find courses created this month (UTC).", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Courses WHERE YEAR(CreatedAt) = YEAR(SYSUTCDATETIME()) AND MONTH(CreatedAt) = MONTH(SYSUTCDATETIME());"}
{"question": "Search courses titled beginning with Intro.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Courses WHERE Title LIKE N'Intro%';"}
{"question": "Get courses with price between 100000 and 200000.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Courses WHERE Price BETWEEN 100000 AND 200000;"}
{"question": "Exclude courses whose title contains Crash.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Courses WHERE Title NOT LIKE N'%Crash%';"}
{"question": "Paginate courses page 2 size 5 by title.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Courses ORDER BY Title OFFSET 5 ROWS FETCH NEXT 5 ROWS ONLY;"}
{"question": "Find lessons created in last 3 days.", "context": "CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Lessons WHERE CreatedAt >= DATEADD(DAY, -3, SYSUTCDATETIME());"}
{"question": "Search lessons that contain Quiz in title.", "context": "CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Lessons WHERE Title LIKE N'%Quiz%';"}
{"question": "Return lessons for course id greater than 105.", "context": "CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Lessons WHERE CourseId > 105;"}
{"question": "Top 3 most recent lessons.", "context": "CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);", "answer": "SELECT TOP (3) * FROM Lessons ORDER BY CreatedAt DESC;"}
{"question": "List lessons where ordering between 1 and 3.", "context": "CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);", "answer": "SELECT * FROM Lessons WHERE Ordering BETWEEN 1 AND 3;"}
{"question": "Find quizzes with at least 3 questions.", "context": "CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);", "answer": "SELECT * FROM Quizzes WHERE TotalQuestions >= 3;"}
{"question": "Search quizzes whose title starts with Course Quiz — 1.", "context": "CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);", "answer": "SELECT * FROM Quizzes WHERE Title LIKE N'Course Quiz — 1%';"}
{"question": "Return quizzes for lesson ids less than 10.", "context": "CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);", "answer": "SELECT * FROM Quizzes WHERE LessonId < 10;"}
{"question": "Top 10 quizzes by title desc.", "context": "CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);", "answer": "SELECT TOP (10) * FROM Quizzes ORDER BY Title DESC;"}
{"question": "List quizzes with total questions not in 1,2.", "context": "CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);", "answer": "SELECT * FROM Quizzes WHERE TotalQuestions NOT IN (1,2);"}
{"question": "Find enrollments with progress over 70 percent.", "context": "CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);", "answer": "SELECT * FROM Enrollments WHERE ProgressPercent > 70;"}
{"question": "Get enrollments registered this month (UTC).", "context": "CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);", "answer": "SELECT * FROM Enrollments WHERE YEAR(EnrolledOn) = YEAR(SYSUTCDATETIME()) AND MONTH(EnrolledOn) = MONTH(SYSUTCDATETIME());"}
{"question": "Show enrollments not completed.", "context": "CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);", "answer": "SELECT * FROM Enrollments WHERE IsCompleted = 0;"}
{"question": "List enrollments where completion date is null.", "context": "CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);", "answer": "SELECT * FROM Enrollments WHERE CompletionDate IS NULL;"}
{"question": "Top 5 recent enrollments.", "context": "CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);", "answer": "SELECT TOP (5) * FROM Enrollments ORDER BY EnrolledOn DESC;"}
{"question": "Show attempts with score at least 80.", "context": "CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);", "answer": "SELECT * FROM QuizAttempts WHERE Score >= 80;"}
{"question": "Return attempts submitted today.", "context": "CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);", "answer": "SELECT * FROM QuizAttempts WHERE CAST(SubmittedAt AS DATE) = CAST(SYSUTCDATETIME() AS DATE);"}
{"question": "Find attempts between two timestamps.", "context": "CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);", "answer": "SELECT * FROM QuizAttempts WHERE SubmittedAt BETWEEN '2025-10-01T00:00:00' AND '2025-10-31T23:59:59';"}
{"question": "Top 5 attempts by score.", "context": "CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);", "answer": "SELECT TOP (5) * FROM QuizAttempts ORDER BY Score DESC, SubmittedAt DESC;"}
{"question": "List attempts where correct equals total.", "context": "CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);", "answer": "SELECT * FROM QuizAttempts WHERE CorrectAnswers = TotalQuestions;"}
{"question": "Get reviews with five star rating.", "context": "CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);", "answer": "SELECT * FROM CourseReviews WHERE Rating = 5;"}
{"question": "Find reviews posted in last 14 days.", "context": "CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);", "answer": "SELECT * FROM CourseReviews WHERE CreatedAt >= DATEADD(DAY, -14, SYSUTCDATETIME());"}
{"question": "Search reviews that include the word clear.", "context": "CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);", "answer": "SELECT * FROM CourseReviews WHERE Comment LIKE N'%clear%';"}
{"question": "Top 10 recent reviews.", "context": "CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);", "answer": "SELECT TOP (10) * FROM CourseReviews ORDER BY CreatedAt DESC;"}
{"question": "Exclude reviews created before 2025-01-01.", "context": "CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);", "answer": "SELECT * FROM CourseReviews WHERE CreatedAt >= '2025-01-01T00:00:00';"}
{"question": "List course titles with their category names.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);", "answer": "SELECT c.Title, g.Name AS CategoryName FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId;"}
{"question": "Show courses and category codes ordered by title.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);", "answer": "SELECT c.Title, g.Code AS CategoryCode FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId ORDER BY c.Title;"}
{"question": "Get beginner courses with category names.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);", "answer": "SELECT c.Title, g.Name FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId WHERE c.Difficulty = N'beginner';"}
{"question": "Display courses priced under 150000 with category.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);", "answer": "SELECT c.Title, g.Name AS CategoryName FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId WHERE c.Price < 150000;"}
{"question": "List published courses and their category names.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);", "answer": "SELECT c.Title, g.Name FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId WHERE c.IsPublished = 1;"}
{"question": "Show courses with instructor names.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT c.Title, a.FullName AS InstructorName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId;"}
{"question": "List courses and instructor emails.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT c.Title, a.Email AS InstructorEmail FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId;"}
{"question": "Get advanced courses and their instructors.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT c.Title, a.FullName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId WHERE c.Difficulty = N'advanced';"}
{"question": "Display published courses with instructor ids.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT c.Title, a.AccountId AS InstructorId FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId WHERE c.IsPublished = 1;"}
{"question": "Show courses created this month and instructor names.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT c.Title, a.FullName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId WHERE YEAR(c.CreatedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(c.CreatedAt)=MONTH(SYSUTCDATETIME());"}
{"question": "List lesson titles with their course titles.", "context": "CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT l.Title AS LessonTitle, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId;"}
{"question": "Get quiz lessons and related course ids.", "context": "CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT l.LessonId, c.CourseId FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE l.LessonType = N'quiz';"}
{"question": "Show newest lessons and their course titles.", "context": "CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT TOP (10) l.Title AS LessonTitle, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId ORDER BY l.CreatedAt DESC;"}
{"question": "Display lessons with course titles where ordering > 1.", "context": "CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT l.Title, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE l.Ordering > 1;"}
{"question": "List video lessons and their course titles.", "context": "CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT l.Title, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE l.LessonType = N'video';"}
{"question": "Show quizzes with their lesson titles.", "context": "CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);", "answer": "SELECT q.Title AS QuizTitle, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId;"}
{"question": "Get quizzes where total questions >= 3 and lesson titles.", "context": "CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);", "answer": "SELECT q.Title, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId WHERE q.TotalQuestions >= 3;"}
{"question": "List quizzes ordered by lesson title.", "context": "CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);", "answer": "SELECT q.Title, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId ORDER BY l.Title;"}
{"question": "Show latest 5 quizzes with lesson titles.", "context": "CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);", "answer": "SELECT TOP (5) q.Title, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId ORDER BY q.QuizId DESC;"}
{"question": "Display quiz ids with their course ids via lesson.", "context": "CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);", "answer": "SELECT q.QuizId, l.CourseId FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId;"}
{"question": "List quiz questions with quiz titles.", "context": "CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);", "answer": "SELECT qq.Question, q.Title AS QuizTitle FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId;"}
{"question": "Show questions where correct option is 1 with quiz.", "context": "CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);", "answer": "SELECT qq.Question, q.Title FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId WHERE qq.CorrectOption = 1;"}
{"question": "Get latest 10 questions and quiz titles.", "context": "CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);", "answer": "SELECT TOP (10) qq.Question, q.Title AS QuizTitle FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId ORDER BY qq.QuestionId DESC;"}
{"question": "Display questions that mention JOIN with quiz title.", "context": "CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);", "answer": "SELECT qq.Question, q.Title FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId WHERE qq.Question LIKE N'%JOIN%';"}
{"question": "List question ids and their quiz ids.", "context": "CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);", "answer": "SELECT qq.QuestionId, q.QuizId FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId;"}
{"question": "Show enrollments with student names.", "context": "CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT e.EnrollmentId, a.FullName, e.CourseId FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId;"}
{"question": "List completed enrollments with student names.", "context": "CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT a.FullName, e.CourseId, e.CompletionDate FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId WHERE e.IsCompleted = 1;"}
{"question": "Get enrollments with progress > 50 and student names.", "context": "CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT a.FullName, e.ProgressPercent FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId WHERE e.ProgressPercent > 50;"}
{"question": "Display enrollments created this month with student names.", "context": "CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT a.FullName, e.CourseId, e.EnrolledOn FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId WHERE YEAR(e.EnrolledOn)=YEAR(SYSUTCDATETIME()) AND MONTH(e.EnrolledOn)=MONTH(SYSUTCDATETIME());"}
{"question": "Show enrollments not completed with student names.", "context": "CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT a.FullName, e.CourseId FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId WHERE e.IsCompleted = 0;"}
{"question": "List enrollments with course titles.", "context": "CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT e.EnrollmentId, c.Title AS CourseTitle FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId;"}
{"question": "Show enrollments for cheap courses under 120000.", "context": "CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT e.EnrollmentId, c.Title FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId WHERE c.Price < 120000;"}
{"question": "Get enrollments for beginner courses.", "context": "CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT e.EnrollmentId, c.Title FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId WHERE c.Difficulty = N'beginner';"}
{"question": "Display enrollments with course titles created this month.", "context": "CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT e.EnrollmentId, c.Title FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId WHERE YEAR(e.EnrolledOn)=YEAR(SYSUTCDATETIME()) AND MONTH(e.EnrolledOn)=MONTH(SYSUTCDATETIME());"}
{"question": "Show enrollments with course price and title.", "context": "CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT e.EnrollmentId, c.Title, c.Price FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId;"}
{"question": "Show quiz attempts with student names.", "context": "CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT qa.AttemptId, a.FullName, qa.Score FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId;"}
{"question": "List attempts score >= 90 with student names.", "context": "CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT a.FullName, qa.Score FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId WHERE qa.Score >= 90;"}
{"question": "Get attempts submitted today with student names.", "context": "CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT a.FullName, qa.SubmittedAt, qa.Score FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId WHERE CAST(qa.SubmittedAt AS DATE) = CAST(SYSUTCDATETIME() AS DATE);"}
{"question": "Display latest 10 attempts with names.", "context": "CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT TOP (10) a.FullName, qa.Score FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId ORDER BY qa.SubmittedAt DESC;"}
{"question": "Show attempts where correct equals total with names.", "context": "CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT a.FullName, qa.Score FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId WHERE qa.CorrectAnswers = qa.TotalQuestions;"}
{"question": "List attempts with quiz titles.", "context": "CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);", "answer": "SELECT qa.AttemptId, q.Title AS QuizTitle, qa.Score FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId;"}
{"question": "Show attempts for quizzes with at least 3 questions.", "context": "CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);", "answer": "SELECT q.Title, qa.Score FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId WHERE q.TotalQuestions >= 3;"}
{"question": "Get attempts in last 30 days with quiz titles.", "context": "CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);", "answer": "SELECT q.Title, qa.Score FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId WHERE qa.SubmittedAt >= DATEADD(DAY, -30, SYSUTCDATETIME());"}
{"question": "Display top 5 attempts by score with quiz titles.", "context": "CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);", "answer": "SELECT TOP (5) q.Title, qa.Score FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId ORDER BY qa.Score DESC, qa.SubmittedAt DESC;"}
{"question": "Show attempts where score between 70 and 100 with quiz titles.", "context": "CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);", "answer": "SELECT q.Title, qa.Score FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId WHERE qa.Score BETWEEN 70 AND 100;"}
{"question": "List course reviews with course titles.", "context": "CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT c.Title, r.Rating, r.Comment FROM CourseReviews r JOIN Courses c ON r.CourseId = c.CourseId;"}
{"question": "Show five star reviews with course titles.", "context": "CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT c.Title, r.Comment FROM CourseReviews r JOIN Courses c ON r.CourseId = c.CourseId WHERE r.Rating = 5;"}
{"question": "Get recent 10 reviews with course titles.", "context": "CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT TOP (10) c.Title, r.Rating FROM CourseReviews r JOIN Courses c ON r.CourseId = c.CourseId ORDER BY r.CreatedAt DESC;"}
{"question": "Display reviews this month with course titles.", "context": "CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT c.Title, r.Rating FROM CourseReviews r JOIN Courses c ON r.CourseId = c.CourseId WHERE YEAR(r.CreatedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(r.CreatedAt)=MONTH(SYSUTCDATETIME());"}
{"question": "Show reviews with comment containing useful and course titles.", "context": "CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT c.Title, r.Comment FROM CourseReviews r JOIN Courses c ON r.CourseId = c.CourseId WHERE r.Comment LIKE N'%useful%';"}
{"question": "List course instructor mappings with instructor names.", "context": "CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT ci.CourseId, a.FullName, ci.RoleInCourse FROM CourseInstructors ci JOIN Accounts a ON ci.AccountId = a.AccountId;"}
{"question": "Show instructor ids and course ids from mapping.", "context": "CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT a.AccountId AS InstructorId, ci.CourseId FROM CourseInstructors ci JOIN Accounts a ON ci.AccountId = a.AccountId;"}
{"question": "Get lead instructors in mapping with names.", "context": "CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT a.FullName, ci.CourseId FROM CourseInstructors ci JOIN Accounts a ON ci.AccountId = a.AccountId WHERE ci.RoleInCourse = N'Lead';"}
{"question": "Display mapping ordered by course then instructor name.", "context": "CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT ci.CourseId, a.FullName FROM CourseInstructors ci JOIN Accounts a ON ci.AccountId = a.AccountId ORDER BY ci.CourseId, a.FullName;"}
{"question": "Show distinct instructor ids from mapping.", "context": "CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT DISTINCT a.AccountId FROM CourseInstructors ci JOIN Accounts a ON ci.AccountId = a.AccountId;"}
{"question": "How many accounts per role.", "context": "CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT Role, COUNT(*) AS Total FROM Accounts GROUP BY Role;"}
{"question": "Average account per day created this month.", "context": "CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT CAST(CreatedAt AS DATE) AS DayUTC, COUNT(*) AS NewAccounts FROM Accounts WHERE YEAR(CreatedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(CreatedAt)=MONTH(SYSUTCDATETIME()) GROUP BY CAST(CreatedAt AS DATE) ORDER BY DayUTC;"}
{"question": "Count active instructors.", "context": "CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT COUNT(*) AS ActiveInstructors FROM Accounts WHERE Role=N'Instructor' AND IsActive=1;"}
{"question": "Top 3 newest instructors by created time.", "context": "CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT TOP (3) * FROM Accounts WHERE Role=N'Instructor' ORDER BY CreatedAt DESC;"}
{"question": "Number of students.", "context": "CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT COUNT(*) AS Students FROM Accounts WHERE Role=N'Student';"}
{"question": "How many courses per difficulty.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT Difficulty, COUNT(*) AS NumCourses FROM Courses GROUP BY Difficulty;"}
{"question": "Average course price by difficulty.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT Difficulty, AVG(Price) AS AvgPrice FROM Courses GROUP BY Difficulty;"}
{"question": "Most expensive course.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT TOP (1) * FROM Courses ORDER BY Price DESC;"}
{"question": "Cheapest 5 courses.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT TOP (5) * FROM Courses ORDER BY Price ASC;"}
{"question": "Total published courses.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT COUNT(*) AS Published FROM Courses WHERE IsPublished=1;"}
{"question": "Lesson count per course.", "context": "CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT c.Title, COUNT(l.LessonId) AS LessonCount FROM Courses c LEFT JOIN Lessons l ON c.CourseId = l.CourseId GROUP BY c.Title;"}
{"question": "Newest lesson per course (by created time).", "context": "CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT c.Title, MAX(l.CreatedAt) AS NewestLesson FROM Courses c LEFT JOIN Lessons l ON c.CourseId = l.CourseId GROUP BY c.Title;"}
{"question": "How many quiz lessons exist.", "context": "CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);", "answer": "SELECT COUNT(*) AS QuizLessons FROM Lessons WHERE LessonType=N'quiz';"}
{"question": "Average ordering value per course.", "context": "CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);", "answer": "SELECT CourseId, AVG(CAST(Ordering AS DECIMAL(10,2))) AS AvgOrder FROM Lessons GROUP BY CourseId;"}
{"question": "Top 10 recent lessons.", "context": "CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);", "answer": "SELECT TOP (10) * FROM Lessons ORDER BY CreatedAt DESC;"}
{"question": "Total questions per quiz.", "context": "CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);", "answer": "SELECT q.Title, COUNT(qq.QuestionId) AS QuestionCount FROM Quizzes q LEFT JOIN QuizQuestions qq ON q.QuizId = qq.QuizId GROUP BY q.Title;"}
{"question": "Quizzes having more than 2 questions.", "context": "CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);", "answer": "SELECT q.Title FROM Quizzes q LEFT JOIN QuizQuestions qq ON q.QuizId = qq.QuizId GROUP BY q.Title HAVING COUNT(qq.QuestionId) > 2;"}
{"question": "Latest question id per quiz.", "context": "CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);", "answer": "SELECT QuizId, MAX(QuestionId) AS MaxQid FROM QuizQuestions GROUP BY QuizId;"}
{"question": "Count questions that have option A as the first choice text length > 5.", "context": "CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);", "answer": "SELECT COUNT(*) AS Cnt FROM QuizQuestions WHERE LEN(OptionA) > 5;"}
{"question": "Questions mentioning SQL or JOIN.", "context": "CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR, CorrectOption TINYINT);", "answer": "SELECT COUNT(*) AS Cnt FROM QuizQuestions WHERE Question LIKE N'%SQL%' OR Question LIKE N'%JOIN%';"}
{"question": "Enrollments per course.", "context": "CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT c.Title, COUNT(e.EnrollmentId) AS EnrollCount FROM Courses c LEFT JOIN Enrollments e ON c.CourseId = e.CourseId GROUP BY c.Title;"}
{"question": "Completed enrollments per course.", "context": "CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT c.Title, COUNT(*) AS Completed FROM Courses c JOIN Enrollments e ON c.CourseId = e.CourseId WHERE e.IsCompleted=1 GROUP BY c.Title;"}
{"question": "Average progress per course.", "context": "CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT c.Title, AVG(e.ProgressPercent) AS AvgProgress FROM Courses c JOIN Enrollments e ON c.CourseId = e.CourseId GROUP BY c.Title;"}
{"question": "Average progress per student.", "context": "CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT a.FullName, AVG(e.ProgressPercent) AS AvgProgress FROM Accounts a JOIN Enrollments e ON a.AccountId=e.AccountId GROUP BY a.FullName;"}
{"question": "Monthly enrollments in current year.", "context": "CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);", "answer": "SELECT MONTH(EnrolledOn) AS MonthNum, COUNT(*) AS EnrollCount FROM Enrollments WHERE YEAR(EnrolledOn)=YEAR(SYSUTCDATETIME()) GROUP BY MONTH(EnrolledOn) ORDER BY MonthNum;"}
{"question": "Average score by quiz.", "context": "CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);", "answer": "SELECT q.Title, AVG(qa.Score) AS AvgScore FROM Quizzes q LEFT JOIN QuizAttempts qa ON q.QuizId = qa.QuizId GROUP BY q.Title;"}
{"question": "Top score per student.", "context": "CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, PasswordHash NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);", "answer": "SELECT a.FullName, MAX(qa.Score) AS MaxScore FROM Accounts a LEFT JOIN QuizAttempts qa ON a.AccountId=qa.AccountId GROUP BY a.FullName;"}
{"question": "Attempts today per account.", "context": "CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);", "answer": "SELECT AccountId, COUNT(*) AS AttemptsToday FROM QuizAttempts WHERE CAST(SubmittedAt AS DATE)=CAST(SYSUTCDATETIME() AS DATE) GROUP BY AccountId;"}
{"question": "Attempts in last 7 days.", "context": "CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);", "answer": "SELECT COUNT(*) AS AttemptsLast7Days FROM QuizAttempts WHERE SubmittedAt >= DATEADD(DAY,-7,SYSUTCDATETIME());"}
{"question": "Perfect attempts count.", "context": "CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);", "answer": "SELECT COUNT(*) AS Perfect FROM QuizAttempts WHERE CorrectAnswers = TotalQuestions;"}
{"question": "Average rating per course.", "context": "CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT c.Title, AVG(CAST(r.Rating AS DECIMAL(10,2))) AS AvgRating FROM Courses c LEFT JOIN CourseReviews r ON c.CourseId=r.CourseId GROUP BY c.Title;"}
{"question": "Reviews count by rating value.", "context": "CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);", "answer": "SELECT Rating, COUNT(*) AS ReviewCount FROM CourseReviews GROUP BY Rating;"}
{"question": "Recent reviews in last 30 days.", "context": "CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);", "answer": "SELECT COUNT(*) AS ReviewCount FROM CourseReviews WHERE CreatedAt >= DATEADD(DAY,-30,SYSUTCDATETIME());"}
{"question": "Five-star review ratio.", "context": "CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);", "answer": "SELECT CAST(COUNT(CASE WHEN Rating=5 THEN 1 END) AS DECIMAL(10,2)) / NULLIF(COUNT(*),0) AS FiveStarRatio FROM CourseReviews;"}
{"question": "Top 5 courses by average rating.", "context": "CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);", "answer": "SELECT TOP (5) c.Title, AVG(r.Rating) AS AvgRating FROM Courses c JOIN CourseReviews r ON c.CourseId=r.CourseId GROUP BY c.Title ORDER BY AvgRating DESC;"}
{"question": "Show courses with their category names ordered by title ascending.", "context": "CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Summary NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);", "answer": "SELECT c.Title, g.Name AS CategoryName FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId ORDER BY c.Title ASC;"}
{"question":"Show all instructor accounts with basic fields.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT AccountId, FullName, Email, CreatedAt FROM Accounts WHERE Role = N'Instructor';"}
{"question":"List active student accounts only.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE Role = N'Student' AND IsActive = 1;"}
{"question":"Display all category codes and names.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT Code, Name FROM Categories;"}
{"question":"Get all published courses (simple list).","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE IsPublished = 1;"}
{"question":"Show course titles and prices only.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, Price DECIMAL);","answer":"SELECT Title, Price FROM Courses;"}
{"question":"List all lessons with their ordering number.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT LessonId, Title, Ordering FROM Lessons;"}
{"question":"Display all quizzes with total questions.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT QuizId, Title, TotalQuestions FROM Quizzes;"}
{"question":"Show every quiz question id and its correct option.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, CorrectOption TINYINT);","answer":"SELECT QuestionId, CorrectOption FROM QuizQuestions;"}
{"question":"List all enrollments with progress percentage.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT);","answer":"SELECT EnrollmentId, AccountId, CourseId, ProgressPercent FROM Enrollments;"}
{"question":"Show all quiz attempts with scores.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, Score INT, SubmittedAt DATETIME2);","answer":"SELECT AttemptId, QuizId, AccountId, Score FROM QuizAttempts;"}
{"question":"Get all course reviews with rating and comment.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT ReviewId, CourseId, AccountId, Rating, Comment FROM CourseReviews;"}
{"question":"Display all course instructor mappings.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR);","answer":"SELECT * FROM CourseInstructors;"}
{"question":"Show accounts created this month (UTC).","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE YEAR(CreatedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(CreatedAt)=MONTH(SYSUTCDATETIME());"}
{"question":"List courses created today (UTC).","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE CAST(CreatedAt AS DATE)=CAST(SYSUTCDATETIME() AS DATE);"}
{"question":"Find lessons created in the last 7 days.","context":"CREATE TABLE Lessons (LessonId INT, Title NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons WHERE CreatedAt >= DATEADD(DAY,-7,SYSUTCDATETIME());"}
{"question":"Show quizzes with at least 3 questions.","context":"CREATE TABLE Quizzes (QuizId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT * FROM Quizzes WHERE TotalQuestions >= 3;"}
{"question":"List quiz questions where the text mentions SQL.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR);","answer":"SELECT * FROM QuizQuestions WHERE Question LIKE N'%SQL%';"}
{"question":"Get enrollments completed in the current year.","context":"CREATE TABLE Enrollments (EnrollmentId INT, CompletionDate DATETIME2, IsCompleted BIT);","answer":"SELECT * FROM Enrollments WHERE IsCompleted=1 AND YEAR(CompletionDate)=YEAR(SYSUTCDATETIME());"}
{"question":"Display attempts submitted yesterday (UTC).","context":"CREATE TABLE QuizAttempts (AttemptId INT, SubmittedAt DATETIME2);","answer":"SELECT * FROM QuizAttempts WHERE CAST(SubmittedAt AS DATE)=CAST(DATEADD(DAY,-1,SYSUTCDATETIME()) AS DATE);"}
{"question":"Show five star reviews only.","context":"CREATE TABLE CourseReviews (ReviewId INT, Rating INT);","answer":"SELECT * FROM CourseReviews WHERE Rating = 5;"}
{"question":"Show categories sorted by code ascending.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR);","answer":"SELECT * FROM Categories ORDER BY Code ASC;"}
{"question":"Get top 5 newest accounts.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT TOP (5) * FROM Accounts ORDER BY CreatedAt DESC;"}
{"question":"List courses ordered by price descending.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, Price DECIMAL);","answer":"SELECT * FROM Courses ORDER BY Price DESC;"}
{"question":"Return first 10 lessons by newest created time.","context":"CREATE TABLE Lessons (LessonId INT, Title NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT TOP (10) * FROM Lessons ORDER BY CreatedAt DESC;"}
{"question":"Paginate courses page 1 size 10 by title.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT * FROM Courses ORDER BY Title OFFSET 0 ROWS FETCH NEXT 10 ROWS ONLY;"}
{"question":"Find accounts whose email ends with .com.","context":"CREATE TABLE Accounts (AccountId INT, Email NVARCHAR);","answer":"SELECT * FROM Accounts WHERE Email LIKE N'%.com';"}
{"question":"Search course titles that begin with Intro.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT * FROM Courses WHERE Title LIKE N'Intro%';"}
{"question":"List lessons with title containing Quiz.","context":"CREATE TABLE Lessons (LessonId INT, Title NVARCHAR);","answer":"SELECT * FROM Lessons WHERE Title LIKE N'%Quiz%';"}
{"question":"Get courses priced between 100000 and 250000.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, Price DECIMAL);","answer":"SELECT * FROM Courses WHERE Price BETWEEN 100000 AND 250000;"}
{"question":"Show accounts not in Admin or Instructor role.","context":"CREATE TABLE Accounts (AccountId INT, Role NVARCHAR);","answer":"SELECT * FROM Accounts WHERE Role NOT IN (N'Admin',N'Instructor');"}
{"question":"Return quizzes where total questions not in 1 or 2.","context":"CREATE TABLE Quizzes (QuizId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT * FROM Quizzes WHERE TotalQuestions NOT IN (1,2);"}
{"question":"Display enrollments with zero progress excluded.","context":"CREATE TABLE Enrollments (EnrollmentId INT, ProgressPercent REAL);","answer":"SELECT * FROM Enrollments WHERE ProgressPercent > 0;"}
{"question":"Show attempts with score between 60 and 90.","context":"CREATE TABLE QuizAttempts (AttemptId INT, Score INT);","answer":"SELECT * FROM QuizAttempts WHERE Score BETWEEN 60 AND 90;"}
{"question":"List reviews with comment not null.","context":"CREATE TABLE CourseReviews (ReviewId INT, Comment NVARCHAR);","answer":"SELECT * FROM CourseReviews WHERE Comment IS NOT NULL;"}
{"question":"Show course titles with category names (join).","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT c.Title, g.Name AS CategoryName FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId;"}
{"question":"List courses and instructor names (join).","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, InstructorId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT c.Title, a.FullName AS InstructorName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId;"}
{"question":"Display lessons with their course titles (join).","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, Title NVARCHAR);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT l.Title AS LessonTitle, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId;"}
{"question":"Get quizzes with lesson titles (join).","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR);\nCREATE TABLE Lessons (LessonId INT, Title NVARCHAR);","answer":"SELECT q.Title AS QuizTitle, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId;"}
{"question":"Show quiz questions with quiz titles (join).","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT qq.Question, q.Title AS QuizTitle FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId;"}
{"question":"List enrollments with student names (join).","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT e.EnrollmentId, a.FullName FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId;"}
{"question":"Show enrollments with course titles (join).","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT e.EnrollmentId, c.Title AS CourseTitle FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId;"}
{"question":"Display attempts with quiz titles (join).","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, Score INT);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT qa.AttemptId, q.Title AS QuizTitle, qa.Score FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId;"}
{"question":"Get attempts with student names (join).","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT qa.AttemptId, a.FullName, qa.Score FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId;"}
{"question":"Show reviews with course titles (join).","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Rating INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, r.Rating FROM CourseReviews r JOIN Courses c ON r.CourseId = c.CourseId;"}
{"question":"List course instructor mappings with names (join).","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT ci.CourseId, a.FullName FROM CourseInstructors ci JOIN Accounts a ON ci.AccountId = a.AccountId;"}
{"question":"Count accounts per role (basic aggregate).","context":"CREATE TABLE Accounts (AccountId INT, Role NVARCHAR);","answer":"SELECT Role, COUNT(*) AS Total FROM Accounts GROUP BY Role;"}
{"question":"Average course price by difficulty.","context":"CREATE TABLE Courses (CourseId INT, Difficulty NVARCHAR, Price DECIMAL);","answer":"SELECT Difficulty, AVG(Price) AS AvgPrice FROM Courses GROUP BY Difficulty;"}
{"question":"Total enrollments per course (join and group).","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, COUNT(e.EnrollmentId) AS EnrollCount FROM Courses c LEFT JOIN Enrollments e ON c.CourseId = e.CourseId GROUP BY c.Title;"}
{"question":"Average progress percent per student.","context":"CREATE TABLE Enrollments (AccountId INT, ProgressPercent REAL);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, AVG(e.ProgressPercent) AS AvgProgress FROM Accounts a JOIN Enrollments e ON a.AccountId = e.AccountId GROUP BY a.FullName;"}
{"question":"Average quiz score per quiz title.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, Score INT);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, AVG(qa.Score) AS AvgScore FROM Quizzes q LEFT JOIN QuizAttempts qa ON q.QuizId = qa.QuizId GROUP BY q.Title;"}
{"question":"Number of questions per quiz.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, COUNT(qq.QuestionId) AS QuestionCount FROM Quizzes q LEFT JOIN QuizQuestions qq ON q.QuizId = qq.QuizId GROUP BY q.Title;"}
{"question":"Count reviews by rating value.","context":"CREATE TABLE CourseReviews (ReviewId INT, Rating INT);","answer":"SELECT Rating, COUNT(*) AS ReviewCount FROM CourseReviews GROUP BY Rating;"}
{"question":"Top 5 courses by average rating.","context":"CREATE TABLE CourseReviews (CourseId INT, Rating INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT TOP (5) c.Title, AVG(r.Rating) AS AvgRating FROM Courses c JOIN CourseReviews r ON c.CourseId = r.CourseId GROUP BY c.Title ORDER BY AvgRating DESC;"}
{"question":"Show total attempts per student (join and group).","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, COUNT(qa.AttemptId) AS TotalAttempts FROM Accounts a LEFT JOIN QuizAttempts qa ON a.AccountId = qa.AccountId GROUP BY a.FullName;"}
{"question":"Find courses without any lessons (anti-join style).","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR);\nCREATE TABLE Lessons (LessonId INT, CourseId INT);","answer":"SELECT c.Title FROM Courses c LEFT JOIN Lessons l ON c.CourseId = l.CourseId WHERE l.LessonId IS NULL;"}
{"question":"Get the most expensive course.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, Price DECIMAL);","answer":"SELECT TOP (1) * FROM Courses ORDER BY Price DESC;"}
{"question":"Show the cheapest 3 courses.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, Price DECIMAL);","answer":"SELECT TOP (3) * FROM Courses ORDER BY Price ASC;"}
{"question":"Count beginner courses.","context":"CREATE TABLE Courses (CourseId INT, Difficulty NVARCHAR);","answer":"SELECT COUNT(*) AS BeginnerCount FROM Courses WHERE Difficulty = N'beginner';"}
{"question":"Total number of quiz lessons.","context":"CREATE TABLE Lessons (LessonId INT, LessonType NVARCHAR);","answer":"SELECT COUNT(*) AS QuizLessonCount FROM Lessons WHERE LessonType = N'quiz';"}
{"question":"Average ordering per course id.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, Ordering INT);","answer":"SELECT CourseId, AVG(CAST(Ordering AS DECIMAL(10,2))) AS AvgOrdering FROM Lessons GROUP BY CourseId;"}
{"question":"Latest lesson time per course.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, MAX(l.CreatedAt) AS LatestLesson FROM Courses c LEFT JOIN Lessons l ON c.CourseId = l.CourseId GROUP BY c.Title;"}
{"question":"Top 5 students by number of enrollments.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT TOP (5) a.FullName, COUNT(e.EnrollmentId) AS EnrollCount FROM Accounts a JOIN Enrollments e ON a.AccountId = e.AccountId GROUP BY a.FullName ORDER BY EnrollCount DESC;"}
{"question":"Enrollments by month of current year.","context":"CREATE TABLE Enrollments (EnrollmentId INT, EnrolledOn DATETIME2);","answer":"SELECT MONTH(EnrolledOn) AS MonthNum, COUNT(*) AS EnrollCount FROM Enrollments WHERE YEAR(EnrolledOn)=YEAR(SYSUTCDATETIME()) GROUP BY MONTH(EnrolledOn) ORDER BY MonthNum;"}
{"question":"Attempts today by account id.","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, SubmittedAt DATETIME2);","answer":"SELECT AccountId, COUNT(*) AS AttemptsToday FROM QuizAttempts WHERE CAST(SubmittedAt AS DATE)=CAST(SYSUTCDATETIME() AS DATE) GROUP BY AccountId;"}
{"question":"Five star review ratio (simple).","context":"CREATE TABLE CourseReviews (ReviewId INT, Rating INT);","answer":"SELECT CAST(COUNT(CASE WHEN Rating=5 THEN 1 END) AS DECIMAL(10,2)) / NULLIF(COUNT(*),0) AS FiveStarRatio FROM CourseReviews;"}
{"question":"Show courses and category names for beginner difficulty.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Difficulty NVARCHAR);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT c.Title, g.Name AS CategoryName FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId WHERE c.Difficulty = N'beginner';"}
{"question":"List courses and instructor names created this month.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT c.Title, a.FullName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId WHERE YEAR(c.CreatedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(c.CreatedAt)=MONTH(SYSUTCDATETIME());"}
{"question":"Display lessons and their course titles where type is video.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT l.Title AS LessonTitle, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE l.LessonType = N'video';"}
{"question":"Get quizzes and lesson titles ordered by lesson title.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR);\nCREATE TABLE Lessons (LessonId INT, Title NVARCHAR);","answer":"SELECT q.Title AS QuizTitle, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId ORDER BY l.Title;"}
{"question":"Show questions and quiz titles for questions that mention WHERE.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT qq.Question, q.Title FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId WHERE qq.Question LIKE N'%WHERE%';"}
{"question":"List enrollments with student names where progress over 50.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, ProgressPercent REAL);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, e.ProgressPercent FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId WHERE e.ProgressPercent > 50;"}
{"question":"Show enrollments and course titles for completed entries.","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT e.EnrollmentId, c.Title FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId WHERE e.IsCompleted = 1;"}
{"question":"Display attempts and student names with score >= 90.","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, qa.Score FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId WHERE qa.Score >= 90;"}
{"question":"Get attempts and quiz titles in the last 30 days.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, SubmittedAt DATETIME2, Score INT);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, qa.Score FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId WHERE qa.SubmittedAt >= DATEADD(DAY,-30,SYSUTCDATETIME());"}
{"question":"Show reviews with course titles created this month.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Rating INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, r.Rating FROM CourseReviews r JOIN Courses c ON r.CourseId = c.CourseId WHERE YEAR(r.CreatedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(r.CreatedAt)=MONTH(SYSUTCDATETIME());"}
{"question":"List instructor mappings with names for role Lead only.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, ci.CourseId FROM CourseInstructors ci JOIN Accounts a ON ci.AccountId = a.AccountId WHERE ci.RoleInCourse = N'Lead';"}
{"question":"How many courses per category name.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT g.Name, COUNT(c.CourseId) AS CourseCount FROM Categories g LEFT JOIN Courses c ON g.CategoryId = c.CategoryId GROUP BY g.Name;"}
{"question":"How many lessons each course has.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, COUNT(l.LessonId) AS LessonCount FROM Courses c LEFT JOIN Lessons l ON c.CourseId = l.CourseId GROUP BY c.Title;"}
{"question":"Average score per student name.","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, AVG(qa.Score) AS AvgScore FROM Accounts a JOIN QuizAttempts qa ON a.AccountId = qa.AccountId GROUP BY a.FullName;"}
{"question":"Total reviews per course title.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, COUNT(r.ReviewId) AS ReviewCount FROM Courses c LEFT JOIN CourseReviews r ON c.CourseId = r.CourseId GROUP BY c.Title;"}
{"question":"Highest average rating by course title (top 1).","context":"CREATE TABLE CourseReviews (CourseId INT, Rating INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT TOP (1) c.Title, AVG(r.Rating) AS AvgRating FROM CourseReviews r JOIN Courses c ON c.CourseId = r.CourseId GROUP BY c.Title ORDER BY AvgRating DESC;"}
{"question":"Student counts per category via enrollments.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, CategoryId INT);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT g.Name, COUNT(e.EnrollmentId) AS StudentCount FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId JOIN Categories g ON c.CategoryId = g.CategoryId GROUP BY g.Name;"}
{"question":"Published course counts per instructor.","context":"CREATE TABLE Courses (CourseId INT, InstructorId INT, IsPublished BIT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, COUNT(*) AS PublishedCourses FROM Accounts a JOIN Courses c ON a.AccountId = c.InstructorId WHERE c.IsPublished = 1 GROUP BY a.FullName;"}
{"question":"Average progress per course title.","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, AVG(e.ProgressPercent) AS AvgProgress FROM Courses c JOIN Enrollments e ON c.CourseId = e.CourseId GROUP BY c.Title;"}
{"question":"Total quizzes per course title (join 2 tables).","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, COUNT(q.QuizId) AS QuizCount FROM Courses c JOIN Lessons l ON c.CourseId = l.CourseId JOIN Quizzes q ON q.LessonId = l.LessonId GROUP BY c.Title;"}
{"question":"Attempt counts per quiz title.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, COUNT(qa.AttemptId) AS AttemptCount FROM Quizzes q LEFT JOIN QuizAttempts qa ON q.QuizId = qa.QuizId GROUP BY q.Title;"}
{"question":"Newest accounts by created time (top 10).","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT TOP (10) * FROM Accounts ORDER BY CreatedAt DESC;"}
{"question":"Courses ordered by title then price desc.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, Price DECIMAL);","answer":"SELECT * FROM Courses ORDER BY Title ASC, Price DESC;"}
{"question":"Last 5 attempts by submitted time.","context":"CREATE TABLE QuizAttempts (AttemptId INT, SubmittedAt DATETIME2, Score INT);","answer":"SELECT TOP (5) * FROM QuizAttempts ORDER BY SubmittedAt DESC;"}
{"question":"Find categories with codes starting CAT0.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR);","answer":"SELECT * FROM Categories WHERE Code LIKE N'CAT0%';"}
{"question":"Find accounts whose name contains Anh.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT * FROM Accounts WHERE FullName LIKE N'%Anh%';"}
{"question":"Find courses whose title ends with 101.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT * FROM Courses WHERE Title LIKE N'%101';"}
{"question":"Find lessons whose type is quiz or video.","context":"CREATE TABLE Lessons (LessonId INT, LessonType NVARCHAR, Title NVARCHAR);","answer":"SELECT * FROM Lessons WHERE LessonType IN (N'quiz',N'video');"}
{"question":"Exclude courses containing Crash in title.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT * FROM Courses WHERE Title NOT LIKE N'%Crash%';"}
{"question":"Return quizzes for lesson id greater than 10.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR);","answer":"SELECT * FROM Quizzes WHERE LessonId > 10;"}
{"question":"Enrollments with completion date not null.","context":"CREATE TABLE Enrollments (EnrollmentId INT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE CompletionDate IS NOT NULL;"}
{"question":"Attempts with non-null submitted time.","context":"CREATE TABLE QuizAttempts (AttemptId INT, SubmittedAt DATETIME2);","answer":"SELECT * FROM QuizAttempts WHERE SubmittedAt IS NOT NULL;"}
{"question":"Reviews created in the last 30 days.","context":"CREATE TABLE CourseReviews (ReviewId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE CreatedAt >= DATEADD(DAY,-30,SYSUTCDATETIME());"}
{"question":"Courses with category names where price under 120000.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Price DECIMAL);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT c.Title, g.Name FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId WHERE c.Price < 120000;"}
{"question":"Courses with instructor names for advanced level.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, Difficulty NVARCHAR, InstructorId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT c.Title, a.FullName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId WHERE c.Difficulty = N'advanced';"}
{"question":"Lessons with course titles where ordering greater than 1.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, Title NVARCHAR, Ordering INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT l.Title, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE l.Ordering > 1;"}
{"question":"Quizzes with lesson titles for total questions >= 3.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, Title NVARCHAR);","answer":"SELECT q.Title, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId WHERE q.TotalQuestions >= 3;"}
{"question":"Questions and quiz titles where question mentions JOIN.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT qq.Question, q.Title FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId WHERE qq.Question LIKE N'%JOIN%';"}
{"question":"Enrollments and student names for current month.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, EnrolledOn DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, e.EnrolledOn FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId WHERE YEAR(e.EnrolledOn)=YEAR(SYSUTCDATETIME()) AND MONTH(e.EnrolledOn)=MONTH(SYSUTCDATETIME());"}
{"question":"Enrollments and course titles where not completed.","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT e.EnrollmentId, c.Title FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId WHERE e.IsCompleted = 0;"}
{"question":"Attempts and quiz titles ordered by score desc.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, Score INT, SubmittedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, qa.Score FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId ORDER BY qa.Score DESC, qa.SubmittedAt DESC;"}
{"question":"Attempts and student names with perfect correctness.","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, qa.AttemptId FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId WHERE qa.CorrectAnswers = qa.TotalQuestions;"}
{"question":"Reviews with course titles where rating >= 4.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Rating INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, r.Rating FROM CourseReviews r JOIN Courses c ON r.CourseId = c.CourseId WHERE r.Rating >= 4;"}
{"question":"Instructor mappings with names ordered by course id.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT ci.CourseId, a.FullName FROM CourseInstructors ci JOIN Accounts a ON ci.AccountId = a.AccountId ORDER BY ci.CourseId;"}
{"question":"How many beginner courses in each category.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Difficulty NVARCHAR);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT g.Name, COUNT(*) AS BeginnerCount FROM Categories g JOIN Courses c ON g.CategoryId = c.CategoryId WHERE c.Difficulty = N'beginner' GROUP BY g.Name;"}
{"question":"Average lesson ordering per course title.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, Ordering INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, AVG(CAST(l.Ordering AS DECIMAL(10,2))) AS AvgOrdering FROM Courses c JOIN Lessons l ON c.CourseId = l.CourseId GROUP BY c.Title;"}
{"question":"Average attempt score per student name.","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, AVG(qa.Score) AS AvgScore FROM Accounts a JOIN QuizAttempts qa ON a.AccountId = qa.AccountId GROUP BY a.FullName;"}
{"question":"Total attempts per quiz title in the last 7 days.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, SubmittedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, COUNT(*) AS Attempts7d FROM Quizzes q JOIN QuizAttempts qa ON q.QuizId = qa.QuizId WHERE qa.SubmittedAt >= DATEADD(DAY,-7,SYSUTCDATETIME()) GROUP BY q.Title;"}
{"question":"Review count per rating value this month.","context":"CREATE TABLE CourseReviews (ReviewId INT, Rating INT, CreatedAt DATETIME2);","answer":"SELECT Rating, COUNT(*) AS Cnt FROM CourseReviews WHERE YEAR(CreatedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(CreatedAt)=MONTH(SYSUTCDATETIME()) GROUP BY Rating;"}
{"question":"Top 3 instructors by number of published courses.","context":"CREATE TABLE Courses (CourseId INT, InstructorId INT, IsPublished BIT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT TOP (3) a.FullName, COUNT(*) AS PublishedCount FROM Accounts a JOIN Courses c ON a.AccountId = c.InstructorId WHERE c.IsPublished = 1 GROUP BY a.FullName ORDER BY PublishedCount DESC;"}
{"question":"Show distinct instructor ids from the mapping table.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT DISTINCT AccountId FROM CourseInstructors;"}
{"question":"Get all student accounts with only names.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Role NVARCHAR);","answer":"SELECT FullName FROM Accounts WHERE Role = N'Student';"}
{"question":"Display course ids and category ids simple list.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT);","answer":"SELECT CourseId, CategoryId FROM Courses;"}
{"question":"List lesson ids with their course ids simple view.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT);","answer":"SELECT LessonId, CourseId FROM Lessons;"}
{"question":"Show quiz ids and their lesson ids.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT);","answer":"SELECT QuizId, LessonId FROM Quizzes;"}
{"question":"Return question ids and quiz ids only.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT);","answer":"SELECT QuestionId, QuizId FROM QuizQuestions;"}
{"question":"Get enrollment ids with account and course ids.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);","answer":"SELECT EnrollmentId, AccountId, CourseId FROM Enrollments;"}
{"question":"Show attempt ids with quiz ids and scores.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, Score INT);","answer":"SELECT AttemptId, QuizId, Score FROM QuizAttempts;"}
{"question":"List review ids with course ids and rating numbers.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Rating INT);","answer":"SELECT ReviewId, CourseId, Rating FROM CourseReviews;"}
{"question":"Display mapping ids with course and account ids.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT Id, CourseId, AccountId FROM CourseInstructors;"}
{"question":"Find courses with title containing Data.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT * FROM Courses WHERE Title LIKE N'%Data%';"}
{"question":"Find accounts from example.com domain.","context":"CREATE TABLE Accounts (AccountId INT, Email NVARCHAR);","answer":"SELECT * FROM Accounts WHERE Email LIKE N'%@example.com';"}
{"question":"Find lessons created last 24 hours.","context":"CREATE TABLE Lessons (LessonId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons WHERE CreatedAt >= DATEADD(HOUR,-24,SYSUTCDATETIME());"}
{"question":"Find attempts with submitted time within this week.","context":"CREATE TABLE QuizAttempts (AttemptId INT, SubmittedAt DATETIME2);","answer":"SELECT * FROM QuizAttempts WHERE DATEDIFF(WEEK, SubmittedAt, SYSUTCDATETIME()) = 0;"}
{"question":"Find reviews created today with rating at least 4.","context":"CREATE TABLE CourseReviews (ReviewId INT, Rating INT, CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE Rating >= 4 AND CAST(CreatedAt AS DATE)=CAST(SYSUTCDATETIME() AS DATE);"}
{"question":"Get courses and categories ordered by course title asc.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT c.Title, g.Name FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId ORDER BY c.Title ASC;"}
{"question":"Get courses and instructor names ordered by instructor name.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, InstructorId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT c.Title, a.FullName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId ORDER BY a.FullName;"}
{"question":"Get lessons and course titles for quiz lesson type.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT l.Title, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE l.LessonType = N'quiz';"}
{"question":"Get quizzes and lesson titles for last 5 quizzes by id.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR);\nCREATE TABLE Lessons (LessonId INT, Title NVARCHAR);","answer":"SELECT TOP (5) q.Title, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId ORDER BY q.QuizId DESC;"}
{"question":"Get questions and quiz titles for latest 10 questions.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT TOP (10) qq.Question, q.Title FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId ORDER BY qq.QuestionId DESC;"}
{"question":"Get enrollments and student names for progress >= 80.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, ProgressPercent REAL);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, e.ProgressPercent FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId WHERE e.ProgressPercent >= 80;"}
{"question":"Get enrollments and course titles for cheap courses.","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR, Price DECIMAL);","answer":"SELECT e.EnrollmentId, c.Title FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId WHERE c.Price < 120000;"}
{"question":"Get attempts and names for perfect attempts.","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, qa.AttemptId FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId WHERE qa.CorrectAnswers = qa.TotalQuestions;"}
{"question":"Get attempts and quiz titles for score at least 85.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, Score INT, SubmittedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, qa.Score FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId WHERE qa.Score >= 85;"}
{"question":"Get reviews with titles where comment contains helpful.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Comment NVARCHAR);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, r.Comment FROM CourseReviews r JOIN Courses c ON r.CourseId = c.CourseId WHERE r.Comment LIKE N'%helpful%';"}
{"question":"Get mapping with names where role not Lead.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT ci.CourseId, a.FullName, ci.RoleInCourse FROM CourseInstructors ci JOIN Accounts a ON ci.AccountId = a.AccountId WHERE ci.RoleInCourse <> N'Lead';"}
{"question":"Average rating and count per course title.","context":"CREATE TABLE CourseReviews (CourseId INT, Rating INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, AVG(r.Rating) AS AvgRating, COUNT(*) AS ReviewCount FROM Courses c LEFT JOIN CourseReviews r ON c.CourseId = r.CourseId GROUP BY c.Title;"}
{"question":"Average score per quiz title in current month.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, Score INT, SubmittedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, AVG(qa.Score) AS AvgScore FROM Quizzes q JOIN QuizAttempts qa ON q.QuizId = qa.QuizId WHERE YEAR(qa.SubmittedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(qa.SubmittedAt)=MONTH(SYSUTCDATETIME()) GROUP BY q.Title;"}
{"question":"Completed enrollment counts per course title.","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, COUNT(*) AS CompletedCount FROM Courses c JOIN Enrollments e ON c.CourseId = e.CourseId WHERE e.IsCompleted = 1 GROUP BY c.Title;"}
{"question":"Question counts per quiz for quizzes with at least one question.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, COUNT(qq.QuestionId) AS QuestionCount FROM Quizzes q JOIN QuizQuestions qq ON q.QuizId = qq.QuizId GROUP BY q.Title HAVING COUNT(qq.QuestionId) >= 1;"}
{"question":"Attempts per student name in the last 14 days.","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, SubmittedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, COUNT(*) AS Attempts14d FROM Accounts a JOIN QuizAttempts qa ON a.AccountId = qa.AccountId WHERE qa.SubmittedAt >= DATEADD(DAY,-14,SYSUTCDATETIME()) GROUP BY a.FullName;"}
{"question":"Top 5 courses by enrollment count.","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT TOP (5) c.Title, COUNT(e.EnrollmentId) AS EnrollCount FROM Courses c LEFT JOIN Enrollments e ON c.CourseId = e.CourseId GROUP BY c.Title ORDER BY EnrollCount DESC;"}
{"question":"Show average and max course price.","context":"CREATE TABLE Courses (CourseId INT, Price DECIMAL);","answer":"SELECT AVG(Price) AS AvgPrice, MAX(Price) AS MaxPrice FROM Courses;"}
{"question":"Show min and max lesson ordering per course.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, Ordering INT);","answer":"SELECT CourseId, MIN(Ordering) AS MinOrd, MAX(Ordering) AS MaxOrd FROM Lessons GROUP BY CourseId;"}
{"question":"Show count of five star reviews per course title.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Rating INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, COUNT(*) AS FiveStar FROM Courses c JOIN CourseReviews r ON c.CourseId = r.CourseId WHERE r.Rating = 5 GROUP BY c.Title;"}
{"question":"Show average progress percent per category name.","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);\nCREATE TABLE Courses (CourseId INT, CategoryId INT);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT g.Name, AVG(e.ProgressPercent) AS AvgProgress FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId JOIN Categories g ON c.CategoryId = g.CategoryId GROUP BY g.Name;"}
{"question":"Get distinct roles from accounts.","context":"CREATE TABLE Accounts (AccountId INT, Role NVARCHAR);","answer":"SELECT DISTINCT Role FROM Accounts;"}
{"question":"Get distinct difficulties from courses.","context":"CREATE TABLE Courses (CourseId INT, Difficulty NVARCHAR);","answer":"SELECT DISTINCT Difficulty FROM Courses WHERE Difficulty IS NOT NULL;"}
{"question":"Get distinct lesson types from lessons.","context":"CREATE TABLE Lessons (LessonId INT, LessonType NVARCHAR);","answer":"SELECT DISTINCT LessonType FROM Lessons;"}
{"question":"Get distinct quiz ids that appear in attempts.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT);","answer":"SELECT DISTINCT QuizId FROM QuizAttempts;"}
{"question":"Get distinct course ids that appear in reviews.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT);","answer":"SELECT DISTINCT CourseId FROM CourseReviews;"}
{"question":"Get distinct instructor accounts from mapping.","context":"CREATE TABLE CourseInstructors (Id INT, AccountId INT);","answer":"SELECT DISTINCT AccountId FROM CourseInstructors;"}
{"question":"Show courses with price greater than average price.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, Price DECIMAL);","answer":"SELECT * FROM Courses WHERE Price > (SELECT AVG(Price) FROM Courses);"}
{"question":"Show accounts with created date before this month.","context":"CREATE TABLE Accounts (AccountId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE DATEDIFF(MONTH, CreatedAt, SYSUTCDATETIME()) > 0;"}
{"question":"Show lessons created in the same week as today.","context":"CREATE TABLE Lessons (LessonId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons WHERE DATEPART(YEAR, CreatedAt)=DATEPART(YEAR, SYSUTCDATETIME()) AND DATEPART(WEEK, CreatedAt)=DATEPART(WEEK, SYSUTCDATETIME());"}
{"question":"Show attempts started before submitted time (sanity).","context":"CREATE TABLE QuizAttempts (AttemptId INT, StartedAt DATETIME2, SubmittedAt DATETIME2);","answer":"SELECT * FROM QuizAttempts WHERE StartedAt <= SubmittedAt;"}
{"question":"Show courses with category names for title containing Cloud.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT c.Title, g.Name FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId WHERE c.Title LIKE N'%Cloud%';"}
{"question":"Show courses and instructor names where published is true.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, IsPublished BIT, InstructorId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT c.Title, a.FullName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId WHERE c.IsPublished = 1;"}
{"question":"Show lessons and course titles where title contains Basics.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, Title NVARCHAR);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT l.Title, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE l.Title LIKE N'%Basics%';"}
{"question":"Show quizzes and lesson titles for lessons created this month.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR);\nCREATE TABLE Lessons (LessonId INT, Title NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT q.Title, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId WHERE YEAR(l.CreatedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(l.CreatedAt)=MONTH(SYSUTCDATETIME());"}
{"question":"Show questions and quiz titles where correct option equals 1.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, CorrectOption TINYINT, Question NVARCHAR);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT qq.Question, q.Title FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId WHERE qq.CorrectOption = 1;"}
{"question":"Show enrollments and student names created last 30 days.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, EnrolledOn DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, e.EnrolledOn FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId WHERE e.EnrolledOn >= DATEADD(DAY,-30,SYSUTCDATETIME());"}
{"question":"Show enrollments and course titles where progress between 40 and 80.","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT e.EnrollmentId, c.Title, e.ProgressPercent FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId WHERE e.ProgressPercent BETWEEN 40 AND 80;"}
{"question":"Show attempts and names submitted today with score at least 70.","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT, SubmittedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, qa.Score FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId WHERE qa.Score >= 70 AND CAST(qa.SubmittedAt AS DATE)=CAST(SYSUTCDATETIME() AS DATE);"}
{"question":"Show reviews and titles that include the word clear.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Comment NVARCHAR);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, r.Comment FROM CourseReviews r JOIN Courses c ON r.CourseId = c.CourseId WHERE r.Comment LIKE N'%clear%';"}
{"question":"Show mapping records with instructor names sorted by name.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, ci.CourseId FROM CourseInstructors ci JOIN Accounts a ON ci.AccountId = a.AccountId ORDER BY a.FullName;"}
{"question":"Show all accounts sorted by name.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts ORDER BY FullName ASC;"}
{"question":"Get account ids and names for active instructors.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Role NVARCHAR, IsActive BIT);","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role = N'Instructor' AND IsActive = 1;"}
{"question":"Export all categories with code and name.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT Code, Name FROM Categories;"}
{"question":"Display all courses with difficulty and price.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT);","answer":"SELECT Title, Difficulty, Price FROM Courses;"}
{"question":"Return all lessons ordered by course then ordering.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, Title NVARCHAR, Ordering INT);","answer":"SELECT * FROM Lessons ORDER BY CourseId, Ordering;"}
{"question":"Give me all quizzes ordered by title.","context":"CREATE TABLE Quizzes (QuizId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT * FROM Quizzes ORDER BY Title ASC;"}
{"question":"Fetch all quiz questions with their option count computed.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, OptionA NVARCHAR, OptionB NVARCHAR, OptionC NVARCHAR, OptionD NVARCHAR);","answer":"SELECT QuestionId, QuizId, 4 AS OptionCount FROM QuizQuestions;"}
{"question":"List all enrollments with completion flag.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT * FROM Enrollments;"}
{"question":"Show all quiz attempts with score and submitted time.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, Score INT, SubmittedAt DATETIME2);","answer":"SELECT AttemptId, QuizId, AccountId, Score, SubmittedAt FROM QuizAttempts;"}
{"question":"Get all course reviews with rating and created time.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, CreatedAt DATETIME2);","answer":"SELECT ReviewId, CourseId, AccountId, Rating, CreatedAt FROM CourseReviews;"}
{"question":"Export all course instructor mappings.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR);","answer":"SELECT * FROM CourseInstructors;"}
{"question":"Display accounts created this week.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT AccountId, FullName, CreatedAt FROM Accounts WHERE DATEDIFF(WEEK, CreatedAt, SYSUTCDATETIME()) = 0;"}
{"question":"Show courses created in the last 90 days.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE CreatedAt >= DATEADD(DAY,-90,SYSUTCDATETIME());"}
{"question":"Get lessons added this month ordered by newest.","context":"CREATE TABLE Lessons (LessonId INT, Title NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons WHERE YEAR(CreatedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(CreatedAt)=MONTH(SYSUTCDATETIME()) ORDER BY CreatedAt DESC;"}
{"question":"List quizzes with total questions greater than or equal to 5.","context":"CREATE TABLE Quizzes (QuizId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT Title, TotalQuestions FROM Quizzes WHERE TotalQuestions >= 5;"}
{"question":"Return quiz questions that contain the word SELECT.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR);","answer":"SELECT * FROM QuizQuestions WHERE Question LIKE N'%SELECT%';"}
{"question":"Show enrollments completed last month.","context":"CREATE TABLE Enrollments (EnrollmentId INT, CompletionDate DATETIME2, IsCompleted BIT);","answer":"SELECT * FROM Enrollments WHERE IsCompleted = 1 AND DATEDIFF(MONTH, CompletionDate, SYSUTCDATETIME()) = 1;"}
{"question":"Get attempts submitted in the current year.","context":"CREATE TABLE QuizAttempts (AttemptId INT, SubmittedAt DATETIME2);","answer":"SELECT * FROM QuizAttempts WHERE YEAR(SubmittedAt) = YEAR(SYSUTCDATETIME());"}
{"question":"Export reviews from the last 7 days with rating.","context":"CREATE TABLE CourseReviews (ReviewId INT, Rating INT, CreatedAt DATETIME2);","answer":"SELECT ReviewId, Rating, CreatedAt FROM CourseReviews WHERE CreatedAt >= DATEADD(DAY,-7,SYSUTCDATETIME());"}
{"question":"Display categories whose name starts with Data.","context":"CREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT * FROM Categories WHERE Name LIKE N'Data%';"}
{"question":"Get courses whose title contains API.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT * FROM Courses WHERE Title LIKE N'%API%';"}
{"question":"List lessons whose title ends with Basics.","context":"CREATE TABLE Lessons (LessonId INT, Title NVARCHAR);","answer":"SELECT * FROM Lessons WHERE Title LIKE N'%Basics';"}
{"question":"Show quizzes where title begins with Course Quiz.","context":"CREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT * FROM Quizzes WHERE Title LIKE N'Course Quiz%';"}
{"question":"Return enrollments where progress is at least 30 percent.","context":"CREATE TABLE Enrollments (EnrollmentId INT, ProgressPercent REAL);","answer":"SELECT * FROM Enrollments WHERE ProgressPercent >= 30;"}
{"question":"Get attempts with scores below 60.","context":"CREATE TABLE QuizAttempts (AttemptId INT, Score INT);","answer":"SELECT * FROM QuizAttempts WHERE Score < 60;"}
{"question":"Export reviews with comments that include useful.","context":"CREATE TABLE CourseReviews (ReviewId INT, Comment NVARCHAR);","answer":"SELECT * FROM CourseReviews WHERE Comment LIKE N'%useful%';"}
{"question":"List courses joined with category names.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT c.Title, g.Name AS CategoryName FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId;"}
{"question":"Show courses joined with instructor names.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, InstructorId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT c.Title, a.FullName AS InstructorName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId;"}
{"question":"Get lessons with their course titles (simple join).","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, Title NVARCHAR);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT l.Title AS LessonTitle, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId;"}
{"question":"Export quizzes with their lesson titles.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR);\nCREATE TABLE Lessons (LessonId INT, Title NVARCHAR);","answer":"SELECT q.Title AS QuizTitle, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId;"}
{"question":"Display quiz questions with quiz titles.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT qq.Question, q.Title AS QuizTitle FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId;"}
{"question":"List enrollments with student names.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT e.EnrollmentId, a.FullName FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId;"}
{"question":"Return enrollments with course titles.","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT e.EnrollmentId, c.Title FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId;"}
{"question":"Get attempts with quiz titles and scores.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, Score INT);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT qa.AttemptId, q.Title AS QuizTitle, qa.Score FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId;"}
{"question":"Show attempts with student names and scores.","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT qa.AttemptId, a.FullName, qa.Score FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId;"}
{"question":"Export reviews with course titles and ratings.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Rating INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, r.Rating FROM CourseReviews r JOIN Courses c ON r.CourseId = c.CourseId;"}
{"question":"Display mapping records with instructor names.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT ci.CourseId, a.FullName FROM CourseInstructors ci JOIN Accounts a ON ci.AccountId = a.AccountId;"}
{"question":"Show count of accounts by role.","context":"CREATE TABLE Accounts (AccountId INT, Role NVARCHAR);","answer":"SELECT Role, COUNT(*) AS Total FROM Accounts GROUP BY Role;"}
{"question":"Get average course price overall.","context":"CREATE TABLE Courses (CourseId INT, Price DECIMAL);","answer":"SELECT AVG(Price) AS AveragePrice FROM Courses;"}
{"question":"Export number of lessons per course.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, COUNT(l.LessonId) AS LessonCount FROM Courses c LEFT JOIN Lessons l ON c.CourseId = l.CourseId GROUP BY c.Title;"}
{"question":"List average progress per student.","context":"CREATE TABLE Enrollments (AccountId INT, ProgressPercent REAL);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, AVG(e.ProgressPercent) AS AvgProgress FROM Accounts a JOIN Enrollments e ON a.AccountId = e.AccountId GROUP BY a.FullName;"}
{"question":"Display average score per quiz.","context":"CREATE TABLE QuizAttempts (QuizId INT, Score INT);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, AVG(qa.Score) AS AvgScore FROM Quizzes q LEFT JOIN QuizAttempts qa ON q.QuizId = qa.QuizId GROUP BY q.Title;"}
{"question":"Return total questions per quiz title.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, COUNT(qq.QuestionId) AS QuestionCount FROM Quizzes q LEFT JOIN QuizQuestions qq ON q.QuizId = qq.QuizId GROUP BY q.Title;"}
{"question":"Show review counts by rating.","context":"CREATE TABLE CourseReviews (ReviewId INT, Rating INT);","answer":"SELECT Rating, COUNT(*) AS Total FROM CourseReviews GROUP BY Rating;"}
{"question":"Get top 3 courses by average rating.","context":"CREATE TABLE CourseReviews (CourseId INT, Rating INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT TOP (3) c.Title, AVG(r.Rating) AS AvgRating FROM Courses c JOIN CourseReviews r ON c.CourseId = r.CourseId GROUP BY c.Title ORDER BY AvgRating DESC;"}
{"question":"Export total attempts per student name.","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, COUNT(*) AS AttemptCount FROM Accounts a LEFT JOIN QuizAttempts qa ON a.AccountId = qa.AccountId GROUP BY a.FullName;"}
{"question":"List courses that have no lessons yet.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR);\nCREATE TABLE Lessons (LessonId INT, CourseId INT);","answer":"SELECT c.Title FROM Courses c LEFT JOIN Lessons l ON c.CourseId = l.CourseId WHERE l.LessonId IS NULL;"}
{"question":"Show cheapest two courses by price.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, Price DECIMAL);","answer":"SELECT TOP (2) * FROM Courses ORDER BY Price ASC;"}
{"question":"Get most expensive course title with price.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, Price DECIMAL);","answer":"SELECT TOP (1) Title, Price FROM Courses ORDER BY Price DESC;"}
{"question":"Display count of beginner courses.","context":"CREATE TABLE Courses (CourseId INT, Difficulty NVARCHAR);","answer":"SELECT COUNT(*) AS BeginnerCourses FROM Courses WHERE Difficulty = N'beginner';"}
{"question":"Return count of quiz lessons.","context":"CREATE TABLE Lessons (LessonId INT, LessonType NVARCHAR);","answer":"SELECT COUNT(*) AS QuizLessons FROM Lessons WHERE LessonType = N'quiz';"}
{"question":"Show min and max lesson ordering per course id.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, Ordering INT);","answer":"SELECT CourseId, MIN(Ordering) AS MinOrder, MAX(Ordering) AS MaxOrder FROM Lessons GROUP BY CourseId;"}
{"question":"Get newest lesson per course (created time).","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, MAX(l.CreatedAt) AS LatestLesson FROM Courses c LEFT JOIN Lessons l ON c.CourseId = l.CourseId GROUP BY c.Title;"}
{"question":"Export monthly enrollments in current year.","context":"CREATE TABLE Enrollments (EnrollmentId INT, EnrolledOn DATETIME2);","answer":"SELECT MONTH(EnrolledOn) AS MonthNum, COUNT(*) AS EnrollCount FROM Enrollments WHERE YEAR(EnrolledOn)=YEAR(SYSUTCDATETIME()) GROUP BY MONTH(EnrolledOn) ORDER BY MonthNum;"}
{"question":"List attempts today by account id.","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, SubmittedAt DATETIME2);","answer":"SELECT AccountId, COUNT(*) AS AttemptsToday FROM QuizAttempts WHERE CAST(SubmittedAt AS DATE)=CAST(SYSUTCDATETIME() AS DATE) GROUP BY AccountId;"}
{"question":"Display five star review ratio.","context":"CREATE TABLE CourseReviews (ReviewId INT, Rating INT);","answer":"SELECT CAST(COUNT(CASE WHEN Rating=5 THEN 1 END) AS DECIMAL(10,2)) / NULLIF(COUNT(*),0) AS FiveStarRatio FROM CourseReviews;"}
{"question":"Return courses with category names for advanced difficulty.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Difficulty NVARCHAR);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT c.Title, g.Name FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId WHERE c.Difficulty = N'advanced';"}
{"question":"Get courses with instructor names created last month.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT c.Title, a.FullName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId WHERE DATEDIFF(MONTH, c.CreatedAt, SYSUTCDATETIME()) = 1;"}
{"question":"Export video lessons with their course titles.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT l.Title, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE l.LessonType = N'video';"}
{"question":"Show quizzes joined with lesson titles sorted by quiz id.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR);\nCREATE TABLE Lessons (LessonId INT, Title NVARCHAR);","answer":"SELECT q.QuizId, q.Title, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId ORDER BY q.QuizId;"}
{"question":"Get questions with quiz titles where correct option equals 2.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, CorrectOption TINYINT, Question NVARCHAR);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT qq.Question, q.Title FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId WHERE qq.CorrectOption = 2;"}
{"question":"Display enrollments with student names for zero completion.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, e.EnrollmentId FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId WHERE e.IsCompleted = 0;"}
{"question":"List enrollments with course titles for progress between 20 and 60.","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT e.EnrollmentId, c.Title, e.ProgressPercent FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId WHERE e.ProgressPercent BETWEEN 20 AND 60;"}
{"question":"Return attempts with names submitted this month and score above 75.","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT, SubmittedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, qa.Score FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId WHERE YEAR(qa.SubmittedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(qa.SubmittedAt)=MONTH(SYSUTCDATETIME()) AND qa.Score > 75;"}
{"question":"Export reviews with titles where comment contains clear.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Comment NVARCHAR);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, r.Comment FROM CourseReviews r JOIN Courses c ON r.CourseId = c.CourseId WHERE r.Comment LIKE N'%clear%';"}
{"question":"Show mapping rows with instructor names not Lead role.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT ci.CourseId, a.FullName, ci.RoleInCourse FROM CourseInstructors ci JOIN Accounts a ON ci.AccountId = a.AccountId WHERE ci.RoleInCourse <> N'Lead';"}
{"question":"Get average rating and count per course title.","context":"CREATE TABLE CourseReviews (CourseId INT, Rating INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, AVG(r.Rating) AS AvgRating, COUNT(*) AS ReviewCount FROM Courses c LEFT JOIN CourseReviews r ON c.CourseId = r.CourseId GROUP BY c.Title;"}
{"question":"Display average score per quiz title for current month.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, Score INT, SubmittedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, AVG(qa.Score) AS AvgScore FROM Quizzes q JOIN QuizAttempts qa ON q.QuizId = qa.QuizId WHERE YEAR(qa.SubmittedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(qa.SubmittedAt)=MONTH(SYSUTCDATETIME()) GROUP BY q.Title;"}
{"question":"Return completed enrollment counts per course title.","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, COUNT(*) AS Completed FROM Courses c JOIN Enrollments e ON c.CourseId = e.CourseId WHERE e.IsCompleted = 1 GROUP BY c.Title;"}
{"question":"Export question counts per quiz for quizzes with at least one question.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, COUNT(qq.QuestionId) AS QuestionCount FROM Quizzes q JOIN QuizQuestions qq ON q.QuizId = qq.QuizId GROUP BY q.Title HAVING COUNT(qq.QuestionId) >= 1;"}
{"question":"Show attempts per student name in the last 30 days.","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, SubmittedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, COUNT(*) AS Attempts30d FROM Accounts a JOIN QuizAttempts qa ON a.AccountId = qa.AccountId WHERE qa.SubmittedAt >= DATEADD(DAY,-30,SYSUTCDATETIME()) GROUP BY a.FullName;"}
{"question":"Get top 5 courses by enrollment count.","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT TOP (5) c.Title, COUNT(e.EnrollmentId) AS EnrollCount FROM Courses c LEFT JOIN Enrollments e ON c.CourseId = e.CourseId GROUP BY c.Title ORDER BY EnrollCount DESC;"}
{"question":"Display courses whose price exceeds average price.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, Price DECIMAL);","answer":"SELECT Title, Price FROM Courses WHERE Price > (SELECT AVG(Price) FROM Courses);" }
{"question":"Export accounts created before this month.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT AccountId, FullName, CreatedAt FROM Accounts WHERE DATEDIFF(MONTH, CreatedAt, SYSUTCDATETIME()) > 0;"}
{"question":"List lessons created within the same week as today.","context":"CREATE TABLE Lessons (LessonId INT, Title NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT Title, CreatedAt FROM Lessons WHERE DATEPART(YEAR, CreatedAt)=DATEPART(YEAR, SYSUTCDATETIME()) AND DATEPART(WEEK, CreatedAt)=DATEPART(WEEK, SYSUTCDATETIME());"}
{"question":"Show attempts where started time is not after submitted time.","context":"CREATE TABLE QuizAttempts (AttemptId INT, StartedAt DATETIME2, SubmittedAt DATETIME2);","answer":"SELECT * FROM QuizAttempts WHERE StartedAt <= SubmittedAt;"}
{"question":"Get courses with category names for Cloud in title.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT c.Title, g.Name FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId WHERE c.Title LIKE N'%Cloud%';"}
{"question":"Export published courses with instructor names.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, IsPublished BIT, InstructorId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT c.Title, a.FullName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId WHERE c.IsPublished = 1;"}
{"question":"List lessons with course titles where title contains Basics.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, Title NVARCHAR);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT l.Title, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE l.Title LIKE N'%Basics%';"}
{"question":"Display quizzes with lesson titles for lessons created this month.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR);\nCREATE TABLE Lessons (LessonId INT, Title NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT q.Title, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId WHERE YEAR(l.CreatedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(l.CreatedAt)=MONTH(SYSUTCDATETIME());"}
{"question":"Return questions with quiz titles where correct option equals 3.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, CorrectOption TINYINT, Question NVARCHAR);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT qq.Question, q.Title FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId WHERE qq.CorrectOption = 3;"}
{"question":"Get enrollments with student names for current month.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, EnrolledOn DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, e.EnrolledOn FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId WHERE YEAR(e.EnrolledOn)=YEAR(SYSUTCDATETIME()) AND MONTH(e.EnrolledOn)=MONTH(SYSUTCDATETIME());"}
{"question":"Export enrollments with course titles not completed.","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT e.EnrollmentId, c.Title FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId WHERE e.IsCompleted = 0;"}
{"question":"Display attempts with quiz titles ordered by score then time.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, Score INT, SubmittedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, qa.Score, qa.SubmittedAt FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId ORDER BY qa.Score DESC, qa.SubmittedAt DESC;"}
{"question":"Return attempts with names where correctness is perfect.","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, qa.AttemptId FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId WHERE qa.CorrectAnswers = qa.TotalQuestions;"}
{"question":"Get reviews with titles where rating at least 4.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Rating INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, r.Rating FROM CourseReviews r JOIN Courses c ON r.CourseId = c.CourseId WHERE r.Rating >= 4;"}
{"question":"Export mapping rows with instructor names ordered by course id.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT ci.CourseId, a.FullName FROM CourseInstructors ci JOIN Accounts a ON ci.AccountId = a.AccountId ORDER BY ci.CourseId;"}
{"question":"Show count of beginner courses per category.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Difficulty NVARCHAR);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT g.Name, COUNT(*) AS BeginnerCount FROM Categories g JOIN Courses c ON g.CategoryId = c.CategoryId WHERE c.Difficulty = N'beginner' GROUP BY g.Name;"}
{"question":"Get average lesson ordering per course title.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, Ordering INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, AVG(CAST(l.Ordering AS DECIMAL(10,2))) AS AvgOrdering FROM Courses c JOIN Lessons l ON c.CourseId = l.CourseId GROUP BY c.Title;"}
{"question":"Return average attempt score per student name.","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, AVG(qa.Score) AS AvgScore FROM Accounts a JOIN QuizAttempts qa ON a.AccountId = qa.AccountId GROUP BY a.FullName;"}
{"question":"Display total attempts per quiz in the last 14 days.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, SubmittedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, COUNT(*) AS Attempts14d FROM Quizzes q JOIN QuizAttempts qa ON q.QuizId = qa.QuizId WHERE qa.SubmittedAt >= DATEADD(DAY,-14,SYSUTCDATETIME()) GROUP BY q.Title;"}
{"question":"Export review count per rating in this month.","context":"CREATE TABLE CourseReviews (ReviewId INT, Rating INT, CreatedAt DATETIME2);","answer":"SELECT Rating, COUNT(*) AS ReviewCount FROM CourseReviews WHERE YEAR(CreatedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(CreatedAt)=MONTH(SYSUTCDATETIME()) GROUP BY Rating;"}
{"question":"Show top 3 instructors by published course count.","context":"CREATE TABLE Courses (CourseId INT, InstructorId INT, IsPublished BIT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT TOP (3) a.FullName, COUNT(*) AS PublishedCount FROM Accounts a JOIN Courses c ON a.AccountId = c.InstructorId WHERE c.IsPublished = 1 GROUP BY a.FullName ORDER BY PublishedCount DESC;"}
{"question":"Get distinct instructor ids from mapping table.","context":"CREATE TABLE CourseInstructors (Id INT, AccountId INT);","answer":"SELECT DISTINCT AccountId FROM CourseInstructors;"}
{"question":"List student names only.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Role NVARCHAR);","answer":"SELECT FullName FROM Accounts WHERE Role = N'Student';"}
{"question":"Display course ids with category ids.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT);","answer":"SELECT CourseId, CategoryId FROM Courses;"}
{"question":"Return lesson ids with course ids.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT);","answer":"SELECT LessonId, CourseId FROM Lessons;"}
{"question":"Get quiz ids with lesson ids.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT);","answer":"SELECT QuizId, LessonId FROM Quizzes;"}
{"question":"Export question ids with quiz ids.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT);","answer":"SELECT QuestionId, QuizId FROM QuizQuestions;"}
{"question":"Show enrollment ids with account and course ids.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);","answer":"SELECT EnrollmentId, AccountId, CourseId FROM Enrollments;"}
{"question":"List attempt ids with quiz ids and scores.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, Score INT);","answer":"SELECT AttemptId, QuizId, Score FROM QuizAttempts;"}
{"question":"Return review ids with course ids and ratings.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Rating INT);","answer":"SELECT ReviewId, CourseId, Rating FROM CourseReviews;"}
{"question":"Display mapping ids with course and account ids.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT Id, CourseId, AccountId FROM CourseInstructors;"}
{"question":"Get courses and categories ordered by course title.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT c.Title, g.Name FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId ORDER BY c.Title ASC;"}
{"question":"Export courses and instructor names ordered by instructor.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, InstructorId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT c.Title, a.FullName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId ORDER BY a.FullName;"}
{"question":"Show lessons and course titles for quiz type.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT l.Title, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE l.LessonType = N'quiz';"}
{"question":"Get last five quizzes with lesson titles by id desc.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR);\nCREATE TABLE Lessons (LessonId INT, Title NVARCHAR);","answer":"SELECT TOP (5) q.Title, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId ORDER BY q.QuizId DESC;"}
{"question":"Display latest ten questions with their quiz titles.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT TOP (10) qq.Question, q.Title FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId ORDER BY qq.QuestionId DESC;"}
{"question":"List enrollments with student names for progress above 85.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, ProgressPercent REAL);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, e.ProgressPercent FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId WHERE e.ProgressPercent > 85;"}
{"question":"Return enrollments and course titles for under 100000 price.","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR, Price DECIMAL);","answer":"SELECT e.EnrollmentId, c.Title FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId WHERE c.Price < 100000;"}
{"question":"Export attempts with student names for perfect accuracy.","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, qa.AttemptId FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId WHERE qa.CorrectAnswers = qa.TotalQuestions;"}
{"question":"Show attempts with quiz titles for scores at least 80.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, Score INT, SubmittedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, qa.Score FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId WHERE qa.Score >= 80;"}
{"question":"Get reviews with titles where comment includes helpful.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Comment NVARCHAR);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, r.Comment FROM CourseReviews r JOIN Courses c ON r.CourseId = c.CourseId WHERE r.Comment LIKE N'%helpful%';"}
{"question":"Display mapping rows with instructor names sorted by name ascending.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, ci.CourseId FROM CourseInstructors ci JOIN Accounts a ON ci.AccountId = a.AccountId ORDER BY a.FullName ASC;"}
{"question":"Show all active accounts.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE IsActive = 1;"},
{"question":"List all instructors.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT AccountId, FullName, Email FROM Accounts WHERE Role = N'Instructor' AND IsActive = 1;"},
{"question":"Get all students.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT AccountId, FullName, Email FROM Accounts WHERE Role = N'Student';"},
{"question":"Display all course categories.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT * FROM Categories;"},
{"question":"Show all published courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE IsPublished = 1;"},
{"question":"List all free courses that are published.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Title, Price FROM Courses WHERE Price = 0 AND IsPublished = 1;"},
{"question":"Get all beginner level courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT CourseId, Title, Difficulty FROM Courses WHERE Difficulty = N'beginner';"},
{"question":"Find all lessons that are video lessons.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons WHERE LessonType = N'video';"},
{"question":"List all quizzes.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT QuizId, Title, TotalQuestions FROM Quizzes;"},
{"question":"Show all enrollments that are completed.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE IsCompleted = 1;"},
{"question":"Get all quiz attempts where the score is 100.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE Score = 100;"},
{"question":"Find all reviews with a 5-star rating.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE Rating = 5;"},
{"question":"List all admins.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT AccountId, FullName, Email FROM Accounts WHERE Role = N'Admin';"},
{"question":"Show all courses that are not yet published.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT CourseId, Title FROM Courses WHERE IsPublished = 0;"},
{"question":"Display all lessons that are quizzes.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT Title, LessonType FROM Lessons WHERE LessonType = N'quiz';"},
{"question":"Find all intermediate difficulty courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Title FROM Courses WHERE Difficulty = N'intermediate';"},
{"question":"List all advanced courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Title, Price FROM Courses WHERE Difficulty = N'advanced';"},
{"question":"Get all inactive users.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT FullName, Email FROM Accounts WHERE IsActive = 0;"},
{"question":"Show me all text lessons.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT CourseId, Title FROM Lessons WHERE LessonType = N'text';"},
{"question":"List all enrollments that are not finished yet.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE IsCompleted = 0;"},
{"question":"Get all quiz attempts that have been submitted.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE SubmittedAt IS NOT NULL;"},
{"question":"Find reviews that have comments.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE Comment IS NOT NULL;"},
{"question":"Show me all lead instructors in courses.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR(20));","answer":"SELECT * FROM CourseInstructors WHERE RoleInCourse = N'Lead';"},
{"question":"Get all courses that have a category assigned.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE CategoryId IS NOT NULL;"},
{"question":"List courses without a summary.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Title FROM Courses WHERE Summary IS NULL;"},
{"question":"Show quizzes with more than 10 questions.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT * FROM Quizzes WHERE TotalQuestions > 10;"},
{"question":"Display learners who are active.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT FullName, Email FROM Accounts WHERE Role = N'Student' AND IsActive = 1;"},
{"question":"Find reviews with 1-star rating.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT CourseId, Comment FROM CourseReviews WHERE Rating = 1;"},
{"question":"Get all quizzes with 5 questions or less.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT Title, TotalQuestions FROM Quizzes WHERE TotalQuestions <= 5;"},
{"question":"List quiz attempts with a score below 50.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE Score < 50;"},
{"question":"Show me enrollments where progress is over 50 percent.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE ProgressPercent > 0.5;"},
{"question":"Find all courses that are free.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Title FROM Courses WHERE Price = 0;"},
{"question":"Get all questions where option A is the correct answer.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);","answer":"SELECT Question FROM QuizQuestions WHERE CorrectOption = 1;"},
{"question":"List all categories with 'Programming' in the name.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT * FROM Categories WHERE Name LIKE N'%Programming%';"},
{"question":"Show courses with 'Python' in the title.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE Title LIKE N'%Python%';"},
{"question":"Get all teachers.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT FullName, Email FROM Accounts WHERE Role = N'Instructor';"},
{"question":"List all reviews.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews;"},
{"question":"Show all quiz attempts.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts;"},
{"question":"Find all enrollments.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments;"},
{"question":"List all lessons.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons;"},
{"question":"Display all courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses;"},
{"question":"Get all users.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts;"},
{"question":"Show me courses that cost more than 200.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Title, Price FROM Courses WHERE Price > 200;"},
{"question":"List quizzes with a title containing 'Final'.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT * FROM Quizzes WHERE Title LIKE N'%Final%';"},
{"question":"Find users who are not active.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT FullName, Email FROM Accounts WHERE IsActive = 0;"},
{"question":"Show enrollments with zero progress.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE ProgressPercent = 0;"},
{"question":"List all 3-star ratings.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT CourseId, Comment FROM CourseReviews WHERE Rating = 3;"},
{"question":"Get all paid courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Title, Price FROM Courses WHERE Price > 0;"},
{"question":"Show all quiz questions where D is correct.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);","answer":"SELECT Question FROM QuizQuestions WHERE CorrectOption = 4;"},
{"question":"Find courses with 'SQL' in the title.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT CourseId, Title FROM Courses WHERE Title LIKE N'%SQL%';"},
{"question":"List 10 most expensive courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT TOP 10 Title, Price FROM Courses ORDER BY Price DESC;"},
{"question":"Show me courses priced between 50 and 100.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Title, Price FROM Courses WHERE Price BETWEEN 50 AND 100;"},
{"question":"Get all users whose email ends with 'gmail.com'.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT FullName, Email FROM Accounts WHERE Email LIKE N'%@gmail.com';"},
{"question":"Find reviews that include the word 'helpful'.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE Comment LIKE N'%helpful%';"},
{"question":"List the 5 most recently created accounts.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT TOP 5 FullName, Email, CreatedAt FROM Accounts ORDER BY CreatedAt DESC;"},
{"question":"Show the 10 oldest published courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT TOP 10 Title, CreatedAt FROM Courses WHERE IsPublished = 1 ORDER BY CreatedAt ASC;"},
{"question":"Get quizzes that have 10 or 20 questions.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT * FROM Quizzes WHERE TotalQuestions IN (10, 20);"},
{"question":"Find courses that are not for beginners.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Title, Difficulty FROM Courses WHERE Difficulty != N'beginner' OR Difficulty IS NULL;"},
{"question":"List all courses that are not free.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Title, Price FROM Courses WHERE Price > 0;"},
{"question":"Show me the second page of courses, 10 per page.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses ORDER BY CourseId OFFSET 10 ROWS FETCH NEXT 10 ROWS ONLY;"},
{"question":"Get the top 3 highest rated reviews.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT TOP 3 CourseId, Rating, Comment FROM CourseReviews ORDER BY Rating DESC;"},
{"question":"Find lessons with 'Introduction' in the title.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons WHERE Title LIKE N'Introduction%';"},
{"question":"List accounts that do not have a 'gmail.com' email.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT FullName, Email FROM Accounts WHERE Email NOT LIKE N'%@gmail.com';"},
{"question":"Show me courses with a summary.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Title, Summary FROM Courses WHERE Summary IS NOT NULL;"},
{"question":"Get quiz attempts that were not submitted.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE SubmittedAt IS NULL;"},
{"question":"Find the 5 cheapest paid courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT TOP 5 Title, Price FROM Courses WHERE Price > 0 ORDER BY Price ASC;"},
{"question":"List all accounts created in 2024.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE YEAR(CreatedAt) = 2024;"},
{"question":"Show courses that are advanced or intermediate.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Title, Difficulty FROM Courses WHERE Difficulty IN (N'advanced', N'intermediate');"},
{"question":"Get the 10 most recent enrollments.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT TOP 10 * FROM Enrollments ORDER BY EnrolledOn DESC;"},
{"question":"Find quiz questions that contain the word 'what'.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);","answer":"SELECT Question FROM QuizQuestions WHERE Question LIKE N'%what%';"},
{"question":"List courses sorted by title alphabetically.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT CourseId, Title FROM Courses ORDER BY Title ASC;"},
{"question":"Show the first 5 students.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT TOP 5 FullName, Email FROM Accounts WHERE Role = N'Student' ORDER BY AccountId;"},
{"question":"Get enrollments that are 100 percent complete.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE ProgressPercent = 1;"},
{"question":"Find reviews with a rating of 4 or 5.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE Rating >= 4;"},
{"question":"List quizzes with 5 to 10 total questions.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT * FROM Quizzes WHERE TotalQuestions BETWEEN 5 AND 10;"},
{"question":"Show accounts whose names start with 'A'.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT FullName FROM Accounts WHERE FullName LIKE N'A%';"},
{"question":"Get the top 5 highest scores in quiz attempts.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT TOP 5 AccountId, QuizId, Score FROM QuizAttempts ORDER BY Score DESC;"},
{"question":"Find all reviews that have no comment.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE Comment IS NULL;"},
{"question":"List courses with 'Java' or 'C#' in the title.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Title FROM Courses WHERE Title LIKE N'%Java%' OR Title LIKE N'%C#%';"},
{"question":"Show the 10 most recent quiz attempts.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT TOP 10 * FROM QuizAttempts ORDER BY StartedAt DESC;"},
{"question":"Get the 5 oldest users.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT TOP 5 FullName, CreatedAt FROM Accounts ORDER BY CreatedAt ASC;"},
{"question":"Find all courses that are not published and are free.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE IsPublished = 0 AND Price = 0;"},
{"question":"List reviews that are 1 or 2 stars.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE Rating IN (1, 2);"},
{"question":"Show me the third page of active students, 5 per page.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE Role = N'Student' AND IsActive = 1 ORDER BY AccountId OFFSET 10 ROWS FETCH NEXT 5 ROWS ONLY;"},
{"question":"Get all lessons sorted by ordering number.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons ORDER BY Ordering ASC;"},
{"question":"Find courses with a price less than 20.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Title, Price FROM Courses WHERE Price < 20;"},
{"question":"List 5 recent reviews.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT TOP 5 * FROM CourseReviews ORDER BY CreatedAt DESC;"},
{"question":"Show quizzes with exactly 10 questions.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT * FROM Quizzes WHERE TotalQuestions = 10;"},
{"question":"Find enrollments with progress between 25 and 75 percent.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE ProgressPercent BETWEEN 0.25 AND 0.75;"},
{"question":"List course titles with their category names.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT c.Title, g.Name AS CategoryName FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId;"},
{"question":"Show all courses and their instructor's name.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT c.Title, a.FullName AS InstructorName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId;"},
{"question":"Get all lessons for courses titled 'SQL Basics'.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT l.Title, l.LessonType FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE c.Title = N'SQL Basics';"},
{"question":"List all quizzes and their corresponding lesson title.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT q.Title AS QuizTitle, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId;"},
{"question":"Show all questions for the quiz 'Module 1 Quiz'.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT qq.Question, qq.OptionA, qq.OptionB FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId WHERE q.Title = N'Module 1 Quiz';"},
{"question":"Get the names of students enrolled in the 'Data Science' course.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT a.FullName FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId JOIN Courses c ON e.CourseId = c.CourseId WHERE c.Title = N'Data Science' AND a.Role = N'Student';"},
{"question":"List all quiz attempts for the student 'John Doe'.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT qa.AttemptId, qa.QuizId, qa.Score FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId WHERE a.FullName = N'John Doe';"},
{"question":"Show all reviews for the course 'Advanced Python'.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT cr.Rating, cr.Comment FROM CourseReviews cr JOIN Courses c ON cr.CourseId = c.CourseId WHERE c.Title = N'Advanced Python';"},
{"question":"Find the names of students who left 5-star reviews.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT a.FullName, cr.Comment FROM CourseReviews cr JOIN Accounts a ON cr.AccountId = a.AccountId WHERE cr.Rating = 5;"},
{"question":"List all courses in the 'Web Development' category.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT c.Title, c.Price FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId WHERE g.Name = N'Web Development';"},
{"question":"Get all video lessons for 'Java Fundamentals' course.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT l.Title FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE c.Title = N'Java Fundamentals' AND l.LessonType = N'video';"},
{"question":"Show all quizzes for lessons in the 'Machine Learning' course.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT q.Title FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId JOIN Courses c ON l.CourseId = c.CourseId WHERE c.Title = N'Machine Learning';"},
{"question":"List all courses taught by 'Jane Smith'.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT c.Title, c.Difficulty FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId WHERE a.FullName = N'Jane Smith';"},
{"question":"Find all instructors for the 'Azure DevOps' course.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR(20));\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT a.FullName, ci.RoleInCourse FROM CourseInstructors ci JOIN Accounts a ON ci.AccountId = a.AccountId JOIN Courses c ON ci.CourseId = c.CourseId WHERE c.Title = N'Azure DevOps';"},
{"question":"Get all enrollments for students with 'student.com' email.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT e.* FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId WHERE a.Email LIKE N'%@student.com';"},
{"question":"Show the scores of 'Bob Johnson' on all quizzes.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT qa.QuizId, qa.Score FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId WHERE a.FullName = N'Bob Johnson';"},
{"question":"List comments and ratings for free courses.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT cr.Rating, cr.Comment FROM CourseReviews cr JOIN Courses c ON cr.CourseId = c.CourseId WHERE c.Price = 0;"},
{"question":"Find all learners enrolled in 'Beginner' courses.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT a.FullName FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId JOIN Accounts a ON e.AccountId = a.AccountId WHERE c.Difficulty = N'beginner';"},
{"question":"Get all lessons for courses in the 'Database' category.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT l.Title FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId JOIN Categories g ON c.CategoryId = g.CategoryId WHERE g.Name = N'Database';"},
{"question":"List instructors who teach advanced courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT DISTINCT a.FullName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId WHERE c.Difficulty = N'advanced';"},
{"question":"Show all lesson titles for the 'React Basics' course.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT l.Title, l.Ordering FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE c.Title = N'React Basics' ORDER BY l.Ordering;"},
{"question":"Get all quizzes for video lessons.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT q.Title FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId WHERE l.LessonType = N'video';"},
{"question":"Find the email of the instructor for 'CSS Grids'.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT a.Email FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId WHERE c.Title = N'CSS Grids';"},
{"question":"List all courses a student named 'Alice' is enrolled in.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT c.Title FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId JOIN Accounts a ON e.AccountId = a.AccountId WHERE a.FullName = N'Alice';"},
{"question":"Show quiz titles and scores for attempts by 'student@example.com'.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT q.Title, qa.Score FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId JOIN Accounts a ON qa.AccountId = a.AccountId WHERE a.Email = N'student@example.com';"},
{"question":"Get all 1-star reviews and the name of the reviewer.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT a.FullName, cr.Comment FROM CourseReviews cr JOIN Accounts a ON cr.AccountId = a.AccountId WHERE cr.Rating = 1;"},
{"question":"List all 'Lead' instructors and their courses.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR(20));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT a.FullName, c.Title FROM CourseInstructors ci JOIN Courses c ON ci.CourseId = c.CourseId JOIN Accounts a ON ci.AccountId = a.AccountId WHERE ci.RoleInCourse = N'Lead';"},
{"question":"Find all enrollments for courses that are not published.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT e.* FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId WHERE c.IsPublished = 0;"},
{"question":"Show the names of students who have completed courses.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT DISTINCT a.FullName FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId WHERE e.IsCompleted = 1;"},
{"question":"Get all courses that have at least one quiz lesson.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT DISTINCT c.Title FROM Courses c JOIN Lessons l ON c.CourseId = l.CourseId WHERE l.LessonType = N'quiz';"},
{"question":"List all quizzes associated with the 'Python' course.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT q.Title FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId JOIN Courses c ON l.CourseId = c.CourseId WHERE c.Title LIKE N'%Python%';"},
{"question":"Find the instructor name for all beginner courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT c.Title, a.FullName AS Instructor FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId WHERE c.Difficulty = N'beginner';"},
{"question":"Get all reviews for courses taught by 'Instructor One'.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT cr.Rating, cr.Comment FROM CourseReviews cr JOIN Courses c ON cr.CourseId = c.CourseId JOIN Accounts a ON c.InstructorId = a.AccountId WHERE a.FullName = N'Instructor One';"},
{"question":"Show all accounts with basic fields.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR, Role NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts;"}
{"question":"Get account ids and names for student role.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Role NVARCHAR);","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role = N'Student';"}
{"question":"Export active accounts created this month.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT AccountId, FullName, CreatedAt FROM Accounts WHERE IsActive = 1 AND YEAR(CreatedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(CreatedAt)=MONTH(SYSUTCDATETIME());"}
{"question":"List account emails from example.org domain.","context":"CREATE TABLE Accounts (AccountId INT, Email NVARCHAR);","answer":"SELECT Email FROM Accounts WHERE Email LIKE N'%@example.org';"}
{"question":"Display the newest 10 accounts by created time.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT TOP (10) * FROM Accounts ORDER BY CreatedAt DESC;"}
{"question":"Return distinct roles available in accounts.","context":"CREATE TABLE Accounts (AccountId INT, Role NVARCHAR);","answer":"SELECT DISTINCT Role FROM Accounts;"}
{"question":"Give me inactive accounts sorted by name.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, IsActive BIT);","answer":"SELECT AccountId, FullName FROM Accounts WHERE IsActive = 0 ORDER BY FullName ASC;"}
{"question":"Fetch accounts whose name begins with Anh.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT * FROM Accounts WHERE FullName LIKE N'Anh%';"}
{"question":"Show accounts created yesterday (UTC).","context":"CREATE TABLE Accounts (AccountId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE CAST(CreatedAt AS DATE)=CAST(DATEADD(DAY,-1,SYSUTCDATETIME()) AS DATE);"}
{"question":"Get accounts ordered by role then name.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Role NVARCHAR);","answer":"SELECT * FROM Accounts ORDER BY Role, FullName;"}
{"question":"List all categories ordered by name.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT * FROM Categories ORDER BY Name ASC;"}
{"question":"Display category codes starting with CAT.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR);","answer":"SELECT * FROM Categories WHERE Code LIKE N'CAT%';"}
{"question":"Get category names that contain Data.","context":"CREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT * FROM Categories WHERE Name LIKE N'%Data%';"}
{"question":"Export categories without description.","context":"CREATE TABLE Categories (CategoryId INT, Name NVARCHAR, Description NVARCHAR);","answer":"SELECT CategoryId, Name FROM Categories WHERE Description IS NULL;"}
{"question":"Return the first 5 categories by id ascending.","context":"CREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT TOP (5) * FROM Categories ORDER BY CategoryId ASC;"}
{"question":"Show all courses simple list.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, Difficulty NVARCHAR, Price DECIMAL, IsPublished BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses;"}
{"question":"Get course titles and prices only.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, Price DECIMAL);","answer":"SELECT Title, Price FROM Courses;"}
{"question":"Export published beginner courses.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, Difficulty NVARCHAR, IsPublished BIT);","answer":"SELECT Title, Difficulty FROM Courses WHERE IsPublished = 1 AND Difficulty = N'beginner';"}
{"question":"List courses priced between 80000 and 200000.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, Price DECIMAL);","answer":"SELECT * FROM Courses WHERE Price BETWEEN 80000 AND 200000;"}
{"question":"Display courses created in the last 30 days.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE CreatedAt >= DATEADD(DAY,-30,SYSUTCDATETIME());"}
{"question":"Return courses whose title ends with 101.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT * FROM Courses WHERE Title LIKE N'%101';"}
{"question":"Give me courses not published yet.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, IsPublished BIT);","answer":"SELECT * FROM Courses WHERE IsPublished = 0;"}
{"question":"Fetch top 3 most expensive courses with price.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, Price DECIMAL);","answer":"SELECT TOP (3) Title, Price FROM Courses ORDER BY Price DESC;"}
{"question":"Show courses ordered by title then price descending.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, Price DECIMAL);","answer":"SELECT * FROM Courses ORDER BY Title ASC, Price DESC;"}
{"question":"List lessons simple table view.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR, Ordering INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons;"}
{"question":"Display lesson ids with their ordering number.","context":"CREATE TABLE Lessons (LessonId INT, Ordering INT);","answer":"SELECT LessonId, Ordering FROM Lessons;"}
{"question":"Get lessons where type is text.","context":"CREATE TABLE Lessons (LessonId INT, LessonType NVARCHAR, Title NVARCHAR);","answer":"SELECT * FROM Lessons WHERE LessonType = N'text';"}
{"question":"Export lessons created today ordered by time.","context":"CREATE TABLE Lessons (LessonId INT, Title NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons WHERE CAST(CreatedAt AS DATE)=CAST(SYSUTCDATETIME() AS DATE) ORDER BY CreatedAt DESC;"}
{"question":"Return lessons whose title contains Quiz.","context":"CREATE TABLE Lessons (LessonId INT, Title NVARCHAR);","answer":"SELECT * FROM Lessons WHERE Title LIKE N'%Quiz%';"}
{"question":"Show top 5 newest lessons for review.","context":"CREATE TABLE Lessons (LessonId INT, Title NVARCHAR, CreatedAt DATETIME2);","answer":"SELECT TOP (5) * FROM Lessons ORDER BY CreatedAt DESC;"}
{"question":"Get all quizzes with their total questions.","context":"CREATE TABLE Quizzes (QuizId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT * FROM Quizzes;"}
{"question":"Export quizzes with at least 4 questions.","context":"CREATE TABLE Quizzes (QuizId INT, Title NVARCHAR, TotalQuestions INT);","answer":"SELECT Title, TotalQuestions FROM Quizzes WHERE TotalQuestions >= 4;"}
{"question":"List quizzes ordered by title ascending.","context":"CREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT * FROM Quizzes ORDER BY Title ASC;"}
{"question":"Display quizzes where title contains Final.","context":"CREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT * FROM Quizzes WHERE Title LIKE N'%Final%';"}
{"question":"Return the latest 3 quizzes by id.","context":"CREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT TOP (3) * FROM Quizzes ORDER BY QuizId DESC;"}
{"question":"Show all quiz questions with quiz id.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR, CorrectOption TINYINT);","answer":"SELECT QuestionId, QuizId, Question, CorrectOption FROM QuizQuestions;"}
{"question":"Get quiz questions that mention JOIN.","context":"CREATE TABLE QuizQuestions (QuestionId INT, Question NVARCHAR);","answer":"SELECT * FROM QuizQuestions WHERE Question LIKE N'%JOIN%';"}
{"question":"Export question ids where correct option equals 4.","context":"CREATE TABLE QuizQuestions (QuestionId INT, CorrectOption TINYINT);","answer":"SELECT QuestionId FROM QuizQuestions WHERE CorrectOption = 4;"}
{"question":"List questions ordered by question id descending.","context":"CREATE TABLE QuizQuestions (QuestionId INT, Question NVARCHAR);","answer":"SELECT * FROM QuizQuestions ORDER BY QuestionId DESC;"}
{"question":"Display questions that contain the word SELECT.","context":"CREATE TABLE QuizQuestions (QuestionId INT, Question NVARCHAR);","answer":"SELECT * FROM QuizQuestions WHERE Question LIKE N'%SELECT%';"}
{"question":"Return all enrollments basic list.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments;"}
{"question":"Show enrollments not completed yet.","context":"CREATE TABLE Enrollments (EnrollmentId INT, IsCompleted BIT);","answer":"SELECT * FROM Enrollments WHERE IsCompleted = 0;"}
{"question":"Get enrollments with progress at least 60 percent.","context":"CREATE TABLE Enrollments (EnrollmentId INT, ProgressPercent REAL);","answer":"SELECT * FROM Enrollments WHERE ProgressPercent >= 60;"}
{"question":"Export enrollments created this month.","context":"CREATE TABLE Enrollments (EnrollmentId INT, EnrolledOn DATETIME2);","answer":"SELECT * FROM Enrollments WHERE YEAR(EnrolledOn)=YEAR(SYSUTCDATETIME()) AND MONTH(EnrolledOn)=MONTH(SYSUTCDATETIME());"}
{"question":"List enrollments completed last 7 days.","context":"CREATE TABLE Enrollments (EnrollmentId INT, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE IsCompleted = 1 AND CompletionDate >= DATEADD(DAY,-7,SYSUTCDATETIME());"}
{"question":"Display all quiz attempts simple list.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, Score INT, SubmittedAt DATETIME2);","answer":"SELECT * FROM QuizAttempts;"}
{"question":"Return attempts with score greater than 85.","context":"CREATE TABLE QuizAttempts (AttemptId INT, Score INT);","answer":"SELECT * FROM QuizAttempts WHERE Score > 85;"}
{"question":"Show attempts submitted today sorted by time.","context":"CREATE TABLE QuizAttempts (AttemptId INT, SubmittedAt DATETIME2);","answer":"SELECT * FROM QuizAttempts WHERE CAST(SubmittedAt AS DATE)=CAST(SYSUTCDATETIME() AS DATE) ORDER BY SubmittedAt DESC;"}
{"question":"Get attempts where correct equals total.","context":"CREATE TABLE QuizAttempts (AttemptId INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE CorrectAnswers = TotalQuestions;"}
{"question":"Export last 10 attempts by submitted time.","context":"CREATE TABLE QuizAttempts (AttemptId INT, SubmittedAt DATETIME2, Score INT);","answer":"SELECT TOP (10) * FROM QuizAttempts ORDER BY SubmittedAt DESC;"}
{"question":"List all course reviews with rating only.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Rating INT, CreatedAt DATETIME2);","answer":"SELECT ReviewId, CourseId, Rating, CreatedAt FROM CourseReviews;"}
{"question":"Display reviews with rating at least 4.","context":"CREATE TABLE CourseReviews (ReviewId INT, Rating INT);","answer":"SELECT * FROM CourseReviews WHERE Rating >= 4;"}
{"question":"Get reviews created within the last 14 days.","context":"CREATE TABLE CourseReviews (ReviewId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE CreatedAt >= DATEADD(DAY,-14,SYSUTCDATETIME());"}
{"question":"Export reviews where comment contains clear.","context":"CREATE TABLE CourseReviews (ReviewId INT, Comment NVARCHAR);","answer":"SELECT * FROM CourseReviews WHERE Comment LIKE N'%clear%';"}
{"question":"Return five star reviews ordered by created time.","context":"CREATE TABLE CourseReviews (ReviewId INT, Rating INT, CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE Rating = 5 ORDER BY CreatedAt DESC;"}
{"question":"Show course titles with category names.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT c.Title, g.Name AS CategoryName FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId;"}
{"question":"Get courses with instructor names.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, InstructorId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT c.Title, a.FullName AS InstructorName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId;"}
{"question":"Export lessons with course titles.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, Title NVARCHAR);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT l.Title AS LessonTitle, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId;"}
{"question":"List quizzes with lesson titles.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR);\nCREATE TABLE Lessons (LessonId INT, Title NVARCHAR);","answer":"SELECT q.Title AS QuizTitle, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId;"}
{"question":"Display quiz questions with quiz titles.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT qq.Question, q.Title AS QuizTitle FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId;"}
{"question":"Return enrollments with student names.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT e.EnrollmentId, a.FullName FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId;"}
{"question":"Show enrollments with course titles.","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT e.EnrollmentId, c.Title FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId;"}
{"question":"Get attempts with quiz titles and scores.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, Score INT);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT qa.AttemptId, q.Title AS QuizTitle, qa.Score FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId;"}
{"question":"Export attempts with student names and scores.","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT qa.AttemptId, a.FullName, qa.Score FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId;"}
{"question":"List reviews with course titles and ratings.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Rating INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, r.Rating FROM CourseReviews r JOIN Courses c ON r.CourseId = c.CourseId;"}
{"question":"Display course instructor mappings with names.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT ci.CourseId, a.FullName FROM CourseInstructors ci JOIN Accounts a ON ci.AccountId = a.AccountId;"}
{"question":"Show count of accounts per role.","context":"CREATE TABLE Accounts (AccountId INT, Role NVARCHAR);","answer":"SELECT Role, COUNT(*) AS Total FROM Accounts GROUP BY Role;"}
{"question":"Get average course price by difficulty.","context":"CREATE TABLE Courses (CourseId INT, Difficulty NVARCHAR, Price DECIMAL);","answer":"SELECT Difficulty, AVG(Price) AS AvgPrice FROM Courses GROUP BY Difficulty;"}
{"question":"Export lesson counts per course title.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR);\nCREATE TABLE Lessons (LessonId INT, CourseId INT);","answer":"SELECT c.Title, COUNT(l.LessonId) AS LessonCount FROM Courses c LEFT JOIN Lessons l ON c.CourseId = l.CourseId GROUP BY c.Title;"}
{"question":"List average progress per course title.","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, AVG(e.ProgressPercent) AS AvgProgress FROM Courses c JOIN Enrollments e ON c.CourseId = e.CourseId GROUP BY c.Title;"}
{"question":"Display average score per quiz title.","context":"CREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, Score INT);","answer":"SELECT q.Title, AVG(qa.Score) AS AvgScore FROM Quizzes q LEFT JOIN QuizAttempts qa ON q.QuizId = qa.QuizId GROUP BY q.Title;"}
{"question":"Return question counts per quiz title.","context":"CREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);\nCREATE TABLE QuizQuestions (QuestionId INT, QuizId INT);","answer":"SELECT q.Title, COUNT(qq.QuestionId) AS QuestionCount FROM Quizzes q LEFT JOIN QuizQuestions qq ON q.QuizId = qq.QuizId GROUP BY q.Title;"}
{"question":"Show reviews count by rating value.","context":"CREATE TABLE CourseReviews (ReviewId INT, Rating INT);","answer":"SELECT Rating, COUNT(*) AS ReviewCount FROM CourseReviews GROUP BY Rating;"}
{"question":"Get top 5 courses by average rating.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Rating INT);","answer":"SELECT TOP (5) c.Title, AVG(r.Rating) AS AvgRating FROM Courses c JOIN CourseReviews r ON c.CourseId = r.CourseId GROUP BY c.Title ORDER BY AvgRating DESC;"}
{"question":"Export total attempts per student name.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(*) AS AttemptCount FROM Accounts a LEFT JOIN QuizAttempts qa ON a.AccountId = qa.AccountId GROUP BY a.FullName;"}
{"question":"List courses with category names for price under 120000.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Price DECIMAL);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT c.Title, g.Name FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId WHERE c.Price < 120000;"}
{"question":"Display courses with instructor names created this month.","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT c.Title, a.FullName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId WHERE YEAR(c.CreatedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(c.CreatedAt)=MONTH(SYSUTCDATETIME());"}
{"question":"Return video lessons with course titles.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT l.Title, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE l.LessonType = N'video';"}
{"question":"Show quizzes with lesson titles ordered by lesson title.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR);\nCREATE TABLE Lessons (LessonId INT, Title NVARCHAR);","answer":"SELECT q.Title, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId ORDER BY l.Title;"}
{"question":"Get questions with quiz titles where question contains WHERE.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT qq.Question, q.Title FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId WHERE qq.Question LIKE N'%WHERE%';"}
{"question":"How many students are there?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(AccountId) FROM Accounts WHERE Role = N'Student';"},
{"question":"Calculate the total number of courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(CourseId) FROM Courses;"},
{"question":"What is the average price of all courses?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(Price) FROM Courses;"},
{"question":"How many courses per category?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT g.Name, COUNT(c.CourseId) AS CourseCount FROM Categories g LEFT JOIN Courses c ON g.CategoryId = c.CategoryId GROUP BY g.Name;"},
{"question":"Count the number of lessons for each course.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT c.Title, COUNT(l.LessonId) AS TotalLessons FROM Courses c LEFT JOIN Lessons l ON c.CourseId = l.CourseId GROUP BY c.Title;"},
{"question":"What is the total number of enrollments?","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(EnrollmentId) FROM Enrollments;"},
{"question":"Find the average rating for each course.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT c.Title, AVG(CAST(cr.Rating AS FLOAT)) AS AverageRating FROM Courses c LEFT JOIN CourseReviews cr ON c.CourseId = cr.CourseId GROUP BY c.Title;"},
{"question":"How many courses has each instructor created?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT a.FullName, COUNT(c.CourseId) AS TotalCourses FROM Accounts a LEFT JOIN Courses c ON a.AccountId = c.InstructorId WHERE a.Role = N'Instructor' GROUP BY a.FullName;"},
{"question":"Get the maximum price for a course.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT MAX(Price) FROM Courses;"},
{"question":"What is the minimum price for an advanced course?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT MIN(Price) FROM Courses WHERE Difficulty = N'advanced';"},
{"question":"Calculate the total number of lessons.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(LessonId) FROM Lessons;"},
{"question":"How many quizzes are there in total?","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT COUNT(QuizId) FROM Quizzes;"},
{"question":"Find the total number of quiz questions.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);","answer":"SELECT COUNT(QuestionId) FROM QuizQuestions;"},
{"question":"What is the average number of questions per quiz?","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT AVG(CAST(TotalQuestions AS FLOAT)) FROM Quizzes;"},
{"question":"How many reviews has each student written?","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT a.FullName, COUNT(cr.ReviewId) AS ReviewCount FROM Accounts a LEFT JOIN CourseReviews cr ON a.AccountId = cr.AccountId WHERE a.Role = N'Student' GROUP BY a.FullName;"},
{"question":"Count enrollments for each student.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS EnrollmentCount FROM Accounts a LEFT JOIN Enrollments e ON a.AccountId = e.AccountId WHERE a.Role = N'Student' GROUP BY a.FullName;"},
{"question":"Get the total number of quiz attempts.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(AttemptId) FROM QuizAttempts;"},
{"question":"What is the average score across all quiz attempts?","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CAST(Score AS FLOAT)) FROM QuizAttempts WHERE Score IS NOT NULL;"},
{"question":"Find the average score for each quiz.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT q.Title, AVG(CAST(qa.Score AS FLOAT)) AS AverageScore FROM Quizzes q LEFT JOIN QuizAttempts qa ON q.QuizId = qa.QuizId GROUP BY q.Title;"},
{"question":"How many quiz attempts per student?","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT a.FullName, COUNT(qa.AttemptId) AS AttemptCount FROM Accounts a LEFT JOIN QuizAttempts qa ON a.AccountId = qa.AccountId WHERE a.Role = N'Student' GROUP BY a.FullName;"},
{"question":"List all courses and their category name.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT c.Title, cat.Name AS CategoryName FROM Courses c LEFT JOIN Categories cat ON c.CategoryId = cat.CategoryId;"},
{"question":"Show all course titles and their instructor's full name.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT c.Title, a.FullName AS InstructorName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId;"},
{"question":"List all lessons with their course title.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT c.Title AS CourseTitle, l.Title AS LessonTitle, l.LessonType FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId;"},
{"question":"Get all quizzes and their lesson title.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT l.Title AS LessonTitle, q.Title AS QuizTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId;"},
{"question":"List all quiz questions with their quiz title.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT q.Title AS QuizTitle, qq.Question FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId;"},
{"question":"Show all enrollments with student name and course title.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT a.FullName AS StudentName, c.Title AS CourseTitle, e.EnrolledOn, e.ProgressPercent FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId JOIN Courses c ON e.CourseId = c.CourseId;"},
{"question":"List all quiz attempts with student name and quiz title.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT a.FullName AS StudentName, q.Title AS QuizTitle, qa.Score, qa.SubmittedAt FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId JOIN Quizzes q ON qa.QuizId = q.QuizId;"},
{"question":"Get all course reviews with the course title and student name.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT c.Title AS CourseTitle, a.FullName AS StudentName, cr.Rating, cr.Comment FROM CourseReviews cr JOIN Courses c ON cr.CourseId = c.CourseId JOIN Accounts a ON cr.AccountId = a.AccountId;"},
{"question":"How many instructors are also listed as course instructors?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR(20));","answer":"SELECT COUNT(DISTINCT a.AccountId) FROM Accounts a JOIN CourseInstructors ci ON a.AccountId = ci.AccountId WHERE a.Role = N'Instructor';"},
{"question":"Total number of courses in the 'Programming' category.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT COUNT(c.CourseId) FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId WHERE g.Name = N'Programming';"},
{"question":"Total revenue from all enrollments.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT SUM(c.Price) AS TotalRevenue FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId;"},
{"question":"What is the total price of all 'beginner' courses?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT SUM(Price) FROM Courses WHERE Difficulty = N'beginner';"},
{"question":"How many lessons are of type 'video'?","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(LessonId) FROM Lessons WHERE LessonType = N'video';"},
{"question":"How many lessons are of type 'quiz'?","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(LessonId) FROM Lessons WHERE LessonType = N'quiz';"},
{"question":"Count of all active instructors.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(AccountId) FROM Accounts WHERE Role = N'Instructor' AND IsActive = 1;"},
{"question":"Total number of accounts created today.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(AccountId) FROM Accounts WHERE CAST(CreatedAt AS DATE) = CAST(SYSUTCDATETIME() AS DATE);"},
{"question":"How many courses were published this month?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(CourseId) FROM Courses WHERE IsPublished = 1 AND MONTH(CreatedAt) = MONTH(SYSUTCDATETIME()) AND YEAR(CreatedAt) = YEAR(SYSUTCDATETIME());"},
{"question":"Total enrollments in the last 7 days.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(EnrollmentId) FROM Enrollments WHERE EnrolledOn >= DATEADD(day, -7, SYSUTCDATETIME());"},
{"question":"How many 1-star reviews are there?","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT COUNT(ReviewId) FROM CourseReviews WHERE Rating = 1;"},
{"question":"Count of 5-star reviews.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT COUNT(ReviewId) FROM CourseReviews WHERE Rating = 5;"},
{"question":"Total number of completed enrollments.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(EnrollmentId) FROM Enrollments WHERE IsCompleted = 1;"},
{"question":"Average progress percent for all enrollments.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT AVG(ProgressPercent) FROM Enrollments;"},
{"question":"How many quizzes have more than 5 questions?","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT COUNT(QuizId) FROM Quizzes WHERE TotalQuestions > 5;"},
{"question":"Get the total number of questions for quizzes titled 'Final Exam'.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);","answer":"SELECT SUM(q.TotalQuestions) FROM Quizzes q WHERE q.Title = N'Final Exam';"},
{"question":"Sum of correct answers for all attempts.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT SUM(CorrectAnswers) FROM QuizAttempts WHERE CorrectAnswers IS NOT NULL;"},
{"question":"Show course title and count of lessons for each course.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT c.Title, COUNT(l.LessonId) AS LessonCount FROM Courses c LEFT JOIN Lessons l ON c.CourseId = l.CourseId GROUP BY c.Title;"},
{"question":"Display category name and the count of courses in it.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT cat.Name, COUNT(c.CourseId) AS NumberOfCourses FROM Categories cat LEFT JOIN Courses c ON cat.CategoryId = c.CategoryId GROUP BY cat.Name;"},
{"question":"Show instructor name and the total number of courses they teach.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT a.FullName, COUNT(c.CourseId) AS CourseCount FROM Accounts a LEFT JOIN Courses c ON a.AccountId = c.InstructorId WHERE a.Role = N'Instructor' GROUP BY a.FullName;"},
{"question":"List course title and the number of students enrolled.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT c.Title, COUNT(e.EnrollmentId) AS EnrollmentCount FROM Courses c LEFT JOIN Enrollments e ON c.CourseId = e.CourseId GROUP BY c.Title;"},
{"question":"Display course title and its average rating.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT c.Title, AVG(CAST(cr.Rating AS FLOAT)) AS AverageRating FROM Courses c LEFT JOIN CourseReviews cr ON c.CourseId = cr.CourseId GROUP BY c.Title;"},
{"question":"Show quiz title and the number of attempts for it.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT q.Title, COUNT(qa.AttemptId) AS AttemptCount FROM Quizzes q LEFT JOIN QuizAttempts qa ON q.QuizId = qa.QuizId GROUP BY q.Title;"},
{"question":"List student name and their average quiz score.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AverageScore FROM Accounts a LEFT JOIN QuizAttempts qa ON a.AccountId = qa.AccountId WHERE a.Role = N'Student' GROUP BY a.FullName;"},
{"question":"Show student name and the total number of courses they completed.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS CompletedCourses FROM Accounts a LEFT JOIN Enrollments e ON a.AccountId = e.AccountId WHERE a.Role = N'Student' AND e.IsCompleted = 1 GROUP BY a.FullName;"},
{"question":"Get the count of video lessons for each course.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT c.Title, COUNT(l.LessonId) AS VideoLessonCount FROM Courses c LEFT JOIN Lessons l ON c.CourseId = l.CourseId WHERE l.LessonType = N'video' GROUP BY c.Title;"},
{"question":"Find the total number of questions for each quiz.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);","answer":"SELECT q.Title, COUNT(qq.QuestionId) AS QuestionCount FROM Quizzes q LEFT JOIN QuizQuestions qq ON q.QuizId = qq.QuizId GROUP BY q.Title;"},
{"question":"Get the highest score for each quiz.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT q.Title, MAX(qa.Score) AS HighestScore FROM Quizzes q LEFT JOIN QuizAttempts qa ON q.QuizId = qa.QuizId GROUP BY q.Title;"},
{"question":"List instructor name and the average rating of their courses.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT a.FullName, AVG(CAST(cr.Rating AS FLOAT)) AS AverageRating FROM Accounts a JOIN Courses c ON a.AccountId = c.InstructorId LEFT JOIN CourseReviews cr ON c.CourseId = cr.CourseId WHERE a.Role = N'Instructor' GROUP BY a.FullName;"},
{"question":"How many enrollments per course title?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT c.Title, COUNT(e.EnrollmentId) AS TotalEnrollments FROM Courses c LEFT JOIN Enrollments e ON c.CourseId = e.CourseId GROUP BY c.Title;"},
{"question":"What is the total sum of prices for all published courses?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT SUM(Price) FROM Courses WHERE IsPublished = 1;"},
{"question":"How many accounts are inactive?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(AccountId) FROM Accounts WHERE IsActive = 0;"},
{"question":"Count of courses that are free.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(CourseId) FROM Courses WHERE Price = 0;"},
{"question":"How many categories are there?","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT COUNT(CategoryId) FROM Categories;"},
{"question":"Total number of reviews submitted.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT COUNT(ReviewId) FROM CourseReviews;"},
{"question":"Average rating of all reviews.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(Rating AS FLOAT)) FROM CourseReviews;"},
{"question":"How many 'Lead' roles are in CourseInstructors?","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR(20));","answer":"SELECT COUNT(Id) FROM CourseInstructors WHERE RoleInCourse = N'Lead';"},
{"question":"What is the total number of questions where B is correct?","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);","answer":"SELECT COUNT(QuestionId) FROM QuizQuestions WHERE CorrectOption = 2;"},
{"question":"Count of quiz attempts with no score.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(AttemptId) FROM QuizAttempts WHERE Score IS NULL;"},
{"question":"How many enrollments have 0 progress?","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(EnrollmentId) FROM Enrollments WHERE ProgressPercent = 0;"},
{"question":"Get the count of all courses that are not published.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(CourseId) FROM Courses WHERE IsPublished = 0;"},
{"question":"How many students are inactive?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(AccountId) FROM Accounts WHERE Role = N'Student' AND IsActive = 0;"},
{"question":"Count of courses with 'Introduction' in the title.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(CourseId) FROM Courses WHERE Title LIKE N'%Introduction%';"},
{"question":"How many lessons are there in total for all courses?","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(LessonId) FROM Lessons;"},
{"question":"Total number of text lessons.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(LessonId) FROM Lessons WHERE LessonType = N'text';"},
{"question":"How many courses have no category?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(CourseId) FROM Courses WHERE CategoryId IS NULL;"},
{"question":"Get the total sum of questions from all quizzes.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT SUM(TotalQuestions) FROM Quizzes;"},
{"question":"Count of reviews with comments.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT COUNT(ReviewId) FROM CourseReviews WHERE Comment IS NOT NULL;"},
{"question":"How many quizzes have 10 or more questions?","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT COUNT(QuizId) FROM Quizzes WHERE TotalQuestions >= 10;"},
{"question":"What is the total number of admins?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(AccountId) FROM Accounts WHERE Role = N'Admin';"},
{"question":"Get the count of courses priced over 100.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(CourseId) FROM Courses WHERE Price > 100;"},
{"question":"How many enrollments were made in the current year?","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(EnrollmentId) FROM Enrollments WHERE YEAR(EnrolledOn) = YEAR(SYSUTCDATETIME());"},
{"question":"Show course title and the total number of reviews it has.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT c.Title, COUNT(cr.ReviewId) AS ReviewCount FROM Courses c LEFT JOIN CourseReviews cr ON c.CourseId = cr.CourseId GROUP BY c.Title;"},
{"question":"List lesson title and the quiz title associated with it.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT l.Title AS LessonTitle, q.Title AS QuizTitle FROM Lessons l LEFT JOIN Quizzes q ON l.LessonId = q.LessonId WHERE l.LessonType = N'quiz';"},
{"question":"Show student name and the number of reviews they posted.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT a.FullName, COUNT(cr.ReviewId) AS TotalReviews FROM Accounts a LEFT JOIN CourseReviews cr ON a.AccountId = cr.AccountId WHERE a.Role = N'Student' GROUP BY a.FullName;"},
{"question":"Get the count of lessons for each lesson type.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT LessonType, COUNT(LessonId) AS LessonCount FROM Lessons GROUP BY LessonType;"},
{"question":"Find the average progress for enrollments per course.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT c.Title, AVG(e.ProgressPercent) AS AverageProgress FROM Courses c LEFT JOIN Enrollments e ON c.CourseId = e.CourseId GROUP BY c.Title;"},
{"question":"How many courses are there for each difficulty level?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Difficulty, COUNT(CourseId) AS CourseCount FROM Courses GROUP BY Difficulty;"},
{"question":"List the total number of enrollments for each month of the current year.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT MONTH(EnrolledOn) AS EnrollmentMonth, COUNT(EnrollmentId) AS TotalEnrollments FROM Enrollments WHERE YEAR(EnrolledOn) = YEAR(SYSUTCDATETIME()) GROUP BY MONTH(EnrolledOn) ORDER BY EnrollmentMonth;"},
{"question":"Get the sum of prices for courses per category.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT g.Name, SUM(c.Price) AS TotalPrice FROM Categories g LEFT JOIN Courses c ON g.CategoryId = c.CategoryId GROUP BY g.Name;"},
{"question":"Show the highest score achieved by each student.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT a.FullName, MAX(qa.Score) AS HighestScore FROM Accounts a LEFT JOIN QuizAttempts qa ON a.AccountId = qa.AccountId WHERE a.Role = N'Student' GROUP BY a.FullName;"},
{"question":"List total enrollments per difficulty level.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT c.Difficulty, COUNT(e.EnrollmentId) AS TotalEnrollments FROM Courses c LEFT JOIN Enrollments e ON c.CourseId = e.CourseId GROUP BY c.Difficulty;"},
{"question":"Find the minimum score for each quiz.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT q.Title, MIN(qa.Score) AS LowestScore FROM Quizzes q LEFT JOIN QuizAttempts qa ON q.QuizId = qa.QuizId GROUP BY q.Title;"},
{"question":"Show the total number of correct answers per quiz.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT q.Title, SUM(qa.CorrectAnswers) AS TotalCorrect FROM Quizzes q LEFT JOIN QuizAttempts qa ON q.QuizId = qa.QuizId GROUP BY q.Title;"},
{"question":"Count how many courses each student is enrolled in.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT a.FullName, COUNT(e.CourseId) AS EnrolledCourses FROM Accounts a LEFT JOIN Enrollments e ON a.AccountId = e.AccountId WHERE a.Role = N'Student' GROUP BY a.FullName;"},
{"question":"List courses and the count of 5-star reviews for each.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT c.Title, COUNT(cr.ReviewId) AS FiveStarReviews FROM Courses c LEFT JOIN CourseReviews cr ON c.CourseId = cr.CourseId WHERE cr.Rating = 5 GROUP BY c.Title;"},
{"question":"Show the average rating for each instructor's courses.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT a.FullName, AVG(CAST(cr.Rating AS FLOAT)) AS AverageCourseRating FROM Accounts a JOIN Courses c ON a.AccountId = c.InstructorId LEFT JOIN CourseReviews cr ON c.CourseId = cr.CourseId WHERE a.Role = N'Instructor' GROUP BY a.FullName;"},
{"question":"How many video lessons does each instructor have?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT a.FullName, COUNT(l.LessonId) AS VideoLessons FROM Accounts a JOIN Courses c ON a.AccountId = c.InstructorId JOIN Lessons l ON c.CourseId = l.CourseId WHERE a.Role = N'Instructor' AND l.LessonType = N'video' GROUP BY a.FullName;"},
{"question":"Find the total number of students taught by each instructor.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT a.FullName, COUNT(DISTINCT e.AccountId) AS TotalStudents FROM Accounts a JOIN Courses c ON a.AccountId = c.InstructorId LEFT JOIN Enrollments e ON c.CourseId = e.CourseId WHERE a.Role = N'Instructor' GROUP BY a.FullName;"},
{"question":"Get the total price of courses for each category.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT g.Name, SUM(c.Price) AS TotalValue FROM Categories g LEFT JOIN Courses c ON g.CategoryId = c.CategoryId GROUP BY g.Name;"},
{"question":"List quizzes and the average score for each.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT q.Title, AVG(CAST(qa.Score AS FLOAT)) AS AverageScore FROM Quizzes q LEFT JOIN QuizAttempts qa ON q.QuizId = qa.QuizId GROUP BY q.Title;"},
{"question":"Show total enrollments for courses that are free.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(e.EnrollmentId) AS FreeCourseEnrollments FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId WHERE c.Price = 0;"}
{"question":"Show all accounts.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts;"},
{"question":"List all categories.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT * FROM Categories;"},
{"question":"Get all courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses;"},
{"question":"Display all quizzes.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT * FROM Quizzes;"},
{"question":"List all quiz questions.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);","answer":"SELECT * FROM QuizQuestions;"},
{"question":"Show all enrollments.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments;"},
{"question":"Get all quiz attempts.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts;"},
{"question":"List all course reviews.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews;"},
{"question":"Show all course instructors.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR(20));","answer":"SELECT * FROM CourseInstructors;"},
{"question":"Show all courses and their category name.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT Courses.*, Categories.Name FROM Courses LEFT JOIN Categories ON Courses.CategoryId = Categories.CategoryId;"},
{"question":"List all courses and the instructor's full name.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT Courses.*, Accounts.FullName FROM Courses JOIN Accounts ON Courses.InstructorId = Accounts.AccountId;"},
{"question":"Get all lessons and their course title.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Lessons.*, Courses.Title FROM Lessons JOIN Courses ON Lessons.CourseId = Courses.CourseId;"},
{"question":"Show all quizzes and their lesson title.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT Quizzes.*, Lessons.Title FROM Quizzes JOIN Lessons ON Quizzes.LessonId = Lessons.LessonId;"},
{"question":"List all quiz questions and their quiz title.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT QuizQuestions.*, Quizzes.Title FROM QuizQuestions JOIN Quizzes ON QuizQuestions.QuizId = Quizzes.QuizId;"},
{"question":"Show all enrollments and the student's name.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT Enrollments.*, Accounts.FullName FROM Enrollments JOIN Accounts ON Enrollments.AccountId = Accounts.AccountId;"},
{"question":"Display all enrollments and the course title.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Enrollments.*, Courses.Title FROM Enrollments JOIN Courses ON Enrollments.CourseId = Courses.CourseId;"},
{"question":"Get all quiz attempts and the student's email.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT QuizAttempts.*, Accounts.Email FROM QuizAttempts JOIN Accounts ON QuizAttempts.AccountId = Accounts.AccountId;"},
{"question":"List all quiz attempts and the quiz title.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT QuizAttempts.*, Quizzes.Title FROM QuizAttempts JOIN Quizzes ON QuizAttempts.QuizId = Quizzes.QuizId;"},
{"question":"Show all reviews with the course title.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT CourseReviews.*, Courses.Title FROM CourseReviews JOIN Courses ON CourseReviews.CourseId = Courses.CourseId;"},
{"question":"Get all reviews and the reviewer's name.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT CourseReviews.*, Accounts.FullName FROM CourseReviews JOIN Accounts ON CourseReviews.AccountId = Accounts.AccountId;"},
{"question":"Show all course instructors and their course title.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR(20));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT CourseInstructors.*, Courses.Title FROM CourseInstructors JOIN Courses ON CourseInstructors.CourseId = Courses.CourseId;"},
{"question":"List all course instructors and their account email.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR(20));\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT CourseInstructors.*, Accounts.Email FROM CourseInstructors JOIN Accounts ON CourseInstructors.AccountId = Accounts.AccountId;"},
{"question":"How many lessons are in each course?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT Courses.Title, COUNT(Lessons.LessonId) FROM Courses LEFT JOIN Lessons ON Courses.CourseId = Lessons.CourseId GROUP BY Courses.Title;"},
{"question":"Count the number of quizzes for each lesson.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT Lessons.Title, COUNT(Quizzes.QuizId) FROM Lessons LEFT JOIN Quizzes ON Lessons.LessonId = Quizzes.LessonId GROUP BY Lessons.Title;"},
{"question":"How many questions does each quiz have?","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);","answer":"SELECT Quizzes.Title, COUNT(QuizQuestions.QuestionId) FROM Quizzes LEFT JOIN QuizQuestions ON Quizzes.QuizId = QuizQuestions.QuizId GROUP BY Quizzes.Title;"},
{"question":"Count enrollments for each course.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT Courses.Title, COUNT(Enrollments.EnrollmentId) FROM Courses LEFT JOIN Enrollments ON Courses.CourseId = Enrollments.CourseId GROUP BY Courses.Title;"},
{"question":"How many courses is each student enrolled in?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT Accounts.FullName, COUNT(Enrollments.CourseId) FROM Accounts LEFT JOIN Enrollments ON Accounts.AccountId = Enrollments.AccountId WHERE Accounts.Role = N'Student' GROUP BY Accounts.FullName;"},
{"question":"Count the quiz attempts for each quiz.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Quizzes.Title, COUNT(QuizAttempts.AttemptId) FROM Quizzes LEFT JOIN QuizAttempts ON Quizzes.QuizId = QuizAttempts.QuizId GROUP BY Quizzes.Title;"},
{"question":"How many quiz attempts has each student made?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Accounts.FullName, COUNT(QuizAttempts.AttemptId) FROM Accounts LEFT JOIN QuizAttempts ON Accounts.AccountId = QuizAttempts.AccountId WHERE Accounts.Role = N'Student' GROUP BY Accounts.FullName;"},
{"question":"Count the number of reviews for each course.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT Courses.Title, COUNT(CourseReviews.ReviewId) FROM Courses LEFT JOIN CourseReviews ON Courses.CourseId = CourseReviews.CourseId GROUP BY Courses.Title;"},
{"question":"How many reviews has each student written?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT Accounts.FullName, COUNT(CourseReviews.ReviewId) FROM Accounts LEFT JOIN CourseReviews ON Accounts.AccountId = CourseReviews.AccountId WHERE Accounts.Role = N'Student' GROUP BY Accounts.FullName;"},
{"question":"Count the number of courses in each category.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Categories.Name, COUNT(Courses.CourseId) FROM Categories LEFT JOIN Courses ON Categories.CategoryId = Courses.CategoryId GROUP BY Categories.Name;"},
{"question":"How many courses does each instructor teach?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Accounts.FullName, COUNT(Courses.CourseId) FROM Accounts LEFT JOIN Courses ON Accounts.AccountId = Courses.InstructorId WHERE Accounts.Role = N'Instructor' GROUP BY Accounts.FullName;"},
{"question":"Count the number of instructors assigned to each course.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR(20));","answer":"SELECT Courses.Title, COUNT(CourseInstructors.AccountId) FROM Courses LEFT JOIN CourseInstructors ON Courses.CourseId = CourseInstructors.CourseId GROUP BY Courses.Title;"},
{"question":"How many courses is each instructor assigned to?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR(20));","answer":"SELECT Accounts.FullName, COUNT(CourseInstructors.CourseId) FROM Accounts LEFT JOIN CourseInstructors ON Accounts.AccountId = CourseInstructors.AccountId WHERE Accounts.Role = N'Instructor' GROUP BY Accounts.FullName;"},
{"question":"What is the average rating for each course?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT Courses.Title, AVG(CourseReviews.Rating) FROM Courses LEFT JOIN CourseReviews ON Courses.CourseId = CourseReviews.CourseId GROUP BY Courses.Title;"},
{"question":"What is the average rating given by each student?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT Accounts.FullName, AVG(CourseReviews.Rating) FROM Accounts LEFT JOIN CourseReviews ON Accounts.AccountId = CourseReviews.AccountId WHERE Accounts.Role = N'Student' GROUP BY Accounts.FullName;"},
{"question":"Calculate the average score for each quiz.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Quizzes.Title, AVG(QuizAttempts.Score) FROM Quizzes LEFT JOIN QuizAttempts ON Quizzes.QuizId = QuizAttempts.QuizId GROUP BY Quizzes.Title;"},
{"question":"Find the average score for each student.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Accounts.FullName, AVG(QuizAttempts.Score) FROM Accounts LEFT JOIN QuizAttempts ON Accounts.AccountId = QuizAttempts.AccountId WHERE Accounts.Role = N'Student' GROUP BY Accounts.FullName;"},
{"question":"Get the average progress for each course.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT Courses.Title, AVG(Enrollments.ProgressPercent) FROM Courses LEFT JOIN Enrollments ON Courses.CourseId = Enrollments.CourseId GROUP BY Courses.Title;"},
{"question":"Calculate the average progress for each student.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT Accounts.FullName, AVG(Enrollments.ProgressPercent) FROM Accounts LEFT JOIN Enrollments ON Accounts.AccountId = Enrollments.AccountId WHERE Accounts.Role = N'Student' GROUP BY Accounts.FullName;"},
{"question":"Get the total price of courses in each category.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Categories.Name, SUM(Courses.Price) FROM Categories LEFT JOIN Courses ON Categories.CategoryId = Courses.CategoryId GROUP BY Categories.Name;"},
{"question":"Find the total price of courses created by each instructor.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Accounts.FullName, SUM(Courses.Price) FROM Accounts LEFT JOIN Courses ON Accounts.AccountId = Courses.InstructorId WHERE Accounts.Role = N'Instructor' GROUP BY Accounts.FullName;"},
{"question":"Calculate the total correct answers for each student.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Accounts.FullName, SUM(QuizAttempts.CorrectAnswers) FROM Accounts LEFT JOIN QuizAttempts ON Accounts.AccountId = QuizAttempts.AccountId WHERE Accounts.Role = N'Student' GROUP BY Accounts.FullName;"},
{"question":"Sum the total questions for each quiz.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Quizzes.Title, SUM(QuizAttempts.TotalQuestions) FROM Quizzes LEFT JOIN QuizAttempts ON Quizzes.QuizId = QuizAttempts.QuizId GROUP BY Quizzes.Title;"},
{"question":"How many video lessons are in each course?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT Courses.Title, COUNT(Lessons.LessonId) FROM Courses LEFT JOIN Lessons ON Courses.CourseId = Lessons.CourseId WHERE Lessons.LessonType = N'video' GROUP BY Courses.Title;"},
{"question":"How many text lessons are in each course?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT Courses.Title, COUNT(Lessons.LessonId) FROM Courses LEFT JOIN Lessons ON Courses.CourseId = Lessons.CourseId WHERE Lessons.LessonType = N'text' GROUP BY Courses.Title;"},
{"question":"Count of quiz lessons per course.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT Courses.Title, COUNT(Lessons.LessonId) FROM Courses LEFT JOIN Lessons ON Courses.CourseId = Lessons.CourseId WHERE Lessons.LessonType = N'quiz' GROUP BY Courses.Title;"},
{"question":"How many beginner courses are in each category?","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Categories.Name, COUNT(Courses.CourseId) FROM Categories LEFT JOIN Courses ON Categories.CategoryId = Courses.CategoryId WHERE Courses.Difficulty = N'beginner' GROUP BY Categories.Name;"},
{"question":"Count of intermediate courses per category.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Categories.Name, COUNT(Courses.CourseId) FROM Categories LEFT JOIN Courses ON Categories.CategoryId = Courses.CategoryId WHERE Courses.Difficulty = N'intermediate' GROUP BY Categories.Name;"},
{"question":"How many advanced courses does each instructor teach?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Accounts.FullName, COUNT(Courses.CourseId) FROM Accounts LEFT JOIN Courses ON Accounts.AccountId = Courses.InstructorId WHERE Accounts.Role = N'Instructor' AND Courses.Difficulty = N'advanced' GROUP BY Accounts.FullName;"},
{"question":"Count of free courses per instructor.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Accounts.FullName, COUNT(Courses.CourseId) FROM Accounts LEFT JOIN Courses ON Accounts.AccountId = Courses.InstructorId WHERE Accounts.Role = N'Instructor' AND Courses.Price = 0 GROUP BY Accounts.FullName;"},
{"question":"How many published courses does each instructor have?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Accounts.FullName, COUNT(Courses.CourseId) FROM Accounts LEFT JOIN Courses ON Accounts.AccountId = Courses.InstructorId WHERE Accounts.Role = N'Instructor' AND Courses.IsPublished = 1 GROUP BY Accounts.FullName;"},
{"question":"Count of unpublished courses for each category.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Categories.Name, COUNT(Courses.CourseId) FROM Categories LEFT JOIN Courses ON Categories.CategoryId = Courses.CategoryId WHERE Courses.IsPublished = 0 GROUP BY Categories.Name;"},
{"question":"How many completed enrollments per course?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT Courses.Title, COUNT(Enrollments.EnrollmentId) FROM Courses LEFT JOIN Enrollments ON Courses.CourseId = Enrollments.CourseId WHERE Enrollments.IsCompleted = 1 GROUP BY Courses.Title;"},
{"question":"Count of incomplete enrollments for each student.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT Accounts.FullName, COUNT(Enrollments.EnrollmentId) FROM Accounts LEFT JOIN Enrollments ON Accounts.AccountId = Enrollments.AccountId WHERE Accounts.Role = N'Student' AND Enrollments.IsCompleted = 0 GROUP BY Accounts.FullName;"},
{"question":"How many 5-star reviews for each course?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT Courses.Title, COUNT(CourseReviews.ReviewId) FROM Courses LEFT JOIN CourseReviews ON Courses.CourseId = CourseReviews.CourseId WHERE CourseReviews.Rating = 5 GROUP BY Courses.Title;"},
{"question":"Count of 1-star reviews for each instructor's courses.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT Accounts.FullName, COUNT(CourseReviews.ReviewId) FROM Accounts JOIN Courses ON Accounts.AccountId = Courses.InstructorId LEFT JOIN CourseReviews ON Courses.CourseId = CourseReviews.CourseId WHERE Accounts.Role = N'Instructor' AND CourseReviews.Rating = 1 GROUP BY Accounts.FullName;"},
{"question":"How many attempts with a score over 80 for each quiz?","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Quizzes.Title, COUNT(QuizAttempts.AttemptId) FROM Quizzes LEFT JOIN QuizAttempts ON Quizzes.QuizId = QuizAttempts.QuizId WHERE QuizAttempts.Score > 80 GROUP BY Quizzes.Title;"},
{"question":"Count of attempts with a score below 50 for each student.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Accounts.FullName, COUNT(QuizAttempts.AttemptId) FROM Accounts LEFT JOIN QuizAttempts ON Accounts.AccountId = QuizAttempts.AccountId WHERE Accounts.Role = N'Student' AND QuizAttempts.Score < 50 GROUP BY Accounts.FullName;"},
{"question":"What is the average score for 'beginner' courses' quizzes?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(QuizAttempts.Score) FROM QuizAttempts JOIN Quizzes ON QuizAttempts.QuizId = Quizzes.QuizId JOIN Lessons ON Quizzes.LessonId = Lessons.LessonId JOIN Courses ON Lessons.CourseId = Courses.CourseId WHERE Courses.Difficulty = N'beginner';"},
{"question":"Get the average rating for 'Web Development' category courses.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CourseReviews.Rating) FROM CourseReviews JOIN Courses ON CourseReviews.CourseId = Courses.CourseId JOIN Categories ON Courses.CategoryId = Categories.CategoryId WHERE Categories.Name = N'Web Development';"},
{"question":"Calculate the total number of students enrolled in free courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(DISTINCT Enrollments.AccountId) FROM Enrollments JOIN Courses ON Enrollments.CourseId = Courses.CourseId WHERE Courses.Price = 0;"},
{"question":"Sum of prices for all 'advanced' courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT SUM(Courses.Price) FROM Courses WHERE Courses.Difficulty = N'advanced';"},
{"question":"What is the total number of lessons for 'intermediate' courses?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(Lessons.LessonId) FROM Lessons JOIN Courses ON Lessons.CourseId = Courses.CourseId WHERE Courses.Difficulty = N'intermediate';"},
{"question":"How many active students are enrolled in 'SQL' courses?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(DISTINCT Enrollments.AccountId) FROM Enrollments JOIN Accounts ON Enrollments.AccountId = Accounts.AccountId JOIN Courses ON Enrollments.CourseId = Courses.CourseId WHERE Accounts.Role = N'Student' AND Accounts.IsActive = 1 AND Courses.Title LIKE N'%SQL%';"},
{"question":"Get the count of 'Lead' instructors.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR(20));","answer":"SELECT COUNT(DISTINCT AccountId) FROM CourseInstructors WHERE RoleInCourse = N'Lead';"},
{"question":"How many courses have at least one 5-star review?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT COUNT(DISTINCT Courses.CourseId) FROM Courses JOIN CourseReviews ON Courses.CourseId = CourseReviews.CourseId WHERE CourseReviews.Rating = 5;"},
{"question":"Count of students who have completed at least one course.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(DISTINCT Accounts.AccountId) FROM Accounts JOIN Enrollments ON Accounts.AccountId = Enrollments.AccountId WHERE Accounts.Role = N'Student' AND Enrollments.IsCompleted = 1;"},
{"question":"How many quizzes have at least one attempt with a perfect score?","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(DISTINCT Quizzes.QuizId) FROM Quizzes JOIN QuizAttempts ON Quizzes.QuizId = QuizAttempts.QuizId WHERE QuizAttempts.Score = 100;"},
{"question":"Get the total number of video lessons.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(LessonId) FROM Lessons WHERE LessonType = N'video';"},
{"question":"Find the total number of quiz attempts submitted today.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(AttemptId) FROM QuizAttempts WHERE SubmittedAt IS NOT NULL AND CAST(SubmittedAt AS DATE) = CAST(SYSUTCDATETIME() AS DATE);"},
{"question":"How many reviews were written this month?","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT COUNT(ReviewId) FROM CourseReviews WHERE MONTH(CreatedAt) = MONTH(SYSUTCDATETIME()) AND YEAR(CreatedAt) = YEAR(SYSUTCDATETIME());"},
{"question":"Count of enrollments in the last 30 days.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(EnrollmentId) FROM Enrollments WHERE EnrolledOn >= DATEADD(day, -30, SYSUTCDATETIME());"},
{"question":"How many new accounts were created this year?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(AccountId) FROM Accounts WHERE YEAR(CreatedAt) = YEAR(SYSUTCDATETIME());"},
{"question":"Get the number of courses published this week.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(CourseId) FROM Courses WHERE IsPublished = 1 AND CreatedAt >= DATEADD(day, -7, SYSUTCDATETIME());"},
{"question":"Count of lessons created today.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(LessonId) FROM Lessons WHERE CAST(CreatedAt AS DATE) = CAST(SYSUTCDATETIME() AS DATE);"},
{"question":"How many quiz questions were added this month?","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(qq.QuestionId) FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId JOIN Lessons l ON q.LessonId = l.LessonId WHERE MONTH(l.CreatedAt) = MONTH(SYSUTCDATETIME()) AND YEAR(l.CreatedAt) = YEAR(SYSUTCDATETIME());"},
{"question":"Total number of accounts that are instructors.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(AccountId) FROM Accounts WHERE Role = N'Instructor';"},
{"question":"Get the count of all active students.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(AccountId) FROM Accounts WHERE Role = N'Student' AND IsActive = 1;"},
{"question":"How many lessons are associated with quizzes?","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT COUNT(DISTINCT Lessons.LessonId) FROM Lessons JOIN Quizzes ON Lessons.LessonId = Quizzes.LessonId;"},
{"question":"Count of students who have never taken a quiz.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(Accounts.AccountId) FROM Accounts LEFT JOIN QuizAttempts ON Accounts.AccountId = QuizAttempts.AccountId WHERE Accounts.Role = N'Student' AND QuizAttempts.AttemptId IS NULL;"},
{"question":"How many courses have no enrollments?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(Courses.CourseId) FROM Courses LEFT JOIN Enrollments ON Courses.CourseId = Enrollments.CourseId WHERE Enrollments.EnrollmentId IS NULL;"},
{"question":"Count of courses that have no lessons.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(Courses.CourseId) FROM Courses LEFT JOIN Lessons ON Courses.CourseId = Lessons.CourseId WHERE Lessons.LessonId IS NULL;"},
{"question":"How many quizzes have no questions?","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);","answer":"SELECT COUNT(Quizzes.QuizId) FROM Quizzes LEFT JOIN QuizQuestions ON Quizzes.QuizId = QuizQuestions.QuizId WHERE QuizQuestions.QuestionId IS NULL;"},
{"question":"Count of courses with no reviews.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT COUNT(Courses.CourseId) FROM Courses LEFT JOIN CourseReviews ON Courses.CourseId = CourseReviews.CourseId WHERE CourseReviews.ReviewId IS NULL;"},
{"question":"How many students have not completed any course?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(DISTINCT Accounts.AccountId) FROM Accounts LEFT JOIN Enrollments ON Accounts.AccountId = Enrollments.AccountId AND Enrollments.IsCompleted = 1 WHERE Accounts.Role = N'Student' AND Enrollments.EnrollmentId IS NULL;"},
{"question":"Get the number of enrollments for each lesson type.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT Lessons.LessonType, COUNT(Enrollments.EnrollmentId) FROM Lessons JOIN Courses ON Lessons.CourseId = Courses.CourseId LEFT JOIN Enrollments ON Courses.CourseId = Enrollments.CourseId GROUP BY Lessons.LessonType;"},
{"question":"What is the average price for courses in the 'Database' category?","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(Courses.Price) FROM Courses JOIN Categories ON Courses.CategoryId = Categories.CategoryId WHERE Categories.Name = N'Database';"},
{"question":"Total number of enrollments by active students.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(Enrollments.EnrollmentId) FROM Enrollments JOIN Accounts ON Enrollments.AccountId = Accounts.AccountId WHERE Accounts.IsActive = 1 AND Accounts.Role = N'Student';"},
{"question":"How many 'Lead' instructors teach 'beginner' courses?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR(20));","answer":"SELECT COUNT(DISTINCT CourseInstructors.AccountId) FROM CourseInstructors JOIN Courses ON CourseInstructors.CourseId = Courses.CourseId WHERE CourseInstructors.RoleInCourse = N'Lead' AND Courses.Difficulty = N'beginner';"},
{"question":"Get the sum of all questions from all quizzes in 'intermediate' courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT SUM(Quizzes.TotalQuestions) FROM Quizzes JOIN Lessons ON Quizzes.LessonId = Lessons.LessonId JOIN Courses ON Lessons.CourseId = Courses.CourseId WHERE Courses.Difficulty = N'intermediate';"},
{"question":"How many reviews with comments are there for free courses?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT COUNT(CourseReviews.ReviewId) FROM CourseReviews JOIN Courses ON CourseReviews.CourseId = Courses.CourseId WHERE Courses.Price = 0 AND CourseReviews.Comment IS NOT NULL;"},
{"question":"Get the total number of quiz attempts for lessons of type 'video'.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(QuizAttempts.AttemptId) FROM QuizAttempts JOIN Quizzes ON QuizAttempts.QuizId = Quizzes.QuizId JOIN Lessons ON Quizzes.LessonId = Lessons.LessonId WHERE Lessons.LessonType = N'video';"},
{"question":"Show all students and their enrollment date.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT Accounts.FullName, Enrollments.EnrolledOn FROM Accounts JOIN Enrollments ON Accounts.AccountId = Enrollments.AccountId WHERE Accounts.Role = N'Student';"},
{"question":"List all instructors and their course titles.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Accounts.FullName, Courses.Title FROM Accounts JOIN Courses ON Accounts.AccountId = Courses.InstructorId WHERE Accounts.Role = N'Instructor';"},
{"question":"Get all quizzes and their lesson type.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT Quizzes.Title, Lessons.LessonType FROM Quizzes JOIN Lessons ON Quizzes.LessonId = Lessons.LessonId;"},
{"question":"List all reviews and the course price.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT CourseReviews.Rating, CourseReviews.Comment, Courses.Price FROM CourseReviews JOIN Courses ON CourseReviews.CourseId = Courses.CourseId;"},
{"question":"Show all enrollments and the course difficulty.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Enrollments.*, Courses.Difficulty FROM Enrollments JOIN Courses ON Enrollments.CourseId = Courses.CourseId;"},
{"question":"Get all quiz attempts and the total questions for that quiz.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT QuizAttempts.*, Quizzes.TotalQuestions FROM QuizAttempts JOIN Quizzes ON QuizAttempts.QuizId = Quizzes.QuizId;"},
{"question":"List all lessons and their category name.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT Lessons.Title, Categories.Name FROM Lessons JOIN Courses ON Lessons.CourseId = Courses.CourseId LEFT JOIN Categories ON Courses.CategoryId = Categories.CategoryId;"},
{"question":"Show all quiz questions and the lesson type they belong to.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT QuizQuestions.Question, Lessons.LessonType FROM QuizQuestions JOIN Quizzes ON QuizQuestions.QuizId = Quizzes.QuizId JOIN Lessons ON Quizzes.LessonId = Lessons.LessonId;"},
{"question":"Get all reviews for beginner courses.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT CourseReviews.* FROM CourseReviews JOIN Courses ON CourseReviews.CourseId = Courses.CourseId WHERE Courses.Difficulty = N'beginner';"},
{"question":"List all enrollments by active instructors.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT Enrollments.* FROM Enrollments JOIN Accounts ON Enrollments.AccountId = Accounts.AccountId WHERE Accounts.Role = N'Instructor' AND Accounts.IsActive = 1;"}
{"question":"Show courses and category names where course title contains SQL","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT c.Title, g.Name AS CategoryName FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId WHERE c.Title LIKE N'%SQL%';"}
{"question":"Get courses and instructor names where title starts with Intro","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, InstructorId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT c.Title, a.FullName AS InstructorName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId WHERE c.Title LIKE N'Intro%';"}
{"question":"Export lessons with course titles where lesson title contains Quiz","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, Title NVARCHAR);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT l.Title AS LessonTitle, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE l.Title LIKE N'%Quiz%';"}
{"question":"List quizzes with lesson titles where quiz title ends with Basics","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR);\nCREATE TABLE Lessons (LessonId INT, Title NVARCHAR);","answer":"SELECT q.Title AS QuizTitle, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId WHERE q.Title LIKE N'%Basics';"}
{"question":"Display quiz questions with quiz titles where question contains SELECT","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT qq.Question, q.Title AS QuizTitle FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId WHERE qq.Question LIKE N'%SELECT%';"}
{"question":"Return enrollments with student names where progress at least 70","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, ProgressPercent REAL);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, e.ProgressPercent FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId WHERE e.ProgressPercent >= 70;"}
{"question":"Give me enrollments with course titles where not completed","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT e.EnrollmentId, c.Title FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId WHERE e.IsCompleted = 0;"}
{"question":"Fetch attempts with quiz titles where score at least 85","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, Score INT);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, qa.Score FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId WHERE qa.Score >= 85;"}
{"question":"Show attempts with student names where submitted today","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, SubmittedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, qa.SubmittedAt FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId WHERE CAST(qa.SubmittedAt AS DATE) = CAST(SYSUTCDATETIME() AS DATE);"}
{"question":"Get reviews with course titles where rating at least 4","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Rating INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, r.Rating FROM CourseReviews r JOIN Courses c ON r.CourseId = c.CourseId WHERE r.Rating >= 4;"}
{"question":"List courses and category names where category name starts with Data","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT c.Title, g.Name FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId WHERE g.Name LIKE N'Data%';"}
{"question":"Display courses and instructor names where instructor name contains Anh","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, InstructorId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT c.Title, a.FullName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId WHERE a.FullName LIKE N'%Anh%';"}
{"question":"Return lessons and course titles where lesson type is video","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR, Title NVARCHAR);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT l.Title, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE l.LessonType = N'video';"}
{"question":"Give me quizzes and lesson titles where lesson title contains Project","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR);\nCREATE TABLE Lessons (LessonId INT, Title NVARCHAR);","answer":"SELECT q.Title, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId WHERE l.Title LIKE N'%Project%';"}
{"question":"Fetch questions and quiz titles where correct option equals 1","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, CorrectOption TINYINT, Question NVARCHAR);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT qq.Question, q.Title FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId WHERE qq.CorrectOption = 1;"}
{"question":"Show enrollments with student names where enrolled this month","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, EnrolledOn DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, e.EnrolledOn FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId WHERE YEAR(e.EnrolledOn) = YEAR(SYSUTCDATETIME()) AND MONTH(e.EnrolledOn) = MONTH(SYSUTCDATETIME());"}
{"question":"Get enrollments with course titles where progress between 30 and 60","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, e.ProgressPercent FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId WHERE e.ProgressPercent BETWEEN 30 AND 60;"}
{"question":"Export attempts with quiz titles where submitted last seven days","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, SubmittedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, qa.SubmittedAt FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId WHERE qa.SubmittedAt >= DATEADD(DAY, -7, SYSUTCDATETIME());"}
{"question":"List attempts with student names where perfect correctness","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, qa.AttemptId FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId WHERE qa.CorrectAnswers = qa.TotalQuestions;"}
{"question":"Display reviews with course titles where comment contains helpful","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Comment NVARCHAR);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, r.Comment FROM CourseReviews r JOIN Courses c ON r.CourseId = c.CourseId WHERE r.Comment LIKE N'%helpful%';"}
{"question":"Return courses and category names where course price less than 120000","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR, Price DECIMAL);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT c.Title, g.Name FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId WHERE c.Price < 120000;"}
{"question":"Give me courses and instructor names where course is published","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, IsPublished BIT, InstructorId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT c.Title, a.FullName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId WHERE c.IsPublished = 1;"}
{"question":"Fetch lessons with course titles where ordering greater than 1","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, Title NVARCHAR, Ordering INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT l.Title, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE l.Ordering > 1;"}
{"question":"Show quizzes with lesson titles where total questions at least 3","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR, TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, Title NVARCHAR);","answer":"SELECT q.Title, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId WHERE q.TotalQuestions >= 3;"}
{"question":"Get questions and quiz titles where question contains WHERE","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT qq.Question, q.Title FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId WHERE qq.Question LIKE N'%WHERE%';"}
{"question":"Export enrollments and student names where progress greater than 80","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, ProgressPercent REAL);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, e.ProgressPercent FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId WHERE e.ProgressPercent > 80;"}
{"question":"List enrollments and course titles where completion date is null","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, e.CompletionDate FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId WHERE e.CompletionDate IS NULL;"}
{"question":"Display attempts and quiz titles where score between 60 and 90","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, Score INT);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, qa.Score FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId WHERE qa.Score BETWEEN 60 AND 90;"}
{"question":"Return attempts and student names where submitted yesterday","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, SubmittedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, qa.SubmittedAt FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId WHERE CAST(qa.SubmittedAt AS DATE) = CAST(DATEADD(DAY, -1, SYSUTCDATETIME()) AS DATE);"}
{"question":"Give me reviews and titles where created this month","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, r.CreatedAt FROM CourseReviews r JOIN Courses c ON r.CourseId = c.CourseId WHERE YEAR(r.CreatedAt) = YEAR(SYSUTCDATETIME()) AND MONTH(r.CreatedAt) = MONTH(SYSUTCDATETIME());"}
{"question":"Fetch courses and category names where title contains Cloud","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT c.Title, g.Name FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId WHERE c.Title LIKE N'%Cloud%';"}
{"question":"Show courses and instructor names where difficulty is advanced","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, Difficulty NVARCHAR, InstructorId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT c.Title, a.FullName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId WHERE c.Difficulty = N'advanced';"}
{"question":"Get lessons and course titles where lesson title contains Lab","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, Title NVARCHAR);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT l.Title, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE l.Title LIKE N'%Lab%';"}
{"question":"Export quizzes and lesson titles where title starts with Course Quiz","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR);\nCREATE TABLE Lessons (LessonId INT, Title NVARCHAR);","answer":"SELECT q.Title, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId WHERE q.Title LIKE N'Course Quiz%';"}
{"question":"List questions and quiz titles where question contains JOIN","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT qq.Question, q.Title FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId WHERE qq.Question LIKE N'%JOIN%';"}
{"question":"Display enrollments and names where student email from example com domain","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR);","answer":"SELECT a.FullName, a.Email FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId WHERE a.Email LIKE N'%@example.com';"}
{"question":"Return enrollments and course titles where title contains API","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, e.EnrollmentId FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId WHERE c.Title LIKE N'%API%';"}
{"question":"Give me attempts and quiz titles where submitted this week","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, SubmittedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, qa.SubmittedAt FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId WHERE DATEPART(YEAR, qa.SubmittedAt) = DATEPART(YEAR, SYSUTCDATETIME()) AND DATEPART(WEEK, qa.SubmittedAt) = DATEPART(WEEK, SYSUTCDATETIME());"}
{"question":"Fetch attempts and names where score at least 90","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, qa.Score FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId WHERE qa.Score >= 90;"}
{"question":"Show reviews and titles where comment contains clear","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Comment NVARCHAR);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, r.Comment FROM CourseReviews r JOIN Courses c ON r.CourseId = c.CourseId WHERE r.Comment LIKE N'%clear%';"}
{"question":"Get courses and instructor names where instructor name starts with Tran","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, InstructorId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT c.Title, a.FullName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId WHERE a.FullName LIKE N'Tran%';"}
{"question":"Export lessons and course titles where course title contains Azure","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, Title NVARCHAR);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT l.Title, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE c.Title LIKE N'%Azure%';"}
{"question":"List quizzes and lesson titles where lesson title contains Practice","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR);\nCREATE TABLE Lessons (LessonId INT, Title NVARCHAR);","answer":"SELECT q.Title, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId WHERE l.Title LIKE N'%Practice%';"}
{"question":"Display questions and quiz titles where question contains GROUP BY","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT qq.Question, q.Title FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId WHERE qq.Question LIKE N'%GROUP BY%';"}
{"question":"Return enrollments and student names where progress less than 20","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, ProgressPercent REAL);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, e.ProgressPercent FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId WHERE e.ProgressPercent < 20;"}
{"question":"Give me enrollments and course titles where course price greater than average","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR, Price DECIMAL);","answer":"SELECT c.Title, e.EnrollmentId FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId WHERE c.Price > (SELECT AVG(Price) FROM Courses);"}
{"question":"Fetch attempts and quiz titles where submitted last thirty days","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, SubmittedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, qa.SubmittedAt FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId WHERE qa.SubmittedAt >= DATEADD(DAY, -30, SYSUTCDATETIME());"}
{"question":"Show attempts and names where account email ends with org","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR, Email NVARCHAR);","answer":"SELECT a.FullName, a.Email FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId WHERE a.Email LIKE N'%.org';"}
{"question":"Get reviews and course titles where rating equals 5","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Rating INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, r.Rating FROM CourseReviews r JOIN Courses c ON r.CourseId = c.CourseId WHERE r.Rating = 5;"}
{"question":"Export courses and category names where category code like CAT1","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR, Name NVARCHAR);","answer":"SELECT c.Title, g.Name FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId WHERE g.Code LIKE N'CAT1%';"}
{"question":"List courses and instructor names where course title contains Data","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, InstructorId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT c.Title, a.FullName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId WHERE c.Title LIKE N'%Data%';"}
{"question":"Display lessons and course titles where lesson created today","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, Title NVARCHAR, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT l.Title, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE CAST(l.CreatedAt AS DATE) = CAST(SYSUTCDATETIME() AS DATE);"}
{"question":"Return quizzes and lesson titles where quiz id greater than ten","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR);\nCREATE TABLE Lessons (LessonId INT, Title NVARCHAR);","answer":"SELECT q.Title, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId WHERE q.QuizId > 10;"}
{"question":"Give me questions and quiz titles where question contains ORDER BY","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT qq.Question, q.Title FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId WHERE qq.Question LIKE N'%ORDER BY%';"}
{"question":"Fetch enrollments and student names where completion date is not null","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, e.CompletionDate FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId WHERE e.CompletionDate IS NOT NULL;"}
{"question":"Show enrollments and course titles where course title starts with Intro","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, e.EnrollmentId FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId WHERE c.Title LIKE N'Intro%';"}
{"question":"Get attempts and quiz titles where score less than 50","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, Score INT);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, qa.Score FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId WHERE qa.Score < 50;"}
{"question":"Export attempts and names where submitted in current month","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, SubmittedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, qa.SubmittedAt FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId WHERE YEAR(qa.SubmittedAt) = YEAR(SYSUTCDATETIME()) AND MONTH(qa.SubmittedAt) = MONTH(SYSUTCDATETIME());"}
{"question":"List reviews and titles where comment contains concise","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Comment NVARCHAR);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, r.Comment FROM CourseReviews r JOIN Courses c ON r.CourseId = c.CourseId WHERE r.Comment LIKE N'%concise%';"}
{"question":"Display courses and instructor names where course not published","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR, IsPublished BIT, InstructorId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT c.Title, a.FullName FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId WHERE c.IsPublished = 0;"}
{"question":"Return lessons and course titles where ordering equals one","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, Title NVARCHAR, Ordering INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT l.Title, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE l.Ordering = 1;"}
{"question":"Give me quizzes and lesson titles where lesson title starts with Chapter","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR);\nCREATE TABLE Lessons (LessonId INT, Title NVARCHAR);","answer":"SELECT q.Title, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId WHERE l.Title LIKE N'Chapter%';"}
{"question":"Fetch questions and quiz titles where question contains UNION","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT qq.Question, q.Title FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId WHERE qq.Question LIKE N'%UNION%';"}
{"question":"Show enrollments and names where progress between 10 and 40","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, ProgressPercent REAL);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, e.ProgressPercent FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId WHERE e.ProgressPercent BETWEEN 10 AND 40;"}
{"question":"Get enrollments and course titles where course title contains ML","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, e.EnrollmentId FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId WHERE c.Title LIKE N'%ML%';"}
{"question":"Export attempts and quiz titles where score between 70 and 100","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, Score INT);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR);","answer":"SELECT q.Title, qa.Score FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId WHERE qa.Score BETWEEN 70 AND 100;"}
{"question":"List attempts and names where name contains Nguyen","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR);","answer":"SELECT a.FullName, qa.AttemptId FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId WHERE a.FullName LIKE N'%Nguyen%';"}
{"question":"Display reviews and titles where created last fourteen days","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR);","answer":"SELECT c.Title, r.CreatedAt FROM CourseReviews r JOIN Courses c ON r.CourseId = c.CourseId WHERE r.CreatedAt >= DATEADD(DAY, -14, SYSUTCDATETIME());"}
{"question":"Return courses and category names where category name contains Science","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR);","answer":"SELECT c.Title, g.Name FROM Courses c JOIN Categories g ON c.CategoryId = g.CategoryId WHERE g.Name LIKE N'%Science%';"}
{"question":"List all accounts that are students.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE Role = N'Student';"},
{"question":"Show all courses that are free.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE Price = 0;"},
{"question":"Get all lessons of type video.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons WHERE LessonType = N'video';"},
{"question":"Display all quiz attempts with a score of zero.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE Score = 0;"},
{"question":"Find all reviews with a 3-star rating.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE Rating = 3;"},
{"question":"Get all accounts that are inactive.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE IsActive = 0;"},
{"question":"List all courses that are not published.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE IsPublished = 0;"},
{"question":"Show all text lessons.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons WHERE LessonType = N'text';"},
{"question":"Get all enrollments that are not completed.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE IsCompleted = 0;"},
{"question":"Find all quiz attempts that were not submitted.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE SubmittedAt IS NULL;"},
{"question":"List all reviews that have no comment.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE Comment IS NULL;"},
{"question":"Show all quizzes with less than 5 questions.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT * FROM Quizzes WHERE TotalQuestions < 5;"},
{"question":"Get all courses assigned to a category.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE CategoryId IS NOT NULL;"},
{"question":"List all courses with 'Python' in the title.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE Title LIKE N'%Python%';"},
{"question":"Show all accounts with email addresses ending in 'educa.com'.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE Email LIKE N'%@educa.com';"},
{"question":"Get all quiz questions where option C is correct.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);","answer":"SELECT * FROM QuizQuestions WHERE CorrectOption = 3;"},
{"question":"Find all enrollments with progress over 90 percent.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE ProgressPercent > 0.9;"},
{"question":"List all courses that are intermediate level.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE Difficulty = N'intermediate';"},
{"question":"Show all quiz attempts with a score between 50 and 70.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE Score BETWEEN 50 AND 70;"},
{"question":"Get all reviews created today.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE CAST(CreatedAt AS DATE) = CAST(SYSUTCDATETIME() AS DATE);"},
{"question":"Find all lessons created this month.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons WHERE MONTH(CreatedAt) = MONTH(SYSUTCDATETIME()) AND YEAR(CreatedAt) = YEAR(SYSUTCDATETIME());"},
{"question":"List all accounts created in the last 7 days.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE CreatedAt >= DATEADD(day, -7, SYSUTCDATETIME());"},
{"question":"Show all enrollments from this year.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE YEAR(EnrolledOn) = YEAR(SYSUTCDATETIME());"},
{"question":"Get all courses published in 2024.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE IsPublished = 1 AND YEAR(CreatedAt) = 2024;"},
{"question":"Find all quizzes with titles starting with 'Intro'.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT * FROM Quizzes WHERE Title LIKE N'Intro%';"},
{"question":"List all 'Lead' instructors from the course instructors table.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR(20));","answer":"SELECT * FROM CourseInstructors WHERE RoleInCourse = N'Lead';"},
{"question":"Show all quiz attempts that scored exactly 100.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE Score = 100;"},
{"question":"Get all enrollments that were completed last month.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE IsCompleted = 1 AND CompletionDate IS NOT NULL AND MONTH(CompletionDate) = MONTH(DATEADD(month, -1, SYSUTCDATETIME())) AND YEAR(CompletionDate) = YEAR(DATEADD(month, -1, SYSUTCDATETIME()));"},
{"question":"List all courses that cost more than 50.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE Price > 50;"},
{"question":"Show all reviews with 4 or 5 stars.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE Rating >= 4;"},
{"question":"How many total accounts are there?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(*) FROM Accounts;"},
{"question":"What is the total number of categories?","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT COUNT(*) FROM Categories;"},
{"question":"Count all published courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(*) FROM Courses WHERE IsPublished = 1;"},
{"question":"How many lessons are there in total?","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(*) FROM Lessons;"},
{"question":"Calculate the total number of quizzes.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT COUNT(*) FROM Quizzes;"},
{"question":"What is the sum of all quiz questions?","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);","answer":"SELECT COUNT(*) FROM QuizQuestions;"},
{"question":"How many enrollments have been made?","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(*) FROM Enrollments;"},
{"question":"Count the total number of quiz attempts.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(*) FROM QuizAttempts;"},
{"question":"How many course reviews exist?","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT COUNT(*) FROM CourseReviews;"},
{"question":"What is the total number of course instructors listed?","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR(20));","answer":"SELECT COUNT(*) FROM CourseInstructors;"},
{"question":"Show all enrollments and the full name of the student.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT Enrollments.*, Accounts.FullName FROM Enrollments JOIN Accounts ON Enrollments.AccountId = Accounts.AccountId;"},
{"question":"List all courses and the name of their category.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT Courses.*, Categories.Name FROM Courses LEFT JOIN Categories ON Courses.CategoryId = Categories.CategoryId;"},
{"question":"Get all reviews and the email of the account that posted them.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT CourseReviews.*, Accounts.Email FROM CourseReviews JOIN Accounts ON CourseReviews.AccountId = Accounts.AccountId;"},
{"question":"Show all quiz attempts and the name of the student.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT QuizAttempts.*, Accounts.FullName FROM QuizAttempts JOIN Accounts ON QuizAttempts.AccountId = Accounts.AccountId;"},
{"question":"List all lessons and the title of the course they belong to.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Lessons.*, Courses.Title FROM Lessons JOIN Courses ON Lessons.CourseId = Courses.CourseId;"},
{"question":"Get all quizzes and the title of the lesson they are part of.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT Quizzes.*, Lessons.Title FROM Quizzes JOIN Lessons ON Quizzes.LessonId = Lessons.LessonId;"},
{"question":"Display all quiz questions and the title of their quiz.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT QuizQuestions.*, Quizzes.Title FROM QuizQuestions JOIN Quizzes ON QuizQuestions.QuizId = Quizzes.QuizId;"},
{"question":"Show all enrollments and the price of the course.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Enrollments.*, Courses.Price FROM Enrollments JOIN Courses ON Enrollments.CourseId = Courses.CourseId;"},
{"question":"List all course instructors and the full name of the instructor.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR(20));\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT CourseInstructors.*, Accounts.FullName FROM CourseInstructors JOIN Accounts ON CourseInstructors.AccountId = Accounts.AccountId;"},
{"question":"Get all reviews for courses that are free.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT CourseReviews.* FROM CourseReviews JOIN Courses ON CourseReviews.CourseId = Courses.CourseId WHERE Courses.Price = 0;"},
{"question":"Count all lessons for beginner courses.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(Lessons.LessonId) FROM Lessons JOIN Courses ON Lessons.CourseId = Courses.CourseId WHERE Courses.Difficulty = N'beginner';"},
{"question":"How many students are enrolled in 'Data Science' course?","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(Enrollments.AccountId) FROM Enrollments JOIN Courses ON Enrollments.CourseId = Courses.CourseId WHERE Courses.Title = N'Data Science';"},
{"question":"What is the average score for the 'Final Exam' quiz?","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT AVG(QuizAttempts.Score) FROM QuizAttempts JOIN Quizzes ON QuizAttempts.QuizId = Quizzes.QuizId WHERE Quizzes.Title = N'Final Exam';"},
{"question":"Count all reviews written by 'John Doe'.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(CourseReviews.ReviewId) FROM CourseReviews JOIN Accounts ON CourseReviews.AccountId = Accounts.AccountId WHERE Accounts.FullName = N'John Doe';"},
{"question":"How many lessons are in the 'Web Development' category?","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT COUNT(Lessons.LessonId) FROM Lessons JOIN Courses ON Lessons.CourseId = Courses.CourseId JOIN Categories ON Courses.CategoryId = Categories.CategoryId WHERE Categories.Name = N'Web Development';"},
{"question":"Calculate the sum of prices for all courses taught by 'Jane Smith'.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT SUM(Courses.Price) FROM Courses JOIN Accounts ON Courses.InstructorId = Accounts.AccountId WHERE Accounts.FullName = N'Jane Smith';"},
{"question":"How many quiz attempts are there for video lessons?","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(QuizAttempts.AttemptId) FROM QuizAttempts JOIN Quizzes ON QuizAttempts.QuizId = Quizzes.QuizId JOIN Lessons ON Quizzes.LessonId = Lessons.LessonId WHERE Lessons.LessonType = N'video';"},
{"question":"What is the average rating for published courses?","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CourseReviews.Rating) FROM CourseReviews JOIN Courses ON CourseReviews.CourseId = Courses.CourseId WHERE Courses.IsPublished = 1;"},
{"question":"Count the number of students who completed 'Python Basics'.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(Enrollments.AccountId) FROM Enrollments JOIN Courses ON Enrollments.CourseId = Courses.CourseId JOIN Accounts ON Enrollments.AccountId = Accounts.AccountId WHERE Courses.Title = N'Python Basics' AND Enrollments.IsCompleted = 1 AND Accounts.Role = N'Student';"},
{"question":"How many quizzes were created by instructor 'Admin User'?","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(Quizzes.QuizId) FROM Quizzes JOIN Lessons ON Quizzes.LessonId = Lessons.LessonId JOIN Courses ON Lessons.CourseId = Courses.CourseId JOIN Accounts ON Courses.InstructorId = Accounts.AccountId WHERE Accounts.FullName = N'Admin User';"},
{"question":"Get the total number of questions in all quizzes for 'intermediate' courses.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT SUM(Quizzes.TotalQuestions) FROM Quizzes JOIN Lessons ON Quizzes.LessonId = Lessons.LessonId JOIN Courses ON Lessons.CourseId = Courses.CourseId WHERE Courses.Difficulty = N'intermediate';"},
{"question":"What is the average progress of students in 'advanced' courses?","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(Enrollments.ProgressPercent) FROM Enrollments JOIN Courses ON Enrollments.CourseId = Courses.CourseId WHERE Courses.Difficulty = N'advanced';"},
{"question":"Count the number of reviews for courses priced over 100.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(CourseReviews.ReviewId) FROM CourseReviews JOIN Courses ON CourseReviews.CourseId = Courses.CourseId WHERE Courses.Price > 100;"},
{"question":"How many 'Lead' instructors are assigned to 'beginner' courses?","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR(20));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(DISTINCT CourseInstructors.AccountId) FROM CourseInstructors JOIN Courses ON CourseInstructors.CourseId = Courses.CourseId WHERE CourseInstructors.RoleInCourse = N'Lead' AND Courses.Difficulty = N'beginner';"},
{"question":"Calculate the sum of all correct answers from active students.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT SUM(QuizAttempts.CorrectAnswers) FROM QuizAttempts JOIN Accounts ON QuizAttempts.AccountId = Accounts.AccountId WHERE Accounts.IsActive = 1 AND Accounts.Role = N'Student';"},
{"question":"How many enrollments were completed by inactive students?","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(Enrollments.EnrollmentId) FROM Enrollments JOIN Accounts ON Enrollments.AccountId = Accounts.AccountId WHERE Accounts.IsActive = 0 AND Enrollments.IsCompleted = 1;"},
{"question":"What is the average number of questions for quizzes in 'Database' courses?","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT AVG(CAST(Quizzes.TotalQuestions AS FLOAT)) FROM Quizzes JOIN Lessons ON Quizzes.LessonId = Lessons.LessonId JOIN Courses ON Lessons.CourseId = Courses.CourseId JOIN Categories ON Courses.CategoryId = Categories.CategoryId WHERE Categories.Name = N'Database';"},
{"question":"Count all reviews that have comments for 'beginner' courses.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(CourseReviews.ReviewId) FROM CourseReviews JOIN Courses ON CourseReviews.CourseId = Courses.CourseId WHERE Courses.Difficulty = N'beginner' AND CourseReviews.Comment IS NOT NULL;"},
{"question":"How many quiz attempts have a score of 100 in 'advanced' courses?","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(QuizAttempts.AttemptId) FROM QuizAttempts JOIN Quizzes ON QuizAttempts.QuizId = Quizzes.QuizId JOIN Lessons ON Quizzes.LessonId = Lessons.LessonId JOIN Courses ON Lessons.CourseId = Courses.CourseId WHERE Courses.Difficulty = N'advanced' AND QuizAttempts.Score = 100;"},
{"question":"List all courses taught by instructors with 'admin' role.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT Courses.* FROM Courses JOIN Accounts ON Courses.InstructorId = Accounts.AccountId WHERE Accounts.Role = N'Admin';"},
{"question":"Show all enrollments made by 'admin' users.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT Enrollments.* FROM Enrollments JOIN Accounts ON Enrollments.AccountId = Accounts.AccountId WHERE Accounts.Role = N'Admin';"},
{"question":"Get all quiz attempts by instructors.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT QuizAttempts.* FROM QuizAttempts JOIN Accounts ON QuizAttempts.AccountId = Accounts.AccountId WHERE Accounts.Role = N'Instructor';"},
{"question":"List all reviews written by active students.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT CourseReviews.* FROM CourseReviews JOIN Accounts ON CourseReviews.AccountId = Accounts.AccountId WHERE Accounts.Role = N'Student' AND Accounts.IsActive = 1;"},
{"question":"Show all video lessons for 'SQL' courses.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Lessons.* FROM Lessons JOIN Courses ON Lessons.CourseId = Courses.CourseId WHERE Courses.Title LIKE N'%SQL%' AND Lessons.LessonType = N'video';"},
{"question":"Get all quizzes for courses in the 'Programming' category.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT Quizzes.* FROM Quizzes JOIN Lessons ON Quizzes.LessonId = Lessons.LessonId JOIN Courses ON Lessons.CourseId = Courses.CourseId JOIN Categories ON Courses.CategoryId = Categories.CategoryId WHERE Categories.Name = N'Programming';"},
{"question":"List all quiz questions for free courses.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT QuizQuestions.* FROM QuizQuestions JOIN Quizzes ON QuizQuestions.QuizId = Quizzes.QuizId JOIN Lessons ON Quizzes.LessonId = Lessons.LessonId JOIN Courses ON Lessons.CourseId = Courses.CourseId WHERE Courses.Price = 0;"},
{"question":"Show all enrollments for courses that are not published.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Enrollments.* FROM Enrollments JOIN Courses ON Enrollments.CourseId = Courses.CourseId WHERE Courses.IsPublished = 0;"},
{"question":"Get all quiz attempts for quizzes with over 10 questions.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT QuizAttempts.* FROM QuizAttempts JOIN Quizzes ON QuizAttempts.QuizId = Quizzes.QuizId WHERE Quizzes.TotalQuestions > 10;"},
{"question":"List all reviews from students with 'gmail.com' emails.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT CourseReviews.* FROM CourseReviews JOIN Accounts ON CourseReviews.AccountId = Accounts.AccountId WHERE Accounts.Role = N'Student' AND Accounts.Email LIKE N'%@gmail.com';"},
{"question":"Show all completed enrollments and the course title.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Enrollments.*, Courses.Title FROM Enrollments JOIN Courses ON Enrollments.CourseId = Courses.CourseId WHERE Enrollments.IsCompleted = 1;"},
{"question":"Get all quiz attempts with perfect scores and the student's name.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT QuizAttempts.*, Accounts.FullName FROM QuizAttempts JOIN Accounts ON QuizAttempts.AccountId = Accounts.AccountId WHERE QuizAttempts.Score = 100;"},
{"question":"List all courses and their main instructor's email.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT Courses.*, Accounts.Email FROM Courses JOIN Accounts ON Courses.InstructorId = Accounts.AccountId;"},
{"question":"Show all 1-star reviews and the course title.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT CourseReviews.*, Courses.Title FROM CourseReviews JOIN Courses ON CourseReviews.CourseId = Courses.CourseId WHERE CourseReviews.Rating = 1;"},
{"question":"Get all lessons for 'advanced' courses.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Lessons.* FROM Lessons JOIN Courses ON Lessons.CourseId = Courses.CourseId WHERE Courses.Difficulty = N'advanced';"},
{"question":"Find all quiz questions where the quiz title is 'Midterm'.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT QuizQuestions.* FROM QuizQuestions JOIN Quizzes ON QuizQuestions.QuizId = Quizzes.QuizId WHERE Quizzes.Title = N'Midterm';"},
{"question":"List all enrollments by inactive students.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT Enrollments.* FROM Enrollments JOIN Accounts ON Enrollments.AccountId = Accounts.AccountId WHERE Accounts.IsActive = 0;"},
{"question":"Show all 5-star reviews and the reviewer's full name.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT CourseReviews.*, Accounts.FullName FROM CourseReviews JOIN Accounts ON CourseReviews.AccountId = Accounts.AccountId WHERE CourseReviews.Rating = 5;"},
{"question":"Get all courses in the 'Business' category.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT Courses.* FROM Courses JOIN Categories ON Courses.CategoryId = Categories.CategoryId WHERE Categories.Name = N'Business';"},
{"question":"List all quiz attempts for the 'Java Basics' course.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT QuizAttempts.* FROM QuizAttempts JOIN Quizzes ON QuizAttempts.QuizId = Quizzes.QuizId JOIN Lessons ON Quizzes.LessonId = Lessons.LessonId JOIN Courses ON Lessons.CourseId = Courses.CourseId WHERE Courses.Title = N'Java Basics';"},
{"question":"Show all enrollments that have 100 percent progress.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE ProgressPercent = 1;"},
{"question":"Get all quizzes associated with text lessons.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT Quizzes.* FROM Quizzes JOIN Lessons ON Quizzes.LessonId = Lessons.LessonId WHERE Lessons.LessonType = N'text';"},
{"question":"List all reviews for courses taught by 'Instructor Bob'.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT CourseReviews.* FROM CourseReviews JOIN Courses ON CourseReviews.CourseId = Courses.CourseId JOIN Accounts ON Courses.InstructorId = Accounts.AccountId WHERE Accounts.FullName = N'Instructor Bob';"},
{"question":"Show all 'assistant' instructors and their full name.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR(20));\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT CourseInstructors.*, Accounts.FullName FROM CourseInstructors JOIN Accounts ON CourseInstructors.AccountId = Accounts.AccountId WHERE CourseInstructors.RoleInCourse != N'Lead';"},
{"question":"Get all lessons for courses that have no category.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Lessons.* FROM Lessons JOIN Courses ON Lessons.CourseId = Courses.CourseId WHERE Courses.CategoryId IS NULL;"},
{"question":"List all quiz attempts with scores less than 60.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE Score < 60;"},
{"question":"Show all courses and their category code.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT Courses.*, Categories.Code FROM Courses LEFT JOIN Categories ON Courses.CategoryId = Categories.CategoryId;"},
{"question":"Get all enrollments and the student's role.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT Enrollments.*, Accounts.Role FROM Enrollments JOIN Accounts ON Enrollments.AccountId = Accounts.AccountId;"},
{"question":"List all 2-star reviews and the course title.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT CourseReviews.*, Courses.Title FROM CourseReviews JOIN Courses ON CourseReviews.CourseId = Courses.CourseId WHERE CourseReviews.Rating = 2;"}
{"question":"Show all accounts created this month","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT * FROM Accounts WHERE YEAR(CreatedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(CreatedAt)=MONTH(SYSUTCDATETIME());"}
{"question":"Get account id and email for inactive students","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), Role NVARCHAR(20), IsActive BIT);","answer":"SELECT AccountId, Email FROM Accounts WHERE Role=N'Student' AND IsActive=0;"}
{"question":"Export all categories sorted by name","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT * FROM Categories ORDER BY Name ASC;"}
{"question":"List code and name of categories that start with CAT","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120));","answer":"SELECT Code, Name FROM Categories WHERE Code LIKE N'CAT%';"}
{"question":"Display all courses published in the last thirty days","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Courses WHERE IsPublished=1 AND CreatedAt>=DATEADD(DAY,-30,SYSUTCDATETIME());"}
{"question":"Return title and price for courses priced under one hundred thousand","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200), Price DECIMAL(12,2));","answer":"SELECT Title, Price FROM Courses WHERE Price<100000;"}
{"question":"Give me all lessons for course id ten ordered by ordering","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT * FROM Lessons WHERE CourseId=10 ORDER BY Ordering ASC;"}
{"question":"Fetch lesson id and title where lesson type is video","context":"CREATE TABLE Lessons (LessonId INT, LessonType NVARCHAR(20), Title NVARCHAR(250));","answer":"SELECT LessonId, Title FROM Lessons WHERE LessonType=N'video';"}
{"question":"Show all quizzes that contain the word final in title","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT * FROM Quizzes WHERE Title LIKE N'%final%';"}
{"question":"Get quiz id and total questions for quizzes with at least five questions","context":"CREATE TABLE Quizzes (QuizId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT QuizId, TotalQuestions FROM Quizzes WHERE TotalQuestions>=5;"}
{"question":"Export all quiz questions that mention SELECT","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(MAX), CorrectOption TINYINT);","answer":"SELECT * FROM QuizQuestions WHERE Question LIKE N'%SELECT%';"}
{"question":"List question id and correct option where correct option equals two","context":"CREATE TABLE QuizQuestions (QuestionId INT, CorrectOption TINYINT);","answer":"SELECT QuestionId, CorrectOption FROM QuizQuestions WHERE CorrectOption=2;"}
{"question":"Display all enrollments with progress at least sixty percent","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT * FROM Enrollments WHERE ProgressPercent>=60;"}
{"question":"Return enrollment id and course id for incomplete enrollments","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT EnrollmentId, CourseId FROM Enrollments WHERE IsCompleted=0;"}
{"question":"Give me all attempts submitted today","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT * FROM QuizAttempts WHERE CAST(SubmittedAt AS DATE)=CAST(SYSUTCDATETIME() AS DATE);"}
{"question":"Fetch attempt id and score for attempts with score at least ninety","context":"CREATE TABLE QuizAttempts (AttemptId INT, Score INT);","answer":"SELECT AttemptId, Score FROM QuizAttempts WHERE Score>=90;"}
{"question":"Show all reviews created this week","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(MAX), CreatedAt DATETIME2);","answer":"SELECT * FROM CourseReviews WHERE DATEDIFF(WEEK, CreatedAt, SYSUTCDATETIME())=0;"}
{"question":"Get review id and rating for five star reviews","context":"CREATE TABLE CourseReviews (ReviewId INT, Rating INT);","answer":"SELECT ReviewId, Rating FROM CourseReviews WHERE Rating=5;"}
{"question":"Export all course and category names for beginner courses","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Difficulty NVARCHAR(20));\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));","answer":"SELECT c.Title, g.Name AS CategoryName FROM Courses c JOIN Categories g ON c.CategoryId=g.CategoryId WHERE c.Difficulty=N'beginner';"}
{"question":"List course title and instructor name for published courses","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200), IsPublished BIT, InstructorId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, a.FullName FROM Courses c JOIN Accounts a ON a.AccountId=c.InstructorId WHERE c.IsPublished=1;"}
{"question":"Display all lessons with their course titles","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, Title NVARCHAR(250));\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT l.*, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON c.CourseId=l.CourseId;"}
{"question":"Return lesson title and course title for lessons that contain quiz in title","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, Title NVARCHAR(250));\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT l.Title, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON c.CourseId=l.CourseId WHERE l.Title LIKE N'%quiz%';"}
{"question":"Give me all quizzes with their lesson titles","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200));\nCREATE TABLE Lessons (LessonId INT, Title NVARCHAR(250));","answer":"SELECT * , l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON l.LessonId=q.LessonId;"}
{"question":"Fetch quiz title and lesson title for quizzes that start with practice","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200));\nCREATE TABLE Lessons (LessonId INT, Title NVARCHAR(250));","answer":"SELECT q.Title, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON l.LessonId=q.LessonId WHERE q.Title LIKE N'practice%';"}
{"question":"Show all attempts with their quiz titles","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, Score INT);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR(200));","answer":"SELECT qa.*, q.Title AS QuizTitle FROM QuizAttempts qa JOIN Quizzes q ON q.QuizId=qa.QuizId;"}
{"question":"Get attempt id quiz title and score for attempts with score between seventy and ninety","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, Score INT);\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR(200));","answer":"SELECT qa.AttemptId, q.Title AS QuizTitle, qa.Score FROM QuizAttempts qa JOIN Quizzes q ON q.QuizId=qa.QuizId WHERE qa.Score BETWEEN 70 AND 90;"}
{"question":"Export all enrollments with student names","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT e.*, a.FullName FROM Enrollments e JOIN Accounts a ON a.AccountId=e.AccountId;"}
{"question":"List student name and progress for enrollments with progress under twenty","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, ProgressPercent REAL);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT a.FullName, e.ProgressPercent FROM Enrollments e JOIN Accounts a ON a.AccountId=e.AccountId WHERE e.ProgressPercent<20;"}
{"question":"Display all enrollments with course titles for the current month","context":"CREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, EnrolledOn DATETIME2);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT e.*, c.Title AS CourseTitle FROM Enrollments e JOIN Courses c ON c.CourseId=e.CourseId WHERE YEAR(e.EnrolledOn)=YEAR(SYSUTCDATETIME()) AND MONTH(e.EnrolledOn)=MONTH(SYSUTCDATETIME());"}
{"question":"Return course title and enrollment count for each course","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT);","answer":"SELECT c.Title, COUNT(e.EnrollmentId) AS Enrollments FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"Give me all courses with their average review rating","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Rating INT);","answer":"SELECT c.*, AVG(CAST(r.Rating AS DECIMAL(10,2))) AS AvgRating FROM Courses c LEFT JOIN CourseReviews r ON r.CourseId=c.CourseId GROUP BY c.CourseId, c.Title;"}
{"question":"Fetch course title and average rating for courses with at least one review","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Rating INT);","answer":"SELECT c.Title, AVG(CAST(r.Rating AS DECIMAL(10,2))) AS AvgRating FROM Courses c JOIN CourseReviews r ON r.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"Show all instructors with total video lessons taught","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Courses (CourseId INT, InstructorId INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20));","answer":"SELECT a.*, COUNT(l.LessonId) AS VideoLessons FROM Accounts a JOIN Courses c ON c.InstructorId=a.AccountId JOIN Lessons l ON l.CourseId=c.CourseId WHERE a.Role=N'Instructor' AND l.LessonType=N'video' GROUP BY a.AccountId, a.FullName, a.Role;"}
{"question":"Get instructor name and distinct student count taught","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Courses (CourseId INT, InstructorId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);","answer":"SELECT a.FullName, COUNT(DISTINCT e.AccountId) AS TotalStudents FROM Accounts a JOIN Courses c ON c.InstructorId=a.AccountId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE a.Role=N'Instructor' GROUP BY a.FullName;"}
{"question":"Export all categories with total course price per category","context":"CREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Price DECIMAL(12,2));","answer":"SELECT g.*, SUM(c.Price) AS TotalValue FROM Categories g LEFT JOIN Courses c ON c.CategoryId=g.CategoryId GROUP BY g.CategoryId, g.Name;"}
{"question":"List quiz title and average score for each quiz","context":"CREATE TABLE Quizzes (QuizId INT, Title NVARCHAR(200));\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, Score INT);","answer":"SELECT q.Title, AVG(CAST(qa.Score AS FLOAT)) AS AverageScore FROM Quizzes q LEFT JOIN QuizAttempts qa ON qa.QuizId=q.QuizId GROUP BY q.Title;"}
{"question":"Display all free courses with total enrollments","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200), Price DECIMAL(12,2));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT);","answer":"SELECT c.*, COUNT(e.EnrollmentId) AS TotalEnrollments FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Price=0 GROUP BY c.CourseId, c.Title, c.Price;"}
{"question":"Return all accounts and the number of enrollments per account","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.*, COUNT(e.EnrollmentId) AS Enrollments FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId GROUP BY a.AccountId, a.FullName;"}
{"question":"Give me course title and number of lessons per course","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Lessons (LessonId INT, CourseId INT);","answer":"SELECT c.Title, COUNT(l.LessonId) AS LessonCount FROM Courses c LEFT JOIN Lessons l ON l.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"Fetch all attempts with student name and quiz title","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, Score INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR(200));","answer":"SELECT qa.*, a.FullName, q.Title AS QuizTitle FROM QuizAttempts qa JOIN Accounts a ON a.AccountId=qa.AccountId JOIN Quizzes q ON q.QuizId=qa.QuizId;"}
{"question":"Show quiz title and total attempts for quizzes created from attempts this month","context":"CREATE TABLE Quizzes (QuizId INT, Title NVARCHAR(200));\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, SubmittedAt DATETIME2);","answer":"SELECT q.Title, COUNT(qa.AttemptId) AS TotalAttempts FROM Quizzes q JOIN QuizAttempts qa ON qa.QuizId=q.QuizId WHERE YEAR(qa.SubmittedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(qa.SubmittedAt)=MONTH(SYSUTCDATETIME()) GROUP BY q.Title;"}
{"question":"Get all reviews joined with course titles for rating at least four","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Rating INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT r.*, c.Title AS CourseTitle FROM CourseReviews r JOIN Courses c ON c.CourseId=r.CourseId WHERE r.Rating>=4;"}
{"question":"Export course title and five star review count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Rating INT);","answer":"SELECT c.Title, COUNT(*) AS FiveStar FROM Courses c JOIN CourseReviews r ON r.CourseId=c.CourseId WHERE r.Rating=5 GROUP BY c.Title;"}
{"question":"List all courses with category name where course title contains cloud","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200));\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));","answer":"SELECT c.*, g.Name AS CategoryName FROM Courses c JOIN Categories g ON g.CategoryId=c.CategoryId WHERE c.Title LIKE N'%cloud%';"}
{"question":"Display course title and category name where price greater than average price","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Price DECIMAL(12,2));\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));","answer":"SELECT c.Title, g.Name FROM Courses c JOIN Categories g ON g.CategoryId=c.CategoryId WHERE c.Price>(SELECT AVG(Price) FROM Courses);"}
{"question":"Return all lessons with course titles where lesson type is quiz","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250));\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT l.*, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON c.CourseId=l.CourseId WHERE l.LessonType=N'quiz';"}
{"question":"Give me lesson title and course title for lessons created in the last seven days","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, Title NVARCHAR(250), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT l.Title, c.Title AS CourseTitle FROM Lessons l JOIN Courses c ON c.CourseId=l.CourseId WHERE l.CreatedAt>=DATEADD(DAY,-7,SYSUTCDATETIME());"}
{"question":"Fetch all questions with their quiz titles where question mentions join","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(MAX));\nCREATE TABLE Quizzes (QuizId INT, Title NVARCHAR(200));","answer":"SELECT qq.*, q.Title AS QuizTitle FROM QuizQuestions qq JOIN Quizzes q ON q.QuizId=qq.QuizId WHERE qq.Question LIKE N'%join%';"}
{"question":"Show all enrollments with student name and course title","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT e.*, a.FullName, c.Title AS CourseTitle FROM Enrollments e JOIN Accounts a ON a.AccountId=e.AccountId JOIN Courses c ON c.CourseId=e.CourseId;"}
{"question":"Get student name and course title for enrollments not completed","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, IsCompleted BIT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT a.FullName, c.Title FROM Enrollments e JOIN Accounts a ON a.AccountId=e.AccountId JOIN Courses c ON c.CourseId=e.CourseId WHERE e.IsCompleted=0;"}
{"question":"Export all attempts with correctness ratio computed","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT *, CAST(CorrectAnswers AS DECIMAL(10,2))/NULLIF(TotalQuestions,0) AS CorrectRatio FROM QuizAttempts;"}
{"question":"List quiz title and average correctness ratio per quiz","context":"CREATE TABLE Quizzes (QuizId INT, Title NVARCHAR(200));\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT q.Title, AVG(CAST(qa.CorrectAnswers AS DECIMAL(10,2))/NULLIF(qa.TotalQuestions,0)) AS AvgCorrectRatio FROM Quizzes q LEFT JOIN QuizAttempts qa ON qa.QuizId=q.QuizId GROUP BY q.Title;"}
{"question":"Display all accounts with total attempts per account","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT a.*, COUNT(qa.AttemptId) AS Attempts FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId GROUP BY a.AccountId, a.FullName;"}
{"question":"Return all courses with total reviews per course","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT);","answer":"SELECT c.*, COUNT(r.ReviewId) AS ReviewCount FROM Courses c LEFT JOIN CourseReviews r ON r.CourseId=c.CourseId GROUP BY c.CourseId, c.Title;"}
{"question":"Give me course title and average score across all attempts in its quizzes","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, Score INT);","answer":"SELECT c.Title, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Courses c JOIN Lessons l ON l.CourseId=c.CourseId JOIN Quizzes q ON q.LessonId=l.LessonId LEFT JOIN QuizAttempts qa ON qa.QuizId=q.QuizId GROUP BY c.Title;"}
{"question":"Fetch all categories with number of published courses","context":"CREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, IsPublished BIT);","answer":"SELECT g.*, COUNT(CASE WHEN c.IsPublished=1 THEN 1 END) AS PublishedCourses FROM Categories g LEFT JOIN Courses c ON c.CategoryId=g.CategoryId GROUP BY g.CategoryId, g.Name;"}
{"question":"Show instructor name and total revenue like price sum of their courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR(200), Price DECIMAL(12,2), InstructorId INT);","answer":"SELECT a.FullName, SUM(c.Price) AS TotalCourseValue FROM Accounts a JOIN Courses c ON c.InstructorId=a.AccountId WHERE a.Role=N'Instructor' GROUP BY a.FullName;"}
{"question":"Get all courses with instructor name and category name","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), InstructorId INT);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.*, g.Name AS CategoryName, a.FullName AS InstructorName FROM Courses c JOIN Categories g ON g.CategoryId=c.CategoryId JOIN Accounts a ON a.AccountId=c.InstructorId;"}
{"question":"Export all attempts with student name where submitted in the last fourteen days","context":"CREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, SubmittedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT qa.*, a.FullName FROM QuizAttempts qa JOIN Accounts a ON a.AccountId=qa.AccountId WHERE qa.SubmittedAt>=DATEADD(DAY,-14,SYSUTCDATETIME());"}
{"question":"List course title and number of quizzes per course","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT);","answer":"SELECT c.Title, COUNT(q.QuizId) AS QuizCount FROM Courses c LEFT JOIN Lessons l ON l.CourseId=c.CourseId LEFT JOIN Quizzes q ON q.LessonId=l.LessonId GROUP BY c.Title;"}
{"question":"Display all accounts with their latest attempt time if any","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, SubmittedAt DATETIME2);","answer":"SELECT a.*, MAX(qa.SubmittedAt) AS LatestAttempt FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId GROUP BY a.AccountId, a.FullName;"}
{"question":"Return all courses that have no lessons","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Lessons (LessonId INT, CourseId INT);","answer":"SELECT c.* FROM Courses c LEFT JOIN Lessons l ON l.CourseId=c.CourseId WHERE l.LessonId IS NULL;"}
{"question":"Give me all lessons whose course title contains data","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, Title NVARCHAR(250));\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT l.* FROM Lessons l JOIN Courses c ON c.CourseId=l.CourseId WHERE c.Title LIKE N'%data%';"}
{"question":"Fetch course title and number of distinct students enrolled","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS Students FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"Show all reviews with course title where comment contains helpful","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Comment NVARCHAR(MAX));\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT r.*, c.Title AS CourseTitle FROM CourseReviews r JOIN Courses c ON c.CourseId=r.CourseId WHERE r.Comment LIKE N'%helpful%';"}
{"question":"Get all quizzes with lesson title where quiz title ends with basics","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200));\nCREATE TABLE Lessons (LessonId INT, Title NVARCHAR(250));","answer":"SELECT q.*, l.Title AS LessonTitle FROM Quizzes q JOIN Lessons l ON l.LessonId=q.LessonId WHERE q.Title LIKE N'%basics';"}
{"question":"Export student name and average score across all attempts","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a JOIN QuizAttempts qa ON qa.AccountId=a.AccountId GROUP BY a.FullName;"}
{"question":"How many admin accounts are there?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(AccountId) FROM Accounts WHERE Role = N'Admin';"},
{"question":"What is the total number of published courses?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(CourseId) FROM Courses WHERE IsPublished = 1;"},
{"question":"Calculate the average price of all 'beginner' courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(Price) FROM Courses WHERE Difficulty = N'beginner';"},
{"question":"Find the total sum of prices for all 'advanced' courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT SUM(Price) FROM Courses WHERE Difficulty = N'advanced';"},
{"question":"How many text lessons are there?","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(LessonId) FROM Lessons WHERE LessonType = N'text';"},
{"question":"Get the total number of quiz questions available.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);","answer":"SELECT COUNT(QuestionId) FROM QuizQuestions;"},
{"question":"What is the average rating from all course reviews?","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(Rating AS FLOAT)) FROM CourseReviews;"},
{"question":"How many enrollments have progress greater than 50 percent?","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(EnrollmentId) FROM Enrollments WHERE ProgressPercent > 0.5;"},
{"question":"Find the maximum price of any course.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT MAX(Price) FROM Courses;"},
{"question":"What is the minimum score recorded in quiz attempts?","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT MIN(Score) FROM QuizAttempts WHERE Score IS NOT NULL;"},
{"question":"List the full names and emails of all students.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT FullName, Email FROM Accounts WHERE Role = N'Student';"},
{"question":"Show the titles of all courses that are free.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Title FROM Courses WHERE Price = 0;"},
{"question":"Get the comments from all 5-star reviews.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT Comment FROM CourseReviews WHERE Rating = 5;"},
{"question":"List the titles of all quizzes that have 5 questions or less.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT Title FROM Quizzes WHERE TotalQuestions <= 5;"},
{"question":"Find the titles of all lessons, sorted by their ordering.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT Title FROM Lessons ORDER BY Ordering;"},
{"question":"Show the course titles that include 'React'.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Title FROM Courses WHERE Title LIKE N'%React%';"},
{"question":"Get the email addresses of all inactive instructors.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT Email FROM Accounts WHERE Role = N'Instructor' AND IsActive = 0;"},
{"question":"List the questions where option D is the correct answer.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);","answer":"SELECT Question FROM QuizQuestions WHERE CorrectOption = 4;"},
{"question":"Show the titles and prices of courses costing between 20 and 50.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Title, Price FROM Courses WHERE Price BETWEEN 20 AND 50;"},
{"question":"Get the names of categories that have 'Development' in the name.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT Name FROM Categories WHERE Name LIKE N'%Development%';"},
{"question":"Find the titles of courses taught by 'Instructor Alice'.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT c.Title FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId WHERE a.FullName = N'Instructor Alice';"},
{"question":"List the names of students enrolled in the 'Machine Learning' course.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT a.FullName FROM Accounts a JOIN Enrollments e ON a.AccountId = e.AccountId JOIN Courses c ON e.CourseId = c.CourseId WHERE c.Title = N'Machine Learning';"},
{"question":"Show the lesson titles for the 'Data Structures' course.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT l.Title FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE c.Title = N'Data Structures';"},
{"question":"Get the quiz titles associated with the 'Introduction to SQL' lesson.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT q.Title FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId WHERE l.Title = N'Introduction to SQL';"},
{"question":"List the questions for the 'Midterm Exam' quiz.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT qq.Question FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId WHERE q.Title = N'Midterm Exam';"},
{"question":"Find the scores and submission dates for 'Bob's' quiz attempts.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT qa.Score, qa.SubmittedAt FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId WHERE a.FullName = N'Bob';"},
{"question":"Show the ratings and comments for the 'C# Advanced' course.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT cr.Rating, cr.Comment FROM CourseReviews cr JOIN Courses c ON cr.CourseId = c.CourseId WHERE c.Title = N'C# Advanced';"},
{"question":"List the names of students who left reviews for 'React Hooks'.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT a.FullName FROM Accounts a JOIN CourseReviews cr ON a.AccountId = cr.AccountId JOIN Courses c ON cr.CourseId = c.CourseId WHERE c.Title = N'React Hooks';"},
{"question":"Get the course titles and their category names.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT c.Title, cat.Name FROM Courses c LEFT JOIN Categories cat ON c.CategoryId = cat.CategoryId;"},
{"question":"Find the names of instructors who are also 'Lead' instructors.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR(20));","answer":"SELECT DISTINCT a.FullName FROM Accounts a JOIN CourseInstructors ci ON a.AccountId = ci.AccountId WHERE a.Role = N'Instructor' AND ci.RoleInCourse = N'Lead';"},
{"question":"How many students are enrolled in each course?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT c.Title, COUNT(e.AccountId) FROM Courses c LEFT JOIN Enrollments e ON c.CourseId = e.CourseId GROUP BY c.Title;"},
{"question":"What is the average rating for each instructor's courses?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT a.FullName, AVG(CAST(cr.Rating AS FLOAT)) FROM Accounts a JOIN Courses c ON a.AccountId = c.InstructorId LEFT JOIN CourseReviews cr ON c.CourseId = cr.CourseId WHERE a.Role = N'Instructor' GROUP BY a.FullName;"},
{"question":"Count the number of lessons for each course title.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT c.Title, COUNT(l.LessonId) FROM Courses c LEFT JOIN Lessons l ON c.CourseId = l.CourseId GROUP BY c.Title;"},
{"question":"Get the total number of quiz attempts for each quiz title.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT q.Title, COUNT(qa.AttemptId) FROM Quizzes q LEFT JOIN QuizAttempts qa ON q.QuizId = qa.QuizId GROUP BY q.Title;"},
{"question":"What is the highest score for each student?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT a.FullName, MAX(qa.Score) FROM Accounts a LEFT JOIN QuizAttempts qa ON a.AccountId = qa.AccountId WHERE a.Role = N'Student' GROUP BY a.FullName;"},
{"question":"How many courses are in each category?","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT cat.Name, COUNT(c.CourseId) FROM Categories cat LEFT JOIN Courses c ON cat.CategoryId = c.CategoryId GROUP BY cat.Name;"},
{"question":"Calculate the total number of enrollments for each student.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) FROM Accounts a LEFT JOIN Enrollments e ON a.AccountId = e.AccountId WHERE a.Role = N'Student' GROUP BY a.FullName;"},
{"question":"Find the average progress percentage for each course.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT c.Title, AVG(e.ProgressPercent) FROM Courses c LEFT JOIN Enrollments e ON c.CourseId = e.CourseId GROUP BY c.Title;"},
{"question":"How many reviews has each student posted?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT a.FullName, COUNT(cr.ReviewId) FROM Accounts a LEFT JOIN CourseReviews cr ON a.AccountId = cr.AccountId WHERE a.Role = N'Student' GROUP BY a.FullName;"},
{"question":"Get the total sum of questions for each lesson that contains a quiz.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT l.Title, SUM(q.TotalQuestions) FROM Lessons l JOIN Quizzes q ON l.LessonId = q.LessonId GROUP BY l.Title;"},
{"question":"How many courses has each instructor published?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT a.FullName, COUNT(c.CourseId) FROM Accounts a LEFT JOIN Courses c ON a.AccountId = c.InstructorId WHERE a.Role = N'Instructor' AND c.IsPublished = 1 GROUP BY a.FullName;"},
{"question":"What is the total price of courses for each difficulty level?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Difficulty, SUM(Price) FROM Courses GROUP BY Difficulty;"},
{"question":"Find the average score for quizzes in 'advanced' courses.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(qa.Score AS FLOAT)) FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId JOIN Lessons l ON q.LessonId = l.LessonId JOIN Courses c ON l.CourseId = c.CourseId WHERE c.Difficulty = N'advanced';"},
{"question":"How many enrollments are there for courses in the 'Business' category?","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT COUNT(e.EnrollmentId) FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId JOIN Categories cat ON c.CategoryId = cat.CategoryId WHERE cat.Name = N'Business';"},
{"question":"Get the total count of 1-star reviews for published courses.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(cr.ReviewId) FROM CourseReviews cr JOIN Courses c ON cr.CourseId = c.CourseId WHERE c.IsPublished = 1 AND cr.Rating = 1;"},
{"question":"How many video lessons were created by 'Instructor Bob'?","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(l.LessonId) FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId JOIN Accounts a ON c.InstructorId = a.AccountId WHERE a.FullName = N'Instructor Bob' AND l.LessonType = N'video';"},
{"question":"Find the average progress of active students.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT AVG(e.ProgressPercent) FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId WHERE a.Role = N'Student' AND a.IsActive = 1;"},
{"question":"What is the total number of quiz questions for free courses?","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(qq.QuestionId) FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId JOIN Lessons l ON q.LessonId = l.LessonId JOIN Courses c ON l.CourseId = c.CourseId WHERE c.Price = 0;"},
{"question":"How many enrollments were completed in the 'Programming' category?","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT COUNT(e.EnrollmentId) FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId JOIN Categories cat ON c.CategoryId = cat.CategoryId WHERE cat.Name = N'Programming' AND e.IsCompleted = 1;"},
{"question":"Get the average score for quizzes created this year.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(qa.Score AS FLOAT)) FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId JOIN Lessons l ON q.LessonId = l.LessonId WHERE YEAR(l.CreatedAt) = YEAR(SYSUTCDATETIME());"},
{"question":"Show all lesson titles and their course price.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT l.Title, c.Price FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId;"},
{"question":"List student names and their enrollment completion dates.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT a.FullName, e.CompletionDate FROM Accounts a JOIN Enrollments e ON a.AccountId = e.AccountId WHERE e.IsCompleted = 1;"},
{"question":"Get quiz titles and the full name of the course instructor.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT q.Title, a.FullName FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId JOIN Courses c ON l.CourseId = c.CourseId JOIN Accounts a ON c.InstructorId = a.AccountId;"},
{"question":"Find review comments and the difficulty of the course reviewed.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT cr.Comment, c.Difficulty FROM CourseReviews cr JOIN Courses c ON cr.CourseId = c.CourseId WHERE cr.Comment IS NOT NULL;"},
{"question":"List the names of students who enrolled in courses today.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT a.FullName FROM Accounts a JOIN Enrollments e ON a.AccountId = e.AccountId WHERE CAST(e.EnrolledOn AS DATE) = CAST(SYSUTCDATETIME() AS DATE);"},
{"question":"Show course titles and the count of 'Lead' instructors for each.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR(20));","answer":"SELECT c.Title, COUNT(ci.AccountId) FROM Courses c LEFT JOIN CourseInstructors ci ON c.CourseId = ci.CourseId WHERE ci.RoleInCourse = N'Lead' GROUP BY c.Title;"},
{"question":"Get the total number of enrollments for 'intermediate' courses.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(e.EnrollmentId) FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId WHERE c.Difficulty = N'intermediate';"},
{"question":"What is the average rating given by instructors?","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(cr.Rating AS FLOAT)) FROM CourseReviews cr JOIN Accounts a ON cr.AccountId = a.AccountId WHERE a.Role = N'Instructor';"},
{"question":"How many quizzes are in courses taught by 'Admin User'?","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(q.QuizId) FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId JOIN Courses c ON l.CourseId = c.CourseId JOIN Accounts a ON c.InstructorId = a.AccountId WHERE a.FullName = N'Admin User';"},
{"question":"Calculate the sum of all correct answers for the 'Final Exam' quiz.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT SUM(qa.CorrectAnswers) FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId WHERE q.Title = N'Final Exam';"},
{"question":"How many students have attempts with scores below 50?","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(DISTINCT a.AccountId) FROM Accounts a JOIN QuizAttempts qa ON a.AccountId = qa.AccountId WHERE a.Role = N'Student' AND qa.Score < 50;"},
{"question":"List course titles and their summaries for the 'Business' category.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT c.Title, c.Summary FROM Courses c JOIN Categories cat ON c.CategoryId = cat.CategoryId WHERE cat.Name = N'Business';"},
{"question":"Get the average score for students enrolled in 'React Basics'.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(qa.Score AS FLOAT)) FROM QuizAttempts qa JOIN Enrollments e ON qa.AccountId = e.AccountId JOIN Courses c ON e.CourseId = c.CourseId WHERE c.Title = N'React Basics';"},
{"question":"How many courses are taught by instructors named 'Michael'?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(c.CourseId) FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId WHERE a.FullName LIKE N'Michael%';"},
{"question":"Find the total number of quiz questions in the 'Programming' category.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT COUNT(qq.QuestionId) FROM QuizQuestions qq JOIN Quizzes q ON qq.QuizId = q.QuizId JOIN Lessons l ON q.LessonId = l.LessonId JOIN Courses c ON l.CourseId = c.CourseId JOIN Categories cat ON c.CategoryId = cat.CategoryId WHERE cat.Name = N'Programming';"},
{"question":"List the names of students who have not completed any enrollments.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT a.FullName FROM Accounts a JOIN Enrollments e ON a.AccountId = e.AccountId WHERE a.Role = N'Student' AND e.IsCompleted = 0;"},
{"question":"Get the average rating for unpublished courses.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(cr.Rating AS FLOAT)) FROM CourseReviews cr JOIN Courses c ON cr.CourseId = c.CourseId WHERE c.IsPublished = 0;"},
{"question":"How many total correct answers does 'student@example.com' have?","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT SUM(qa.CorrectAnswers) FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId WHERE a.Email = N'student@example.com';"},
{"question":"Find the total number of quiz attempts for free, beginner courses.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(qa.AttemptId) FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId JOIN Lessons l ON q.LessonId = l.LessonId JOIN Courses c ON l.CourseId = c.CourseId WHERE c.Price = 0 AND c.Difficulty = N'beginner';"},
{"question":"List course titles and the number of enrollments completed for each.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT c.Title, COUNT(e.EnrollmentId) FROM Courses c LEFT JOIN Enrollments e ON c.CourseId = e.CourseId WHERE e.IsCompleted = 1 GROUP BY c.Title;"},
{"question":"How many courses were published by 'Admin User'?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(c.CourseId) FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId WHERE a.FullName = N'Admin User' AND c.IsPublished = 1;"},
{"question":"Get the average number of total questions for quizzes in 'beginner' courses.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(q.TotalQuestions AS FLOAT)) FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId JOIN Courses c ON l.CourseId = c.CourseId WHERE c.Difficulty = N'beginner';"},
{"question":"List the names of students who have submitted at least one quiz.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT DISTINCT a.FullName FROM Accounts a JOIN QuizAttempts qa ON a.AccountId = qa.AccountId WHERE a.Role = N'Student' AND qa.SubmittedAt IS NOT NULL;"},
{"question":"How many reviews with comments exist for courses by 'Instructor Bob'?","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(cr.ReviewId) FROM CourseReviews cr JOIN Courses c ON cr.CourseId = c.CourseId JOIN Accounts a ON c.InstructorId = a.AccountId WHERE a.FullName = N'Instructor Bob' AND cr.Comment IS NOT NULL;"},
{"question":"Find the total number of enrollments made in the last 30 days.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(EnrollmentId) FROM Enrollments WHERE EnrolledOn >= DATEADD(day, -30, SYSUTCDATETIME());"},
{"question":"What is the average price of courses in the 'Data' category?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT AVG(c.Price) FROM Courses c JOIN Categories cat ON c.CategoryId = cat.CategoryId WHERE cat.Name = N'Data';"},
{"question":"How many active students are enrolled in 'intermediate' courses?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(DISTINCT e.AccountId) FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId JOIN Accounts a ON e.AccountId = a.AccountId WHERE c.Difficulty = N'intermediate' AND a.Role = N'Student' AND a.IsActive = 1;"},
{"question":"Get the total number of correct answers for all quizzes in 'beginner' courses.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT SUM(qa.CorrectAnswers) FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId JOIN Lessons l ON q.LessonId = l.LessonId JOIN Courses c ON l.CourseId = c.CourseId WHERE c.Difficulty = N'beginner';"},
{"question":"List course titles and the full name of their category.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT c.Title, cat.Name FROM Courses c LEFT JOIN Categories cat ON c.CategoryId = cat.CategoryId;"},
{"question":"Show student names and the courses they are enrolled in.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT a.FullName, c.Title FROM Accounts a JOIN Enrollments e ON a.AccountId = e.AccountId JOIN Courses c ON e.CourseId = c.CourseId WHERE a.Role = N'Student';"},
{"question":"Get quiz titles and their lesson titles.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT q.Title, l.Title FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId;"},
{"question":"List review comments and the name of the student who wrote them.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT cr.Comment, a.FullName FROM CourseReviews cr JOIN Accounts a ON cr.AccountId = a.AccountId WHERE cr.Comment IS NOT NULL;"},
{"question":"Show the names of instructors and the titles of the courses they teach.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT a.FullName, c.Title FROM Accounts a JOIN Courses c ON a.AccountId = c.InstructorId WHERE a.Role = N'Instructor';"},
{"question":"Find the names of students who have attempts with scores of 100.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT DISTINCT a.FullName FROM Accounts a JOIN QuizAttempts qa ON a.AccountId = qa.AccountId WHERE qa.Score = 100;"},
{"question":"List the quiz titles and the courses they belong to.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT q.Title, c.Title FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId JOIN Courses c ON l.CourseId = c.CourseId;"},
{"question":"How many 'Lead' instructors are assigned to each course?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR(20));","answer":"SELECT c.Title, COUNT(ci.AccountId) FROM Courses c LEFT JOIN CourseInstructors ci ON c.CourseId = ci.CourseId WHERE ci.RoleInCourse = N'Lead' GROUP BY c.Title;"},
{"question":"Get the total number of quiz questions for each course.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT c.Title, COUNT(qq.QuestionId) FROM Courses c LEFT JOIN Lessons l ON c.CourseId = l.CourseId LEFT JOIN Quizzes q ON l.LessonId = q.LessonId LEFT JOIN QuizQuestions qq ON q.QuizId = qq.QuizId GROUP BY c.Title;"},
{"question":"What is the average rating for free courses?","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(cr.Rating AS FLOAT)) FROM CourseReviews cr JOIN Courses c ON cr.CourseId = c.CourseId WHERE c.Price = 0;"},
{"question":"How many courses has each student completed?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) FROM Accounts a LEFT JOIN Enrollments e ON a.AccountId = e.AccountId WHERE a.Role = N'Student' AND e.IsCompleted = 1 GROUP BY a.FullName;"},
{"question":"List the names of students who have enrolled in 'beginner' courses.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT DISTINCT a.FullName FROM Accounts a JOIN Enrollments e ON a.AccountId = e.AccountId JOIN Courses c ON e.CourseId = c.CourseId WHERE c.Difficulty = N'beginner';"},
{"question":"What is the total price of courses in the 'Design' category?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT SUM(c.Price) FROM Courses c JOIN Categories cat ON c.CategoryId = cat.CategoryId WHERE cat.Name = N'Design';"},
{"question":"How many quizzes are there in 'advanced' courses?","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(q.QuizId) FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId JOIN Courses c ON l.CourseId = c.CourseId WHERE c.Difficulty = N'advanced';"},
{"question":"Get the count of 1-star reviews for each course.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT c.Title, COUNT(cr.ReviewId) FROM Courses c LEFT JOIN CourseReviews cr ON c.CourseId = cr.CourseId WHERE cr.Rating = 1 GROUP BY c.Title;"},
{"question":"How many enrollments were made by active students in 'SQL' courses?","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(e.EnrollmentId) FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId JOIN Accounts a ON e.AccountId = a.AccountId WHERE c.Title LIKE N'%SQL%' AND a.Role = N'Student' AND a.IsActive = 1;"},
{"question":"List the names of students who have not submitted any quiz attempts.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT a.FullName FROM Accounts a LEFT JOIN QuizAttempts qa ON a.AccountId = qa.AccountId WHERE a.Role = N'Student' AND qa.AttemptId IS NULL;"},
{"question":"What is the average progress for enrollments made last month?","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT AVG(ProgressPercent) FROM Enrollments WHERE MONTH(EnrolledOn) = MONTH(DATEADD(month, -1, SYSUTCDATETIME())) AND YEAR(EnrolledOn) = YEAR(DATEADD(month, -1, SYSUTCDATETIME()));"},
{"question":"How many total questions are in quizzes from 'text' lessons?","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT SUM(q.TotalQuestions) FROM Quizzes q JOIN Lessons l ON q.LessonId = l.LessonId WHERE l.LessonType = N'text';"},
{"question":"Find the names of instructors for courses that have no category.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT a.FullName FROM Accounts a JOIN Courses c ON a.AccountId = c.InstructorId WHERE c.CategoryId IS NULL;"},
{"question":"Get the count of submitted attempts for each quiz.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT q.Title, COUNT(qa.AttemptId) FROM Quizzes q LEFT JOIN QuizAttempts qa ON q.QuizId = qa.QuizId WHERE qa.SubmittedAt IS NOT NULL GROUP BY q.Title;"},
{"question":"What is the total price of courses created by instructors with 'gmail.com' emails?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT SUM(c.Price) FROM Courses c JOIN Accounts a ON c.InstructorId = a.AccountId WHERE a.Email LIKE N'%@gmail.com';"},
{"question":"How many students are enrolled in 'unpublished' courses?","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(DISTINCT e.AccountId) FROM Enrollments e JOIN Courses c ON e.CourseId = c.CourseId JOIN Accounts a ON e.AccountId = a.AccountId WHERE c.IsPublished = 0 AND a.Role = N'Student';"},
{"question":"List the names of students who gave 1-star reviews.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT a.FullName FROM Accounts a JOIN CourseReviews cr ON a.AccountId = cr.AccountId WHERE cr.Rating = 1;"},
{"question":"What is the average progress of students who enrolled this year?","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT AVG(e.ProgressPercent) FROM Enrollments e JOIN Accounts a ON e.AccountId = a.AccountId WHERE a.Role = N'Student' AND YEAR(e.EnrolledOn) = YEAR(SYSUTCDATETIME());"},
{"question":"Count the number of lessons in free, beginner courses.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(l.LessonId) FROM Lessons l JOIN Courses c ON l.CourseId = c.CourseId WHERE c.Price = 0 AND c.Difficulty = N'beginner';"},
{"question":"How many 'Lead' instructors are there in the 'Programming' category?","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR(20));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT COUNT(DISTINCT ci.AccountId) FROM CourseInstructors ci JOIN Courses c ON ci.CourseId = c.CourseId JOIN Categories cat ON c.CategoryId = cat.CategoryId WHERE ci.RoleInCourse = N'Lead' AND cat.Name = N'Programming';"},
{"question":"Get the total number of quiz attempts for courses created by 'Admin User'.","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(qa.AttemptId) FROM QuizAttempts qa JOIN Quizzes q ON qa.QuizId = q.QuizId JOIN Lessons l ON q.LessonId = l.LessonId JOIN Courses c ON l.CourseId = c.CourseId JOIN Accounts a ON c.InstructorId = a.AccountId WHERE a.FullName = N'Admin User';"},
{"question":"What is the average score of 'student@example.com'?","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(qa.Score AS FLOAT)) FROM QuizAttempts qa JOIN Accounts a ON qa.AccountId = a.AccountId WHERE a.Email = N'student@example.com';"}
{"question":"Show course title with number of instructors and number of students","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200), CategoryId INT, InstructorId INT);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT c.Title, COUNT(DISTINCT ci.AccountId) AS InstructorCount, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"List all courses with category name student count and instructor count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200), CategoryId INT);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, g.Name AS CategoryName, COUNT(DISTINCT e.AccountId) AS StudentCount, COUNT(DISTINCT ci.AccountId) AS InstructorCount FROM Courses c JOIN Categories g ON g.CategoryId=c.CategoryId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId GROUP BY c.Title, g.Name;"}
{"question":"Get courses in category Data Science with student count and instructor list","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200), CategoryId INT);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount, STRING_AGG(a.FullName, N', ') AS Instructors FROM Courses c JOIN Categories g ON g.CategoryId=c.CategoryId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE g.Name=N'Data Science' GROUP BY c.Title;"}
{"question":"Export course title with instructor names as a comma list","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS InstructorNames FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId GROUP BY c.Title;"}
{"question":"Display courses with zero instructors and zero students","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);","answer":"SELECT c.Title FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title HAVING COUNT(ci.Id)=0 AND COUNT(e.EnrollmentId)=0;"}
{"question":"Return courses whose title contains cloud with student count and instructor count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount, COUNT(DISTINCT ci.AccountId) AS InstructorCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%cloud%' GROUP BY c.Title;"}
{"question":"Give me top five courses by student count with instructor count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT TOP(5) c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount, COUNT(DISTINCT ci.AccountId) AS InstructorCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId GROUP BY c.Title ORDER BY StudentCount DESC;"}
{"question":"Fetch courses with category name where category starts with AI and include student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200), CategoryId INT);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);","answer":"SELECT c.Title, g.Name AS CategoryName, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c JOIN Categories g ON g.CategoryId=c.CategoryId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE g.Name LIKE N'AI%' GROUP BY c.Title, g.Name;"}
{"question":"Show course title with number of lessons instructors and students","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);","answer":"SELECT c.Title, COUNT(DISTINCT l.LessonId) AS LessonCount, COUNT(DISTINCT ci.AccountId) AS InstructorCount, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Lessons l ON l.CourseId=c.CourseId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"List students with number of enrolled courses and number of completed courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS EnrolledCourses, SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS CompletedCourses FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Get students with average quiz score across all attempts","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AverageScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Export students with enrolled courses completed courses and average score","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, IsCompleted BIT);\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS EnrolledCourses, SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS CompletedCourses, AVG(CAST(qa.Score AS FLOAT)) AS AverageScore FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Display students who have not enrolled in any course","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);","answer":"SELECT a.FullName FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND e.EnrollmentId IS NULL GROUP BY a.FullName;"}
{"question":"Return students who have no completed courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName HAVING SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END)=0;"}
{"question":"Give me students with participation rate under fifty percent based on all courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT a.FullName, CAST(COUNT(DISTINCT e.CourseId) AS DECIMAL(10,2))/NULLIF((SELECT COUNT(*) FROM Courses),0) AS ParticipationRate FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName HAVING CAST(COUNT(DISTINCT e.CourseId) AS DECIMAL(10,2))/NULLIF((SELECT COUNT(*) FROM Courses),0) < 0.5;"}
{"question":"Fetch students with completion rate under fifty percent among enrolled courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRate FROM Accounts a JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName HAVING COUNT(e.EnrollmentId)>0 AND CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) < 0.5;"}
{"question":"Show students with number of courses joined and number of courses completed","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS JoinedCourses, SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS CompletedCourses FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"List courses with student count where student role is Student","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE Accounts (AccountId INT, Role NVARCHAR(20));","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=e.AccountId AND a.Role=N'Student' GROUP BY c.Title;"}
{"question":"Display courses with instructor count using mapping table","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"Return category name with number of courses instructors and students","context":"CREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Courses (CourseId INT, CategoryId INT);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT g.Name, COUNT(DISTINCT c.CourseId) AS CourseCount, COUNT(DISTINCT ci.AccountId) AS Instructors, COUNT(DISTINCT e.AccountId) AS Students FROM Categories g LEFT JOIN Courses c ON c.CategoryId=g.CategoryId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY g.Name;"}
{"question":"Get courses created this month with student count and instructor list","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200), CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount, STRING_AGG(a.FullName, N', ') AS Instructors FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE YEAR(c.CreatedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(c.CreatedAt)=MONTH(SYSUTCDATETIME()) GROUP BY c.Title;"}
{"question":"Export courses with ratio of completed enrollments to total enrollments","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT c.Title, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"List students with last attempt score and enrolled count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, SubmittedAt DATETIME2, Score INT);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, MAX(qa.SubmittedAt) AS LastAttemptAt, MAX(CASE WHEN qa.SubmittedAt=MAX(qa.SubmittedAt) THEN qa.Score END) OVER(PARTITION BY a.AccountId) AS LastScore, COUNT(e.EnrollmentId) AS Enrolled FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.AccountId, a.FullName;"}
{"question":"Show students with zero quiz attempts and at least one enrollment","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName HAVING COUNT(e.EnrollmentId)>0 AND COUNT(qa.AttemptId)=0;"}
{"question":"Get students who completed all enrolled courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName FROM Accounts a JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName HAVING COUNT(*)>0 AND SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END)=COUNT(*);" }
{"question":"Display courses with student count filtered by title contains api","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%api%' GROUP BY c.Title;"}
{"question":"Return students with average score and completion count this month","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT, SubmittedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT a.FullName, AVG(CASE WHEN YEAR(qa.SubmittedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(qa.SubmittedAt)=MONTH(SYSUTCDATETIME()) THEN CAST(qa.Score AS FLOAT) END) AS AvgScoreThisMonth, SUM(CASE WHEN e.IsCompleted=1 AND YEAR(e.CompletionDate)=YEAR(SYSUTCDATETIME()) AND MONTH(e.CompletionDate)=MONTH(SYSUTCDATETIME()) THEN 1 ELSE 0 END) AS CompletedThisMonth FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Give me courses with instructor list where student count at least ten","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS Instructors, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title HAVING COUNT(DISTINCT e.AccountId) >= 10;"}
{"question":"Fetch courses with both instructor count and lesson count for overview","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount, COUNT(l.LessonId) AS LessonCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Lessons l ON l.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"Show students with participation and completion counts in one row","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined, SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS Completed FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"List courses with student count and average progress of enrollments","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"Display students with number of distinct courses that have at least one quiz attempt","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT);\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, QuizId INT);","answer":"SELECT a.FullName, COUNT(DISTINCT e.CourseId) AS CoursesWithAttempts FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId LEFT JOIN Lessons l ON l.CourseId=e.CourseId LEFT JOIN Quizzes q ON q.LessonId=l.LessonId LEFT JOIN QuizAttempts qa ON qa.QuizId=q.QuizId AND qa.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Return students whose completion count is zero but joined at least one course","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName HAVING COUNT(e.EnrollmentId)>0 AND SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END)=0;"}
{"question":"Get courses with student count and five star review count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Rating INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount, SUM(CASE WHEN r.Rating=5 THEN 1 ELSE 0 END) AS FiveStarReviews FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId LEFT JOIN CourseReviews r ON r.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"Export students with participation rate and completion rate in separate columns","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT, CourseId INT);\nCREATE TABLE Courses (CourseId INT);","answer":"SELECT a.FullName, CAST(COUNT(DISTINCT e.CourseId) AS DECIMAL(10,2))/NULLIF((SELECT COUNT(*) FROM Courses),0) AS ParticipationRate, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRate FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"List students whose participation and completion rates are both under fifty percent","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT, CourseId INT);\nCREATE TABLE Courses (CourseId INT);","answer":"SELECT a.FullName FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName HAVING CAST(COUNT(DISTINCT e.CourseId) AS DECIMAL(10,2))/NULLIF((SELECT COUNT(*) FROM Courses),0) < 0.5 AND CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) < 0.5;"}
{"question":"Display courses with instructor names and student count for quick overview","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, STRING_AGG(DISTINCT a.FullName, N', ') AS InstructorNames, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"Return courses by category with counts of instructors lessons and students","context":"CREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR(200), CategoryId INT);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT g.Name AS CategoryName, COUNT(DISTINCT c.CourseId) AS Courses, COUNT(DISTINCT ci.AccountId) AS Instructors, COUNT(DISTINCT l.LessonId) AS Lessons, COUNT(DISTINCT e.AccountId) AS Students FROM Categories g LEFT JOIN Courses c ON c.CategoryId=g.CategoryId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Lessons l ON l.CourseId=c.CourseId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY g.Name;"}
{"question":"Give me students and list of course titles they are enrolled in","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT a.FullName, STRING_AGG(DISTINCT c.Title, N', ') AS CourseTitles FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId LEFT JOIN Courses c ON c.CourseId=e.CourseId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Fetch students who enrolled but have not attempted any quiz","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT);\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, QuizId INT);","answer":"SELECT a.FullName FROM Accounts a JOIN Enrollments e ON e.AccountId=a.AccountId LEFT JOIN Lessons l ON l.CourseId=e.CourseId LEFT JOIN Quizzes q ON q.LessonId=l.LessonId LEFT JOIN QuizAttempts qa ON qa.QuizId=q.QuizId AND qa.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName HAVING COUNT(qa.AttemptId)=0;"}
{"question":"Show courses with average student progress and student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT, ProgressPercent REAL);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"Get category name with total students across its courses","context":"CREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Courses (CourseId INT, CategoryId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT g.Name, COUNT(DISTINCT e.AccountId) AS TotalStudents FROM Categories g LEFT JOIN Courses c ON c.CategoryId=g.CategoryId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY g.Name;"}
{"question":"Export students with counts of quizzes attempted and average score","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, COUNT(qa.AttemptId) AS Attempts, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"List courses with instructor and student counts where course title contains basics","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT ci.AccountId) AS InstructorCount, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%basics%' GROUP BY c.Title;"}
{"question":"Display students with counts of enrolled courses completed courses and remaining courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);\nCREATE TABLE Courses (CourseId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Enrolled, SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS Completed, (SELECT COUNT(*) FROM Courses) - COUNT(DISTINCT e.CourseId) AS Remaining FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Return students with counts of enrollments and attempts for quick health check","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(DISTINCT e.EnrollmentId) AS Enrollments, COUNT(DISTINCT qa.AttemptId) AS Attempts FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Give me courses with instructor list and count for category that contains web","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200), CategoryId INT);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS InstructorNames, COUNT(ci.Id) AS InstructorCount FROM Courses c JOIN Categories g ON g.CategoryId=c.CategoryId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE g.Name LIKE N'%web%' GROUP BY c.Title;"}
{"question":"Fetch courses with student count where student names include Nguyen","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c JOIN Enrollments e ON e.CourseId=c.CourseId JOIN Accounts a ON a.AccountId=e.AccountId WHERE a.FullName LIKE N'%Nguyen%' GROUP BY c.Title;"}
{"question":"Show students sorted by number of completed courses then average score descending","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS CompletedCourses, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName ORDER BY CompletedCourses DESC, AvgScore DESC;"}
{"question":"Get students with zero completion rate but at least two enrollments","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName FROM Accounts a JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName HAVING COUNT(*)>=2 AND SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END)=0;"}
{"question":"Export courses with instructor and student counts for the current month enrollments only","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT, EnrolledOn DATETIME2);","answer":"SELECT c.Title, COUNT(DISTINCT ci.AccountId) AS InstructorCount, COUNT(DISTINCT CASE WHEN YEAR(e.EnrolledOn)=YEAR(SYSUTCDATETIME()) AND MONTH(e.EnrolledOn)=MONTH(SYSUTCDATETIME()) THEN e.AccountId END) AS CurrentMonthStudents FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"List courses with instructor count where instructor accounts have role Instructor","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, Role NVARCHAR(20));","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE a.Role=N'Instructor' GROUP BY c.Title;"}
{"question":"Display students with number of lessons encountered through their enrollments","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT);","answer":"SELECT a.FullName, COUNT(DISTINCT l.LessonId) AS LessonsSeen FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId LEFT JOIN Lessons l ON l.CourseId=e.CourseId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Return students with number of categories covered by their enrollments","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, CategoryId INT);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));","answer":"SELECT a.FullName, COUNT(DISTINCT g.Name) AS CategoriesCovered FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId LEFT JOIN Courses c ON c.CourseId=e.CourseId LEFT JOIN Categories g ON g.CategoryId=c.CategoryId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Give me courses with instructor list and student count where title contains sql","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, STRING_AGG(DISTINCT a.FullName, N', ') AS Instructors, COUNT(DISTINCT e.AccountId) AS Students FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%sql%' GROUP BY c.Title;"}
{"question":"Get all students, their total enrolled courses, total completed, and completion rate.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, COUNT(E.EnrollmentId), SUM(CASE WHEN E.IsCompleted = 1 THEN 1 ELSE 0 END), AVG(CAST(E.IsCompleted AS FLOAT)) FROM Accounts A LEFT JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName;"},
{"question":"Show all students and their average quiz score.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, AVG(CAST(QA.Score AS FLOAT)) FROM Accounts A LEFT JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName;"},
{"question":"List all students with their total enrollments and average progress percentage.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, COUNT(E.EnrollmentId), AVG(E.ProgressPercent) FROM Accounts A LEFT JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName;"},
{"question":"Get all students whose course completion rate is above 50 percent.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, AVG(CAST(E.IsCompleted AS FLOAT)) FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING AVG(CAST(E.IsCompleted AS FLOAT)) > 0.5;"},
{"question":"Find all students with a completion rate under 20 percent.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, AVG(CAST(E.IsCompleted AS FLOAT)) FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING AVG(CAST(E.IsCompleted AS FLOAT)) < 0.2;"},
{"question":"List all students with an average progress percentage below 50 percent.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, AVG(E.ProgressPercent) FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING AVG(E.ProgressPercent) < 0.5;"},
{"question":"Show all students who have completed all their enrolled courses.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING MIN(CAST(E.IsCompleted AS INT)) = 1;"},
{"question":"Get all students whose average quiz score is below 60.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, AVG(CAST(QA.Score AS FLOAT)) FROM Accounts A JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING AVG(CAST(QA.Score AS FLOAT)) < 60;"},
{"question":"Find all students with a perfect average score.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName FROM Accounts A JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING AVG(CAST(QA.Score AS FLOAT)) = 100;"},
{"question":"List all students, their total quiz attempts, and total correct answers.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, COUNT(QA.AttemptId), SUM(QA.CorrectAnswers) FROM Accounts A LEFT JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName;"},
{"question":"Get all instructors, their total courses, total published courses, and publish rate.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName, COUNT(C.CourseId), SUM(CASE WHEN C.IsPublished = 1 THEN 1 ELSE 0 END), AVG(CAST(C.IsPublished AS FLOAT)) FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId WHERE A.Role = N'Instructor' GROUP BY A.FullName;"},
{"question":"Show all instructors and the average rating of their courses.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT A.FullName, AVG(CAST(CR.Rating AS FLOAT)) FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId WHERE A.Role = N'Instructor' GROUP BY A.FullName;"},
{"question":"List all instructors whose average course rating is above 4.5.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT A.FullName, AVG(CAST(CR.Rating AS FLOAT)) FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING AVG(CAST(CR.Rating AS FLOAT)) > 4.5;"},
{"question":"Find all instructors with an average course rating below 2.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT A.FullName, AVG(CAST(CR.Rating AS FLOAT)) FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING AVG(CAST(CR.Rating AS FLOAT)) < 2;"},
{"question":"Get all instructors and the total number of enrollments across their courses.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, COUNT(E.EnrollmentId) FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN Enrollments E ON C.CourseId = E.CourseId WHERE A.Role = N'Instructor' GROUP BY A.FullName;"},
{"question":"List instructors who have zero unpublished courses.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING AVG(CAST(C.IsPublished AS FLOAT)) = 1;"},
{"question":"Show all instructors and the total price of all their courses.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName, SUM(C.Price) FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId WHERE A.Role = N'Instructor' GROUP BY A.FullName;"},
{"question":"Find instructors whose total course revenue (price) is over 1000.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName, SUM(C.Price) FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING SUM(C.Price) > 1000;"},
{"question":"Get all instructors and the total number of lessons in their courses.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName, COUNT(L.LessonId) FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN Lessons L ON C.CourseId = L.CourseId WHERE A.Role = N'Instructor' GROUP BY A.FullName;"},
{"question":"List instructors with an average of more than 10 lessons per course.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName, CAST(COUNT(L.LessonId) AS FLOAT) / COUNT(DISTINCT C.CourseId) FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN Lessons L ON C.CourseId = L.CourseId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING (CAST(COUNT(L.LessonId) AS FLOAT) / COUNT(DISTINCT C.CourseId)) > 10;"},
{"question":"Show all courses, their total enrollments, and their completion rate.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title, COUNT(E.EnrollmentId), AVG(CAST(E.IsCompleted AS FLOAT)) FROM Courses C LEFT JOIN Enrollments E ON C.CourseId = E.CourseId GROUP BY C.Title;"},
{"question":"List all courses and their average student progress percentage.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title, AVG(E.ProgressPercent) FROM Courses C LEFT JOIN Enrollments E ON C.CourseId = E.CourseId GROUP BY C.Title;"},
{"question":"Get all courses with a student completion rate below 10 percent.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title, AVG(CAST(E.IsCompleted AS FLOAT)) FROM Courses C LEFT JOIN Enrollments E ON C.CourseId = E.CourseId GROUP BY C.Title HAVING AVG(CAST(E.IsCompleted AS FLOAT)) < 0.1;"},
{"question":"Find all courses where the average student progress is over 80 percent.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title, AVG(E.ProgressPercent) FROM Courses C LEFT JOIN Enrollments E ON C.CourseId = E.CourseId GROUP BY C.Title HAVING AVG(E.ProgressPercent) > 0.8;"},
{"question":"Show all courses and their average quiz score.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT C.Title, AVG(CAST(QA.Score AS FLOAT)) FROM Courses C LEFT JOIN Lessons L ON C.CourseId = L.CourseId LEFT JOIN Quizzes Q ON L.LessonId = Q.LessonId LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY C.Title;"},
{"question":"List all courses where the average quiz score is above 90.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT C.Title, AVG(CAST(QA.Score AS FLOAT)) FROM Courses C LEFT JOIN Lessons L ON C.CourseId = L.CourseId LEFT JOIN Quizzes Q ON L.LessonId = Q.LessonId LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY C.Title HAVING AVG(CAST(QA.Score AS FLOAT)) > 90;"},
{"question":"Get all courses, their total reviews, and their 5-star review ratio.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title, COUNT(CR.ReviewId), AVG(CASE WHEN CR.Rating = 5 THEN 1.0 ELSE 0.0 END) FROM Courses C LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId GROUP BY C.Title;"},
{"question":"Find courses where the 1-star review ratio is higher than 25 percent.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title, AVG(CASE WHEN CR.Rating = 1 THEN 1.0 ELSE 0.0 END) FROM Courses C JOIN CourseReviews CR ON C.CourseId = CR.CourseId GROUP BY C.Title HAVING AVG(CASE WHEN CR.Rating = 1 THEN 1.0 ELSE 0.0 END) > 0.25;"},
{"question":"List all categories, the total courses in them, and the average course price.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT C.Name, COUNT(CO.CourseId), AVG(CO.Price) FROM Categories C LEFT JOIN Courses CO ON C.CategoryId = CO.CategoryId GROUP BY C.Name;"},
{"question":"Show categories with an average course price over 100.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT C.Name, AVG(CO.Price) FROM Categories C JOIN Courses CO ON C.CategoryId = CO.CategoryId GROUP BY C.Name HAVING AVG(CO.Price) > 100;"},
{"question":"Get all categories and the ratio of 'beginner' courses in them.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT C.Name, AVG(CASE WHEN CO.Difficulty = N'beginner' THEN 1.0 ELSE 0.0 END) FROM Categories C LEFT JOIN Courses CO ON C.CategoryId = CO.CategoryId GROUP BY C.Name;"},
{"question":"Find categories where 100 percent of courses are 'beginner'.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT C.Name FROM Categories C JOIN Courses CO ON C.CategoryId = CO.CategoryId GROUP BY C.Name HAVING AVG(CASE WHEN CO.Difficulty = N'beginner' THEN 1.0 ELSE 0.0 END) = 1;"},
{"question":"List all categories and the total number of enrollments they have.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Name, COUNT(E.EnrollmentId) FROM Categories C LEFT JOIN Courses CO ON C.CategoryId = CO.CategoryId LEFT JOIN Enrollments E ON CO.CourseId = E.CourseId GROUP BY C.Name;"},
{"question":"Show categories with more than 100 total enrollments.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Name, COUNT(E.EnrollmentId) FROM Categories C LEFT JOIN Courses CO ON C.CategoryId = CO.CategoryId LEFT JOIN Enrollments E ON CO.CourseId = E.CourseId GROUP BY C.Name HAVING COUNT(E.EnrollmentId) > 100;"},
{"question":"Get all categories and their average course completion rate.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Name, AVG(CAST(E.IsCompleted AS FLOAT)) FROM Categories C LEFT JOIN Courses CO ON C.CategoryId = CO.CategoryId LEFT JOIN Enrollments E ON CO.CourseId = E.CourseId GROUP BY C.Name;"},
{"question":"List all quizzes, their total attempts, and their average score.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Q.Title, COUNT(QA.AttemptId), AVG(CAST(QA.Score AS FLOAT)) FROM Quizzes Q LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY Q.Title;"},
{"question":"Show all quizzes and their pass rate (score >= 50).","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Q.Title, AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) FROM Quizzes Q LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY Q.Title;"},
{"question":"Get quizzes with a pass rate (score >= 50) below 25 percent.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Q.Title, AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) FROM Quizzes Q LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY Q.Title HAVING AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) < 0.25;"},
{"question":"Find quizzes where the average score is exactly 100.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Q.Title FROM Quizzes Q JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY Q.Title HAVING AVG(CAST(QA.Score AS FLOAT)) = 100;"},
{"question":"List all quizzes and the ratio of attempts that were submitted.","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Q.Title, AVG(CASE WHEN QA.SubmittedAt IS NOT NULL THEN 1.0 ELSE 0.0 END) FROM Quizzes Q LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY Q.Title;"},
{"question":"Show all students and their total number of completed enrollments.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, SUM(CASE WHEN E.IsCompleted = 1 THEN 1 ELSE 0 END) FROM Accounts A LEFT JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName;"},
{"question":"Get students who have completed more than 5 courses.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, SUM(CASE WHEN E.IsCompleted = 1 THEN 1 ELSE 0 END) FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING SUM(CASE WHEN E.IsCompleted = 1 THEN 1 ELSE 0 END) > 5;"},
{"question":"List students who have enrolled in courses but completed zero.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING SUM(CASE WHEN E.IsCompleted = 1 THEN 1 ELSE 0 END) = 0;"},
{"question":"Find all students whose average progress is exactly 1.0 (100 percent).","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING AVG(E.ProgressPercent) = 1;"},
{"question":"Show students with an average quiz score between 70 and 80.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, AVG(CAST(QA.Score AS FLOAT)) FROM Accounts A JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING AVG(CAST(QA.Score AS FLOAT)) BETWEEN 70 AND 80;"},
{"question":"Get the total count of 5-star reviews and 1-star reviews for each course.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title, SUM(CASE WHEN CR.Rating = 5 THEN 1 ELSE 0 END), SUM(CASE WHEN CR.Rating = 1 THEN 1 ELSE 0 END) FROM Courses C LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId GROUP BY C.Title;"},
{"question":"List courses where the number of 5-star reviews is greater than 1-star reviews.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title FROM Courses C JOIN CourseReviews CR ON C.CourseId = CR.CourseId GROUP BY C.Title HAVING SUM(CASE WHEN CR.Rating = 5 THEN 1 ELSE 0 END) > SUM(CASE WHEN CR.Rating = 1 THEN 1 ELSE 0 END);"},
{"question":"Show courses that have 5-star reviews but zero 1-star reviews.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title FROM Courses C JOIN CourseReviews CR ON C.CourseId = CR.CourseId GROUP BY C.Title HAVING SUM(CASE WHEN CR.Rating = 5 THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN CR.Rating = 1 THEN 1 ELSE 0 END) = 0;"},
{"question":"Get all instructors and the ratio of 'beginner' courses they teach.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName, AVG(CASE WHEN C.Difficulty = N'beginner' THEN 1.0 ELSE 0.0 END) FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId WHERE A.Role = N'Instructor' GROUP BY A.FullName;"},
{"question":"Find instructors who only teach 'advanced' courses.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING MIN(C.Difficulty) = N'advanced' AND MAX(C.Difficulty) = N'advanced';"},
{"question":"List instructors whose courses are all free.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING MAX(C.Price) = 0;"},
{"question":"Show instructors who teach courses where the average enrollment is over 50 students.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, CAST(COUNT(E.EnrollmentId) AS FLOAT) / COUNT(DISTINCT C.CourseId) FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN Enrollments E ON C.CourseId = E.CourseId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING (CAST(COUNT(E.EnrollmentId) AS FLOAT) / COUNT(DISTINCT C.CourseId)) > 50;"},
{"question":"Get all courses, their category name, and their instructor's name.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT C.Title, CAT.Name, A.FullName FROM Courses C LEFT JOIN Categories CAT ON C.CategoryId = CAT.CategoryId JOIN Accounts A ON C.InstructorId = A.AccountId;"},
{"question":"List all student enrollments, showing student name, course title, and progress.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, C.Title, E.ProgressPercent FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId JOIN Courses C ON E.CourseId = C.CourseId WHERE A.Role = N'Student';"},
{"question":"Show all quiz attempts, student name, course title, and score.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, C.Title, QA.Score FROM QuizAttempts QA JOIN Accounts A ON QA.AccountId = A.AccountId JOIN Quizzes Q ON QA.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId JOIN Courses C ON L.CourseId = C.CourseId;"},
{"question":"List all reviews, the reviewer's name, the course title, and the instructor's name.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT CR.Rating, A_Reviewer.FullName, C.Title, A_Instructor.FullName FROM CourseReviews CR JOIN Accounts A_Reviewer ON CR.AccountId = A_Reviewer.AccountId JOIN Courses C ON CR.CourseId = C.CourseId JOIN Accounts A_Instructor ON C.InstructorId = A_Instructor.AccountId;"},
{"question":"Show the ratio of video lessons to total lessons for each course.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT C.Title, AVG(CASE WHEN L.LessonType = N'video' THEN 1.0 ELSE 0.0 END) FROM Courses C LEFT JOIN Lessons L ON C.CourseId = L.CourseId GROUP BY C.Title;"},
{"question":"Find courses where all lessons are video lessons.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT C.Title FROM Courses C JOIN Lessons L ON C.CourseId = L.CourseId GROUP BY C.Title HAVING MIN(L.LessonType) = N'video' AND MAX(L.LessonType) = N'video';"},
{"question":"List courses where the ratio of quiz lessons is above 50 percent.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT C.Title, AVG(CASE WHEN L.LessonType = N'quiz' THEN 1.0 ELSE 0.0 END) FROM Courses C JOIN Lessons L ON C.CourseId = L.CourseId GROUP BY C.Title HAVING AVG(CASE WHEN L.LessonType = N'quiz' THEN 1.0 ELSE 0.0 END) > 0.5;"},
{"question":"Show the total number of enrollments and average progress for 'beginner' courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(E.EnrollmentId), AVG(E.ProgressPercent) FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Difficulty = N'beginner';"},
{"question":"Calculate the total enrollments and completion rate for 'advanced' courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(E.EnrollmentId), AVG(CAST(E.IsCompleted AS FLOAT)) FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Difficulty = N'advanced';"},
{"question":"What is the total revenue (sum of price) from completed enrollments?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE E.IsCompleted = 1;"},
{"question":"Get the total revenue (sum of price) from enrollments by active students.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT SUM(C.Price) FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId JOIN Accounts A ON E.AccountId = A.AccountId WHERE A.IsActive = 1 AND A.Role = N'Student';"},
{"question":"Show the total number of quiz attempts and average score for 'beginner' courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(QA.AttemptId), AVG(CAST(QA.Score AS FLOAT)) FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId JOIN Courses C ON L.CourseId = C.CourseId WHERE C.Difficulty = N'beginner';"},
{"question":"Calculate the total attempts and average score for courses in 'Programming' category.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(QA.AttemptId), AVG(CAST(QA.Score AS FLOAT)) FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId JOIN Courses C ON L.CourseId = C.CourseId JOIN Categories CAT ON C.CategoryId = CAT.CategoryId WHERE CAT.Name = N'Programming';"},
{"question":"What is the ratio of correct answers to total questions for each student?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, CAST(SUM(QA.CorrectAnswers) AS FLOAT) / SUM(QA.TotalQuestions) FROM Accounts A LEFT JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' AND QA.TotalQuestions > 0 GROUP BY A.FullName;"},
{"question":"Find students whose overall quiz accuracy (correct/total questions) is below 50 percent.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, CAST(SUM(QA.CorrectAnswers) AS FLOAT) / SUM(QA.TotalQuestions) FROM Accounts A JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' AND QA.TotalQuestions > 0 GROUP BY A.FullName HAVING (CAST(SUM(QA.CorrectAnswers) AS FLOAT) / SUM(QA.TotalQuestions)) < 0.5;"},
{"question":"List all courses and the ratio of enrollments that are completed.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title, AVG(CAST(E.IsCompleted AS FLOAT)) FROM Courses C LEFT JOIN Enrollments E ON C.CourseId = E.CourseId GROUP BY C.Title;"},
{"question":"Show courses where 100 percent of enrollments are completed.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title FROM Courses C JOIN Enrollments E ON C.CourseId = E.CourseId GROUP BY C.Title HAVING MIN(CAST(E.IsCompleted AS INT)) = 1;"},
{"question":"Get the total number of students and total number of instructors.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT Role, COUNT(AccountId) FROM Accounts WHERE Role IN (N'Student', N'Instructor') GROUP BY Role;"},
{"question":"What is the ratio of active students to total students?","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(IsActive AS FLOAT)) FROM Accounts WHERE Role = N'Student';"},
{"question":"Calculate the ratio of active instructors to total instructors.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(IsActive AS FLOAT)) FROM Accounts WHERE Role = N'Instructor';"},
{"question":"How many courses have 100 percent completion rate but an average score below 60?","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT C.Title FROM Courses C JOIN Enrollments E ON C.CourseId = E.CourseId LEFT JOIN Lessons L ON C.CourseId = L.CourseId LEFT JOIN Quizzes Q ON L.LessonId = Q.LessonId LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY C.Title HAVING MIN(CAST(E.IsCompleted AS INT)) = 1 AND AVG(CAST(QA.Score AS FLOAT)) < 60;"},
{"question":"Get the count of enrollments for each difficulty level.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Difficulty, COUNT(E.EnrollmentId) FROM Courses C LEFT JOIN Enrollments E ON C.CourseId = E.CourseId GROUP BY C.Difficulty;"},
{"question":"List the average rating for courses grouped by difficulty.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Difficulty, AVG(CAST(CR.Rating AS FLOAT)) FROM Courses C LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId GROUP BY C.Difficulty;"},
{"question":"Show the pass rate (score >= 50) for quizzes grouped by course difficulty.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT C.Difficulty, AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId JOIN Courses C ON L.CourseId = C.CourseId GROUP BY C.Difficulty;"},
{"question":"Find the ratio of 'video' lessons for all courses taught by 'Instructor Jane'.","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN L.LessonType = N'video' THEN 1.0 ELSE 0.0 END) FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.FullName = N'Instructor Jane';"},
{"question":"Get the total number of quiz questions made by instructors in the 'Programming' category.","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT COUNT(QQ.QuestionId) FROM QuizQuestions QQ JOIN Quizzes Q ON QQ.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId JOIN Courses C ON L.CourseId = C.CourseId JOIN Categories CAT ON C.CategoryId = CAT.CategoryId WHERE CAT.Name = N'Programming';"},
{"question":"List students who have enrolled in courses but have not taken any quizzes.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT DISTINCT A.FullName FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId LEFT JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' AND QA.AttemptId IS NULL;"},
{"question":"Show students who have a 100 percent completion rate and an average score over 90.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING MIN(CAST(E.IsCompleted AS INT)) = 1 AND AVG(CAST(QA.Score AS FLOAT)) > 90;"},
{"question":"Get the ratio of 5-star reviews to 1-star reviews for each course.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title, CAST(SUM(CASE WHEN CR.Rating = 5 THEN 1 ELSE 0 END) AS FLOAT) / SUM(CASE WHEN CR.Rating = 1 THEN 1 ELSE 0 END) FROM Courses C LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId WHERE CR.Rating IN (1, 5) GROUP BY C.Title;"},
{"question":"List all courses and the percentage of lessons that are quizzes.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT C.Title, AVG(CASE WHEN L.LessonType = N'quiz' THEN 1.0 ELSE 0.0 END) * 100 FROM Courses C LEFT JOIN Lessons L ON C.CourseId = L.CourseId GROUP BY C.Title;"},
{"question":"Find courses where over 20 percent of lessons are quizzes.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT C.Title, AVG(CASE WHEN L.LessonType = N'quiz' THEN 1.0 ELSE 0.0 END) FROM Courses C JOIN Lessons L ON C.CourseId = L.CourseId GROUP BY C.Title HAVING AVG(CASE WHEN L.LessonType = N'quiz' THEN 1.0 ELSE 0.0 END) > 0.2;"},
{"question":"Calculate the average quiz pass rate (score >= 50) for each instructor's courses.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN Lessons L ON C.CourseId = L.CourseId LEFT JOIN Quizzes Q ON L.LessonId = Q.LessonId LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId WHERE A.Role = N'Instructor' GROUP BY A.FullName;"},
{"question":"Find instructors whose courses have a quiz pass rate (score >= 50) lower than 40 percent.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN Lessons L ON C.CourseId = L.CourseId LEFT JOIN Quizzes Q ON L.LessonId = Q.LessonId LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) < 0.4;"},
{"question":"Get the total enrollments and total revenue (sum of price) for each course.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title, COUNT(E.EnrollmentId), SUM(C.Price) FROM Courses C LEFT JOIN Enrollments E ON C.CourseId = E.CourseId GROUP BY C.Title;"},
{"question":"List courses where the total revenue (sum of price from enrollments) exceeds 500.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title, SUM(C.Price) FROM Courses C JOIN Enrollments E ON C.CourseId = E.CourseId GROUP BY C.Title HAVING SUM(C.Price) > 500;"},
{"question":"Show the average enrollment progress for active students in 'beginner' courses.","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT AVG(E.ProgressPercent) FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId JOIN Accounts A ON E.AccountId = A.AccountId WHERE C.Difficulty = N'beginner' AND A.IsActive = 1 AND A.Role = N'Student';"},
{"question":"Calculate the percentage of students that are active.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(IsActive AS FLOAT)) * 100 FROM Accounts WHERE Role = N'Student';"},
{"question":"Find the percentage of courses that are published.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(IsPublished AS FLOAT)) * 100 FROM Courses;"},
{"question":"Get the ratio of courses that are free.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN Price = 0 THEN 1.0 ELSE 0.0 END) FROM Courses;"},
{"question":"What percentage of lessons are 'video' type?","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN LessonType = N'video' THEN 1.0 ELSE 0.0 END) * 100 FROM Lessons;"},
{"question":"Calculate the overall quiz pass rate (score >= 50).","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CASE WHEN Score >= 50 THEN 1.0 ELSE 0.0 END) FROM QuizAttempts WHERE SubmittedAt IS NOT NULL;"},
{"question":"What is the overall course completion rate?","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT AVG(CAST(IsCompleted AS FLOAT)) FROM Enrollments;"},
{"question":"Get the percentage of reviews that are 5-star.","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN Rating = 5 THEN 1.0 ELSE 0.0 END) * 100 FROM CourseReviews;"},
{"question":"Find the ratio of 'Lead' instructors in the CourseInstructors table.","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR(20));","answer":"SELECT AVG(CASE WHEN RoleInCourse = N'Lead' THEN 1.0 ELSE 0.0 END) FROM CourseInstructors;"},
{"question":"List students who have an average score (from attempts) but zero completed courses.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName FROM Accounts A LEFT JOIN Enrollments E ON A.AccountId = E.AccountId LEFT JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING COUNT(QA.AttemptId) > 0 AND SUM(CASE WHEN E.IsCompleted = 1 THEN 1 ELSE 0 END) = 0;"},
{"question":"Show instructors who teach 'beginner' courses and have an average rating above 4.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT A.FullName, AVG(CAST(CR.Rating AS FLOAT)) FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId WHERE A.Role = N'Instructor' AND C.Difficulty = N'beginner' GROUP BY A.FullName HAVING AVG(CAST(CR.Rating AS FLOAT)) > 4;"},
{"question":"Get the ratio of courses that are published for each category.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT C.Name, AVG(CAST(CO.IsPublished AS FLOAT)) FROM Categories C LEFT JOIN Courses CO ON C.CategoryId = CO.CategoryId GROUP BY C.Name;"},
{"question":"Find categories where the course publish rate is 100 percent.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT C.Name FROM Categories C JOIN Courses CO ON C.CategoryId = CO.CategoryId GROUP BY C.Name HAVING AVG(CAST(CO.IsPublished AS FLOAT)) = 1;"},
{"question":"List the average number of lessons per course for each category.","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT CAT.Name, CAST(COUNT(L.LessonId) AS FLOAT) / COUNT(DISTINCT C.CourseId) FROM Categories CAT LEFT JOIN Courses C ON CAT.CategoryId = C.CategoryId LEFT JOIN Lessons L ON C.CourseId = L.CourseId GROUP BY CAT.Name;"},
{"question":"Show the total number of quiz questions and total quiz attempts for each course.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);","answer":"SELECT C.Title, COUNT(DISTINCT QQ.QuestionId), COUNT(QA.AttemptId) FROM Courses C LEFT JOIN Lessons L ON C.CourseId = L.CourseId LEFT JOIN Quizzes Q ON L.LessonId = Q.LessonId LEFT JOIN QuizQuestions QQ ON Q.QuizId = QQ.QuizId LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY C.Title;"},
{"question":"Find the total revenue (enrollment price) for 'beginner' courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Difficulty = N'beginner';"},
{"question":"List students who have enrolled in more than 3 courses and have an average score below 50.","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING COUNT(DISTINCT E.CourseId) > 3 AND AVG(CAST(QA.Score AS FLOAT)) < 50;"},
{"question":"Get the average rating for courses that are 100 percent completed by all students.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title, AVG(CAST(CR.Rating AS FLOAT)) FROM Courses C JOIN Enrollments E ON C.CourseId = E.CourseId LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId GROUP BY C.Title HAVING MIN(CAST(E.IsCompleted AS INT)) = 1;"},
{"question":"Show the ratio of 5-star reviews to total reviews for 'advanced' courses.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN CR.Rating = 5 THEN 1.0 ELSE 0.0 END) FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId WHERE C.Difficulty = N'advanced';"},
{"question":"List all courses, their total lessons, and the ratio of 'text' lessons.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT C.Title, COUNT(L.LessonId), AVG(CASE WHEN L.LessonType = N'text' THEN 1.0 ELSE 0.0 END) FROM Courses C LEFT JOIN Lessons L ON C.CourseId = L.CourseId GROUP BY C.Title;"},
{"question":"Find courses where 0 percent of lessons are text lessons.","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT C.Title FROM Courses C JOIN Lessons L ON C.CourseId = L.CourseId GROUP BY C.Title HAVING AVG(CASE WHEN L.LessonType = N'text' THEN 1.0 ELSE 0.0 END) = 0;"}
{"question":"Show all students and their total enrolled courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, COUNT(E.CourseId) FROM Accounts A LEFT JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName;"},
{"question":"List all students and their total completed courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, SUM(CASE WHEN E.IsCompleted = 1 THEN 1 ELSE 0 END) FROM Accounts A LEFT JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName;"},
{"question":"Get all students and their course completion rate","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, AVG(CAST(E.IsCompleted AS FLOAT)) FROM Accounts A LEFT JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName;"},
{"question":"Find all students with a course completion rate over 50 percent","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING AVG(CAST(E.IsCompleted AS FLOAT)) > 0.5;"},
{"question":"Show all students and their average enrollment progress","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, AVG(E.ProgressPercent) FROM Accounts A LEFT JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName;"},
{"question":"Get students with an average progress percentage below 30","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING AVG(E.ProgressPercent) < 0.3;"},
{"question":"List all students and their total number of quiz attempts","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, COUNT(QA.AttemptId) FROM Accounts A LEFT JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName;"},
{"question":"Show all students and their average quiz score","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, AVG(CAST(QA.Score AS FLOAT)) FROM Accounts A LEFT JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName;"},
{"question":"Find students whose average quiz score is higher than 90","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName FROM Accounts A JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING AVG(CAST(QA.Score AS FLOAT)) > 90;"},
{"question":"Get students with an average quiz score below 50","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName FROM Accounts A JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING AVG(CAST(QA.Score AS FLOAT)) < 50;"},
{"question":"List students and their quiz accuracy ratio","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, CAST(SUM(QA.CorrectAnswers) AS FLOAT) / SUM(QA.TotalQuestions) FROM Accounts A LEFT JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' AND QA.TotalQuestions > 0 GROUP BY A.FullName;"},
{"question":"Find students with quiz accuracy over 80 percent","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName FROM Accounts A JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' AND QA.TotalQuestions > 0 GROUP BY A.FullName HAVING (CAST(SUM(QA.CorrectAnswers) AS FLOAT) / SUM(QA.TotalQuestions)) > 0.8;"},
{"question":"Get students with quiz accuracy under 40 percent","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName FROM Accounts A JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' AND QA.TotalQuestions > 0 GROUP BY A.FullName HAVING (CAST(SUM(QA.CorrectAnswers) AS FLOAT) / SUM(QA.TotalQuestions)) < 0.4;"},
{"question":"Show all instructors and their total number of courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName, COUNT(C.CourseId) FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId WHERE A.Role = N'Instructor' GROUP BY A.FullName;"},
{"question":"List all instructors and their course publish rate","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName, AVG(CAST(C.IsPublished AS FLOAT)) FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId WHERE A.Role = N'Instructor' GROUP BY A.FullName;"},
{"question":"Get instructors whose course publish rate is 100 percent","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING AVG(CAST(C.IsPublished AS FLOAT)) = 1;"},
{"question":"Find instructors with a course publish rate under 30 percent","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING AVG(CAST(C.IsPublished AS FLOAT)) < 0.3;"},
{"question":"Get instructors whose average course rating is above 4.5","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT A.FullName FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING AVG(CAST(CR.Rating AS FLOAT)) > 4.5;"},
{"question":"Find instructors with an average course rating below 3","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT A.FullName FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING AVG(CAST(CR.Rating AS FLOAT)) < 3;"},
{"question":"List all instructors and the total number of students in their courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, COUNT(DISTINCT E.AccountId) FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN Enrollments E ON C.CourseId = E.CourseId WHERE A.Role = N'Instructor' GROUP BY A.FullName;"},
{"question":"Get instructors with more than 100 total student enrollments","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN Enrollments E ON C.CourseId = E.CourseId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING COUNT(E.EnrollmentId) > 100;"},
{"question":"Show instructors and the average completion rate of their courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, AVG(CAST(E.IsCompleted AS FLOAT)) FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN Enrollments E ON C.CourseId = E.CourseId WHERE A.Role = N'Instructor' GROUP BY A.FullName;"},
{"question":"Find instructors whose courses have an average completion rate over 60 percent","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN Enrollments E ON C.CourseId = E.CourseId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING AVG(CAST(E.IsCompleted AS FLOAT)) > 0.6;"},
{"question":"List all courses and their total student enrollments","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title, COUNT(E.EnrollmentId) FROM Courses C LEFT JOIN Enrollments E ON C.CourseId = E.CourseId GROUP BY C.Title;"},
{"question":"Show all courses and their enrollment completion rate","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title, AVG(CAST(E.IsCompleted AS FLOAT)) FROM Courses C LEFT JOIN Enrollments E ON C.CourseId = E.CourseId GROUP BY C.Title;"},
{"question":"Get courses with a completion rate higher than 70 percent","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title FROM Courses C JOIN Enrollments E ON C.CourseId = E.CourseId GROUP BY C.Title HAVING AVG(CAST(E.IsCompleted AS FLOAT)) > 0.7;"},
{"question":"Find courses with a completion rate lower than 10 percent","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title FROM Courses C JOIN Enrollments E ON C.CourseId = E.CourseId GROUP BY C.Title HAVING AVG(CAST(E.IsCompleted AS FLOAT)) < 0.1;"},
{"question":"List all courses and their average student progress","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title, AVG(E.ProgressPercent) FROM Courses C LEFT JOIN Enrollments E ON C.CourseId = E.CourseId GROUP BY C.Title;"},
{"question":"Get courses where average student progress is below 25 percent","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title FROM Courses C JOIN Enrollments E ON C.CourseId = E.CourseId GROUP BY C.Title HAVING AVG(E.ProgressPercent) < 0.25;"},
{"question":"Show all courses and their average quiz score across all attempts","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT C.Title, AVG(CAST(QA.Score AS FLOAT)) FROM Courses C LEFT JOIN Lessons L ON C.CourseId = L.CourseId LEFT JOIN Quizzes Q ON L.LessonId = Q.LessonId LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY C.Title;"},
{"question":"Find courses where the average quiz score is below 50","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT C.Title FROM Courses C LEFT JOIN Lessons L ON C.CourseId = L.CourseId LEFT JOIN Quizzes Q ON L.LessonId = Q.LessonId LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY C.Title HAVING AVG(CAST(QA.Score AS FLOAT)) < 50;"},
{"question":"List all courses and their 5-star review percentage","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title, AVG(CASE WHEN CR.Rating = 5 THEN 1.0 ELSE 0.0 END) * 100 FROM Courses C LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId GROUP BY C.Title;"},
{"question":"Get courses where the 5-star review percentage is over 50","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title FROM Courses C JOIN CourseReviews CR ON C.CourseId = CR.CourseId GROUP BY C.Title HAVING AVG(CASE WHEN CR.Rating = 5 THEN 1.0 ELSE 0.0 END) > 0.5;"},
{"question":"Find courses where the 1-star review percentage is over 10","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title FROM Courses C JOIN CourseReviews CR ON C.CourseId = CR.CourseId GROUP BY C.Title HAVING AVG(CASE WHEN CR.Rating = 1 THEN 1.0 ELSE 0.0 END) > 0.1;"},
{"question":"Show all categories and their average course price","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT C.Name, AVG(CO.Price) FROM Categories C LEFT JOIN Courses CO ON C.CategoryId = CO.CategoryId GROUP BY C.Name;"},
{"question":"List categories with an average course price higher than 50","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT C.Name FROM Categories C JOIN Courses CO ON C.CategoryId = CO.CategoryId GROUP BY C.Name HAVING AVG(CO.Price) > 50;"},
{"question":"Get all categories and the percentage of beginner courses in them","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT C.Name, AVG(CASE WHEN CO.Difficulty = N'beginner' THEN 1.0 ELSE 0.0 END) * 100 FROM Categories C LEFT JOIN Courses CO ON C.CategoryId = CO.CategoryId GROUP BY C.Name;"},
{"question":"Find categories that have zero advanced courses","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT C.Name FROM Categories C LEFT JOIN Courses CO ON C.CategoryId = CO.CategoryId GROUP BY C.Name HAVING MAX(CASE WHEN CO.Difficulty = N'advanced' THEN 1 ELSE 0 END) = 0;"},
{"question":"Show all categories and the total number of student enrollments","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Name, COUNT(E.EnrollmentId) FROM Categories C LEFT JOIN Courses CO ON C.CategoryId = CO.CategoryId LEFT JOIN Enrollments E ON CO.CourseId = E.CourseId GROUP BY C.Name;"},
{"question":"Get categories with fewer than 10 total enrollments","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Name FROM Categories C LEFT JOIN Courses CO ON C.CategoryId = CO.CategoryId LEFT JOIN Enrollments E ON CO.CourseId = E.CourseId GROUP BY C.Name HAVING COUNT(E.EnrollmentId) < 10;"},
{"question":"List all categories and the average enrollment completion rate","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Name, AVG(CAST(E.IsCompleted AS FLOAT)) FROM Categories C LEFT JOIN Courses CO ON C.CategoryId = CO.CategoryId LEFT JOIN Enrollments E ON CO.CourseId = E.CourseId GROUP BY C.Name;"},
{"question":"Find all quizzes and their average student score","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Q.Title, AVG(CAST(QA.Score AS FLOAT)) FROM Quizzes Q LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY Q.Title;"},
{"question":"Show all quizzes and their pass rate using a 60 score threshold","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Q.Title, AVG(CASE WHEN QA.Score >= 60 THEN 1.0 ELSE 0.0 END) FROM Quizzes Q LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY Q.Title;"},
{"question":"Get quizzes with a pass rate below 30 percent assuming 50 is passing","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Q.Title FROM Quizzes Q LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY Q.Title HAVING AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) < 0.3;"},
{"question":"Find quizzes where the average score is over 80","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Q.Title FROM Quizzes Q LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY Q.Title HAVING AVG(CAST(QA.Score AS FLOAT)) > 80;"},
{"question":"List all quizzes and the percentage of attempts that were submitted","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Q.Title, AVG(CASE WHEN QA.SubmittedAt IS NOT NULL THEN 1.0 ELSE 0.0 END) * 100 FROM Quizzes Q LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY Q.Title;"},
{"question":"Show all students and their total enrollments","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, COUNT(E.EnrollmentId) FROM Accounts A LEFT JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName;"},
{"question":"Get students who enrolled in more than 5 courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING COUNT(E.EnrollmentId) > 5;"},
{"question":"List students who have completed fewer than 2 courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName FROM Accounts A LEFT JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING SUM(CASE WHEN E.IsCompleted = 1 THEN 1 ELSE 0 END) < 2;"},
{"question":"Find all students whose average progress is exactly 100 percent","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING AVG(E.ProgressPercent) = 1;"},
{"question":"Show students with an average quiz score between 80 and 90","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName FROM Accounts A JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING AVG(CAST(QA.Score AS FLOAT)) BETWEEN 80 AND 90;"},
{"question":"Get the count of 5-star reviews and 1-star reviews for each instructor","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT A.FullName, SUM(CASE WHEN CR.Rating = 5 THEN 1 ELSE 0 END), SUM(CASE WHEN CR.Rating = 1 THEN 1 ELSE 0 END) FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId WHERE A.Role = N'Instructor' GROUP BY A.FullName;"},
{"question":"List instructors who have more 5-star reviews than 1-star reviews","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT A.FullName FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId JOIN CourseReviews CR ON C.CourseId = CR.CourseId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING SUM(CASE WHEN CR.Rating = 5 THEN 1 ELSE 0 END) > SUM(CASE WHEN CR.Rating = 1 THEN 1 ELSE 0 END);"},
{"question":"Show instructors who have 5-star reviews and zero 1-star reviews","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT A.FullName FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId JOIN CourseReviews CR ON C.CourseId = CR.CourseId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING SUM(CASE WHEN CR.Rating = 5 THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN CR.Rating = 1 THEN 1 ELSE 0 END) = 0;"},
{"question":"Get all instructors and the ratio of advanced courses they teach","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName, AVG(CASE WHEN C.Difficulty = N'advanced' THEN 1.0 ELSE 0.0 END) FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId WHERE A.Role = N'Instructor' GROUP BY A.FullName;"},
{"question":"Find instructors who only teach beginner courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING MAX(C.Difficulty) = N'beginner' AND MIN(C.Difficulty) = N'beginner';"},
{"question":"List instructors whose courses are all published","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING MIN(CAST(C.IsPublished AS INT)) = 1;"},
{"question":"List all courses with number of instructors and number of students","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT ci.AccountId) AS InstructorCount, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"Show course title and student count for each course","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"Export courses with instructor count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"List all courses in the Data Science category with student count and instructor names","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200), CategoryId INT);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount, STRING_AGG(a.FullName, N', ') AS Instructors FROM Courses c JOIN Categories g ON g.CategoryId=c.CategoryId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE g.Name=N'Data Science' GROUP BY c.Title;"}
{"question":"Show all students with number of courses joined and number of courses completed","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS JoinedCourses, SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS CompletedCourses FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Find students who have not joined any course","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND e.EnrollmentId IS NULL GROUP BY a.FullName;"}
{"question":"List students who have no completed courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName HAVING SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END)=0;"}
{"question":"Show students whose completion rate is under fifty percent among joined courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRate FROM Accounts a JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName HAVING COUNT(e.EnrollmentId)>0 AND CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) < 0.5;"}
{"question":"Give me students whose participation rate is under fifty percent against total courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT);","answer":"SELECT a.FullName, CAST(COUNT(DISTINCT e.CourseId) AS DECIMAL(10,2))/NULLIF((SELECT COUNT(*) FROM Courses),0) AS ParticipationRate FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName HAVING CAST(COUNT(DISTINCT e.CourseId) AS DECIMAL(10,2))/NULLIF((SELECT COUNT(*) FROM Courses),0) < 0.5;"}
{"question":"List courses with category name and student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200), CategoryId INT);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, g.Name AS CategoryName, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c JOIN Categories g ON g.CategoryId=c.CategoryId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title, g.Name;"}
{"question":"Show courses that have no instructors and no students","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title HAVING COUNT(ci.Id)=0 AND COUNT(e.EnrollmentId)=0;"}
{"question":"Get top five courses by student count with instructor count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT TOP(5) c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount, COUNT(DISTINCT ci.AccountId) AS InstructorCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId GROUP BY c.Title ORDER BY StudentCount DESC;"}
{"question":"List courses with lesson count instructor count and student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT l.LessonId) AS LessonCount, COUNT(DISTINCT ci.AccountId) AS InstructorCount, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Lessons l ON l.CourseId=c.CourseId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"Show categories with total students across courses","context":"CREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Courses (CourseId INT, CategoryId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT g.Name, COUNT(DISTINCT e.AccountId) AS TotalStudents FROM Categories g LEFT JOIN Courses c ON c.CategoryId=g.CategoryId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY g.Name;"}
{"question":"Export students with average quiz score","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AverageScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"List students with joined count and completion rate","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS JoinedCount, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRate FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Find students who joined at least one course but have no quiz attempts","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT a.FullName FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName HAVING COUNT(e.EnrollmentId)>0 AND COUNT(qa.AttemptId)=0;"}
{"question":"Show courses whose title contains data with instructor and student counts","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT ci.AccountId) AS InstructorCount, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%data%' GROUP BY c.Title;"}
{"question":"List categories with course count instructor count lesson count and student count","context":"CREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR(200), CategoryId INT);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT g.Name AS CategoryName, COUNT(DISTINCT c.CourseId) AS Courses, COUNT(DISTINCT ci.AccountId) AS Instructors, COUNT(DISTINCT l.LessonId) AS Lessons, COUNT(DISTINCT e.AccountId) AS Students FROM Categories g LEFT JOIN Courses c ON c.CategoryId=g.CategoryId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Lessons l ON l.CourseId=c.CourseId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY g.Name;"}
{"question":"Show the student with the highest number of completed courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT TOP 1 a.FullName, SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS Completed FROM Accounts a JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName ORDER BY Completed DESC;"}
{"question":"Export courses with completion ratio per course","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT c.Title, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"List courses in the Web Development category with student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200), CategoryId INT);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c JOIN Categories g ON g.CategoryId=c.CategoryId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE g.Name=N'Web Development' GROUP BY c.Title;"}
{"question":"Show all students with attempts count and average score","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, COUNT(qa.AttemptId) AS Attempts, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"List courses with instructor names in a single column","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS InstructorNames FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId GROUP BY c.Title;"}
{"question":"Show courses created this month with student count and instructor names","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200), CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount, STRING_AGG(a.FullName, N', ') AS Instructors FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE YEAR(c.CreatedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(c.CreatedAt)=MONTH(SYSUTCDATETIME()) GROUP BY c.Title;"}
{"question":"Get students with number of lessons encountered across their courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT);","answer":"SELECT a.FullName, COUNT(DISTINCT l.LessonId) AS LessonsSeen FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId LEFT JOIN Lessons l ON l.CourseId=e.CourseId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Show courses with number of quiz questions per course","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT);\nCREATE TABLE QuizQuestions (QuestionId INT, QuizId INT);","answer":"SELECT c.Title, COUNT(qq.QuestionId) AS QuestionCount FROM Courses c LEFT JOIN Lessons l ON l.CourseId=c.CourseId LEFT JOIN Quizzes q ON q.LessonId=l.LessonId LEFT JOIN QuizQuestions qq ON qq.QuizId=q.QuizId GROUP BY c.Title;"}
{"question":"List courses with at least ten students and include instructor names","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount, STRING_AGG(a.FullName, N', ') AS Instructors FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId GROUP BY c.Title HAVING COUNT(DISTINCT e.AccountId) >= 10;"}
{"question":"Export students with categories covered by their enrollments","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, CategoryId INT);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));","answer":"SELECT a.FullName, COUNT(DISTINCT g.Name) AS CategoriesCovered FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId LEFT JOIN Courses c ON c.CourseId=e.CourseId LEFT JOIN Categories g ON g.CategoryId=c.CategoryId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Show courses with average student progress and student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT, ProgressPercent REAL);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"List categories with number of courses instructors lessons and students","context":"CREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR(200), CategoryId INT);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT g.Name AS CategoryName, COUNT(DISTINCT c.CourseId) AS Courses, COUNT(DISTINCT ci.AccountId) AS Instructors, COUNT(DISTINCT l.LessonId) AS Lessons, COUNT(DISTINCT e.AccountId) AS Students FROM Categories g LEFT JOIN Courses c ON c.CategoryId=g.CategoryId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Lessons l ON l.CourseId=c.CourseId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY g.Name;"}
{"question":"Show students with number of enrollments and number of attempts","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(DISTINCT e.EnrollmentId) AS Enrollments, COUNT(DISTINCT qa.AttemptId) AS Attempts FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Get courses with instructor names and student count for quick overview","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, STRING_AGG(DISTINCT a.FullName, N', ') AS InstructorNames, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"Show courses with student count where course title contains sql","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%sql%' GROUP BY c.Title;"}
{"question":"List students with joined courses completed courses and average score","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS JoinedCourses, SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS CompletedCourses, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Export courses with current month student count and instructor count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT, EnrolledOn DATETIME2);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT CASE WHEN YEAR(e.EnrolledOn)=YEAR(SYSUTCDATETIME()) AND MONTH(e.EnrolledOn)=MONTH(SYSUTCDATETIME()) THEN e.AccountId END) AS CurrentMonthStudents, COUNT(DISTINCT ci.AccountId) AS InstructorCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"Show students with zero completion but at least two enrollments","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName FROM Accounts a JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName HAVING COUNT(*)>=2 AND SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END)=0;"}
{"question":"List courses with student count and average attempt score across their quizzes","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, Score INT);","answer":"SELECT c.Title, COUNT(DISTINCT qa.AccountId) AS StudentsAttempted, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Courses c JOIN Lessons l ON l.CourseId=c.CourseId JOIN Quizzes q ON q.LessonId=l.LessonId LEFT JOIN QuizAttempts qa ON qa.QuizId=q.QuizId GROUP BY c.Title;"}
{"question":"Show students and a comma list of course titles they joined","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT a.FullName, STRING_AGG(DISTINCT c.Title, N', ') AS CourseTitles FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId LEFT JOIN Courses c ON c.CourseId=e.CourseId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Return courses with instructor count where instructors have role Instructor","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, Role NVARCHAR(20));","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE a.Role=N'Instructor' GROUP BY c.Title;"}
{"question":"Show students with participation and completion counts in one row","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined, SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS Completed FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"List courses with student count where title contains cloud","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%cloud%' GROUP BY c.Title;"}
{"question":"Show categories with course count instructor count and student count","context":"CREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Courses (CourseId INT, CategoryId INT);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT g.Name, COUNT(DISTINCT c.CourseId) AS CourseCount, COUNT(DISTINCT ci.AccountId) AS InstructorCount, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Categories g LEFT JOIN Courses c ON c.CategoryId=g.CategoryId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY g.Name;"}
{"question":"Show all students, their total enrolled courses, total completed, and completion rate","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, COUNT(E.EnrollmentId) AS TotalEnrollments, SUM(CASE WHEN E.IsCompleted = 1 THEN 1 ELSE 0 END) AS TotalCompleted, AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Accounts A LEFT JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName;"},
{"question":"List all students and their average quiz score","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, AVG(CAST(QA.Score AS FLOAT)) AS AverageScore FROM Accounts A LEFT JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName;"},
{"question":"Get all students, their total enrollments, and average progress percentage","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, COUNT(E.EnrollmentId) AS TotalEnrollments, AVG(E.ProgressPercent) AS AverageProgress FROM Accounts A LEFT JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName;"},
{"question":"Find students whose course completion rate is above 50 percent","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING AVG(CAST(E.IsCompleted AS FLOAT)) > 0.5;"},
{"question":"List students with a course completion rate under 20 percent","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING AVG(CAST(E.IsCompleted AS FLOAT)) < 0.2;"},
{"question":"Show students with an average progress percentage below 50","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, AVG(E.ProgressPercent) AS AverageProgress FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING AVG(E.ProgressPercent) < 0.5;"},
{"question":"Get students who have completed all their enrolled courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING MIN(CAST(E.IsCompleted AS INT)) = 1;"},
{"question":"List students whose average quiz score is below 60","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, AVG(CAST(QA.Score AS FLOAT)) AS AverageScore FROM Accounts A JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING AVG(CAST(QA.Score AS FLOAT)) < 60;"},
{"question":"Find students with a perfect average quiz score","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName FROM Accounts A JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING AVG(CAST(QA.Score AS FLOAT)) = 100;"},
{"question":"List all students, their total quiz attempts, and total correct answers","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, COUNT(QA.AttemptId) AS TotalAttempts, SUM(QA.CorrectAnswers) AS TotalCorrect FROM Accounts A LEFT JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName;"},
{"question":"Get all instructors, their total courses, total published courses, and publish rate","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName, COUNT(C.CourseId) AS TotalCourses, SUM(CASE WHEN C.IsPublished = 1 THEN 1 ELSE 0 END) AS TotalPublished, AVG(CAST(C.IsPublished AS FLOAT)) AS PublishRate FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId WHERE A.Role = N'Instructor' GROUP BY A.FullName;"},
{"question":"Show all instructors and the average rating of their courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT A.FullName, AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId WHERE A.Role = N'Instructor' GROUP BY A.FullName;"},
{"question":"List instructors whose average course rating is above 4.5","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT A.FullName, AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING AVG(CAST(CR.Rating AS FLOAT)) > 4.5;"},
{"question":"Find instructors with an average course rating below 2","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT A.FullName, AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING AVG(CAST(CR.Rating AS FLOAT)) < 2;"},
{"question":"Get all instructors and the total number of enrollments across their courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, COUNT(E.EnrollmentId) AS TotalEnrollments FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN Enrollments E ON C.CourseId = E.CourseId WHERE A.Role = N'Instructor' GROUP BY A.FullName;"},
{"question":"List instructors who have zero unpublished courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING AVG(CAST(C.IsPublished AS FLOAT)) = 1;"},
{"question":"Show all instructors and the total price of all their courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName, SUM(C.Price) AS TotalPrice FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId WHERE A.Role = N'Instructor' GROUP BY A.FullName;"},
{"question":"Find instructors whose total course revenue is over 1000","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName, SUM(C.Price) AS TotalRevenue FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING SUM(C.Price) > 1000;"},
{"question":"Get all instructors and the total number of lessons in their courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName, COUNT(L.LessonId) AS TotalLessons FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN Lessons L ON C.CourseId = L.CourseId WHERE A.Role = N'Instructor' GROUP BY A.FullName;"},
{"question":"List instructors with an average of more than 10 lessons per course","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName, (CAST(COUNT(L.LessonId) AS FLOAT) / COUNT(DISTINCT C.CourseId)) AS AvgLessonsPerCourse FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN Lessons L ON C.CourseId = L.CourseId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING (CAST(COUNT(L.LessonId) AS FLOAT) / COUNT(DISTINCT C.CourseId)) > 10;"},
{"question":"Show all courses, their total enrollments, and their completion rate","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title, COUNT(E.EnrollmentId) AS TotalEnrollments, AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Courses C LEFT JOIN Enrollments E ON C.CourseId = E.CourseId GROUP BY C.Title;"},
{"question":"List all courses and their average student progress percentage","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title, AVG(E.ProgressPercent) AS AverageProgress FROM Courses C LEFT JOIN Enrollments E ON C.CourseId = E.CourseId GROUP BY C.Title;"},
{"question":"Get courses with a student completion rate below 10 percent","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title, AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Courses C LEFT JOIN Enrollments E ON C.CourseId = E.CourseId GROUP BY C.Title HAVING AVG(CAST(E.IsCompleted AS FLOAT)) < 0.1;"},
{"question":"Find all courses where average student progress is over 80 percent","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title, AVG(E.ProgressPercent) AS AverageProgress FROM Courses C LEFT JOIN Enrollments E ON C.CourseId = E.CourseId GROUP BY C.Title HAVING AVG(E.ProgressPercent) > 0.8;"},
{"question":"Show all courses and their average quiz score","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT C.Title, AVG(CAST(QA.Score AS FLOAT)) AS AverageScore FROM Courses C LEFT JOIN Lessons L ON C.CourseId = L.CourseId LEFT JOIN Quizzes Q ON L.LessonId = Q.LessonId LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY C.Title;"},
{"question":"List courses where the average quiz score is above 90","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT C.Title, AVG(CAST(QA.Score AS FLOAT)) AS AverageScore FROM Courses C LEFT JOIN Lessons L ON C.CourseId = L.CourseId LEFT JOIN Quizzes Q ON L.LessonId = Q.LessonId LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY C.Title HAVING AVG(CAST(QA.Score AS FLOAT)) > 90;"},
{"question":"Get all courses, their total reviews, and their 5-star review ratio","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title, COUNT(CR.ReviewId) AS TotalReviews, AVG(CASE WHEN CR.Rating = 5 THEN 1.0 ELSE 0.0 END) AS FiveStarRatio FROM Courses C LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId GROUP BY C.Title;"},
{"question":"Find courses where the 1-star review ratio is higher than 25 percent","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title, AVG(CASE WHEN CR.Rating = 1 THEN 1.0 ELSE 0.0 END) AS OneStarRatio FROM Courses C JOIN CourseReviews CR ON C.CourseId = CR.CourseId GROUP BY C.Title HAVING AVG(CASE WHEN CR.Rating = 1 THEN 1.0 ELSE 0.0 END) > 0.25;"},
{"question":"List all categories, total courses in them, and the average course price","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT C.Name, COUNT(CO.CourseId) AS TotalCourses, AVG(CO.Price) AS AveragePrice FROM Categories C LEFT JOIN Courses CO ON C.CategoryId = CO.CategoryId GROUP BY C.Name;"},
{"question":"Show categories with an average course price over 100","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT C.Name, AVG(CO.Price) AS AveragePrice FROM Categories C JOIN Courses CO ON C.CategoryId = CO.CategoryId GROUP BY C.Name HAVING AVG(CO.Price) > 100;"},
{"question":"Get all categories and the ratio of beginner courses in them","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT C.Name, AVG(CASE WHEN CO.Difficulty = N'beginner' THEN 1.0 ELSE 0.0 END) AS BeginnerRatio FROM Categories C LEFT JOIN Courses CO ON C.CategoryId = CO.CategoryId GROUP BY C.Name;"},
{"question":"Find categories where 100 percent of courses are beginner","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT C.Name FROM Categories C JOIN Courses CO ON C.CategoryId = CO.CategoryId GROUP BY C.Name HAVING AVG(CASE WHEN CO.Difficulty = N'beginner' THEN 1.0 ELSE 0.0 END) = 1;"},
{"question":"List all categories and the total number of enrollments they have","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Name, COUNT(E.EnrollmentId) AS TotalEnrollments FROM Categories C LEFT JOIN Courses CO ON C.CategoryId = CO.CategoryId LEFT JOIN Enrollments E ON CO.CourseId = E.CourseId GROUP BY C.Name;"},
{"question":"Show categories with more than 100 total enrollments","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Name, COUNT(E.EnrollmentId) AS TotalEnrollments FROM Categories C LEFT JOIN Courses CO ON C.CategoryId = CO.CategoryId LEFT JOIN Enrollments E ON CO.CourseId = E.CourseId GROUP BY C.Name HAVING COUNT(E.EnrollmentId) > 100;"},
{"question":"Get all categories and their average course completion rate","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Name, AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Categories C LEFT JOIN Courses CO ON C.CategoryId = CO.CategoryId LEFT JOIN Enrollments E ON CO.CourseId = E.CourseId GROUP BY C.Name;"},
{"question":"List all quizzes, their total attempts, and their average score","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Q.Title, COUNT(QA.AttemptId) AS TotalAttempts, AVG(CAST(QA.Score AS FLOAT)) AS AverageScore FROM Quizzes Q LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY Q.Title;"},
{"question":"Show all quizzes and their pass rate if score 50 is passing","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Q.Title, AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) AS PassRate FROM Quizzes Q LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY Q.Title;"},
{"question":"Get quizzes with a pass rate below 25 percent assuming 50 is passing","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Q.Title, AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) AS PassRate FROM Quizzes Q LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY Q.Title HAVING AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) < 0.25;"},
{"question":"Find quizzes where the average score is exactly 100","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Q.Title FROM Quizzes Q JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY Q.Title HAVING AVG(CAST(QA.Score AS FLOAT)) = 100;"},
{"question":"List all quizzes and the ratio of attempts that were submitted","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT Q.Title, AVG(CASE WHEN QA.SubmittedAt IS NOT NULL THEN 1.0 ELSE 0.0 END) AS SubmissionRatio FROM Quizzes Q LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY Q.Title;"},
{"question":"Show all students and their total number of completed enrollments","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, SUM(CASE WHEN E.IsCompleted = 1 THEN 1 ELSE 0 END) AS TotalCompleted FROM Accounts A LEFT JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName;"},
{"question":"Get students who have completed more than 5 courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, SUM(CASE WHEN E.IsCompleted = 1 THEN 1 ELSE 0 END) AS TotalCompleted FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING SUM(CASE WHEN E.IsCompleted = 1 THEN 1 ELSE 0 END) > 5;"},
{"question":"List students who have enrolled in courses but completed zero","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING SUM(CASE WHEN E.IsCompleted = 1 THEN 1 ELSE 0 END) = 0;"},
{"question":"Find all students whose average progress is exactly 100 percent","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING AVG(E.ProgressPercent) = 1;"},
{"question":"Show students with an average quiz score between 70 and 80","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, AVG(CAST(QA.Score AS FLOAT)) AS AverageScore FROM Accounts A JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING AVG(CAST(QA.Score AS FLOAT)) BETWEEN 70 AND 80;"},
{"question":"Get the count of 5-star reviews and 1-star reviews for each course","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title, SUM(CASE WHEN CR.Rating = 5 THEN 1 ELSE 0 END) AS FiveStarReviews, SUM(CASE WHEN CR.Rating = 1 THEN 1 ELSE 0 END) AS OneStarReviews FROM Courses C LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId GROUP BY C.Title;"},
{"question":"List courses where the number of 5-star reviews is greater than 1-star reviews","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title FROM Courses C JOIN CourseReviews CR ON C.CourseId = CR.CourseId GROUP BY C.Title HAVING SUM(CASE WHEN CR.Rating = 5 THEN 1 ELSE 0 END) > SUM(CASE WHEN CR.Rating = 1 THEN 1 ELSE 0 END);"},
{"question":"Show courses that have 5-star reviews but zero 1-star reviews","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title FROM Courses C JOIN CourseReviews CR ON C.CourseId = CR.CourseId GROUP BY C.Title HAVING SUM(CASE WHEN CR.Rating = 5 THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN CR.Rating = 1 THEN 1 ELSE 0 END) = 0;"},
{"question":"Get all instructors and the ratio of beginner courses they teach","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName, AVG(CASE WHEN C.Difficulty = N'beginner' THEN 1.0 ELSE 0.0 END) AS BeginnerCourseRatio FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId WHERE A.Role = N'Instructor' GROUP BY A.FullName;"},
{"question":"Find instructors who only teach advanced courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING MIN(C.Difficulty) = N'advanced' AND MAX(C.Difficulty) = N'advanced';"},
{"question":"List instructors whose courses are all free","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING MAX(C.Price) = 0;"},
{"question":"Show instructors who have an average of more than 20 students per course","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, (CAST(COUNT(E.EnrollmentId) AS FLOAT) / COUNT(DISTINCT C.CourseId)) AS AvgStudentsPerCourse FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN Enrollments E ON C.CourseId = E.CourseId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING (CAST(COUNT(E.EnrollmentId) AS FLOAT) / COUNT(DISTINCT C.CourseId)) > 20;"},
{"question":"Get all course titles category names and instructor names","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT C.Title, CAT.Name, A.FullName FROM Courses C LEFT JOIN Categories CAT ON C.CategoryId = CAT.CategoryId JOIN Accounts A ON C.InstructorId = A.AccountId;"},
{"question":"List all enrollments showing student email course title and progress","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.Email, C.Title, E.ProgressPercent FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId JOIN Courses C ON E.CourseId = C.CourseId;"},
{"question":"Show all quiz attempts student name course title quiz title and score","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, C.Title, Q.Title, QA.Score FROM QuizAttempts QA JOIN Accounts A ON QA.AccountId = A.AccountId JOIN Quizzes Q ON QA.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId JOIN Courses C ON L.CourseId = C.CourseId;"},
{"question":"List all reviews reviewer name course title and instructor name","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT A_Reviewer.FullName, C.Title, A_Instructor.FullName FROM CourseReviews CR JOIN Accounts A_Reviewer ON CR.AccountId = A_Reviewer.AccountId JOIN Courses C ON CR.CourseId = C.CourseId JOIN Accounts A_Instructor ON C.InstructorId = A_Instructor.AccountId;"},
{"question":"Show the percentage of video lessons for each course","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT C.Title, AVG(CASE WHEN L.LessonType = N'video' THEN 1.0 ELSE 0.0 END) * 100 AS VideoLessonPercentage FROM Courses C LEFT JOIN Lessons L ON C.CourseId = L.CourseId GROUP BY C.Title;"},
{"question":"Find courses where all lessons are video lessons","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT C.Title FROM Courses C JOIN Lessons L ON C.CourseId = L.CourseId GROUP BY C.Title HAVING MIN(L.LessonType) = N'video' AND MAX(L.LessonType) = N'video';"},
{"question":"List courses where the ratio of quiz lessons is over 50 percent","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT C.Title, AVG(CASE WHEN L.LessonType = N'quiz' THEN 1.0 ELSE 0.0 END) AS QuizLessonRatio FROM Courses C JOIN Lessons L ON C.CourseId = L.CourseId GROUP BY C.Title HAVING AVG(CASE WHEN L.LessonType = N'quiz' THEN 1.0 ELSE 0.0 END) > 0.5;"},
{"question":"Show total enrollments and average progress for beginner courses","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(E.EnrollmentId) AS TotalEnrollments, AVG(E.ProgressPercent) AS AverageProgress FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Difficulty = N'beginner';"},
{"question":"Calculate total enrollments and completion rate for advanced courses","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(E.EnrollmentId) AS TotalEnrollments, AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Difficulty = N'advanced';"},
{"question":"What is the total revenue from completed enrollments","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE E.IsCompleted = 1;"},
{"question":"Get total revenue from enrollments by active students","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId JOIN Accounts A ON E.AccountId = A.AccountId WHERE A.IsActive = 1 AND A.Role = N'Student';"},
{"question":"Show total quiz attempts and average score for beginner courses","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(QA.AttemptId) AS TotalAttempts, AVG(CAST(QA.Score AS FLOAT)) AS AverageScore FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId JOIN Courses C ON L.CourseId = C.CourseId WHERE C.Difficulty = N'beginner';"},
{"question":"Calculate total attempts and average score for Programming category courses","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(QA.AttemptId) AS TotalAttempts, AVG(CAST(QA.Score AS FLOAT)) AS AverageScore FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId JOIN Courses C ON L.CourseId = C.CourseId JOIN Categories CAT ON C.CategoryId = CAT.CategoryId WHERE CAT.Name = N'Programming';"},
{"question":"What is the ratio of correct answers to total questions for each student","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, CAST(SUM(QA.CorrectAnswers) AS FLOAT) / SUM(QA.TotalQuestions) AS AccuracyRatio FROM Accounts A LEFT JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' AND QA.TotalQuestions > 0 GROUP BY A.FullName;"},
{"question":"Find students whose overall quiz accuracy is below 50 percent","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, (CAST(SUM(QA.CorrectAnswers) AS FLOAT) / SUM(QA.TotalQuestions)) AS AccuracyRatio FROM Accounts A JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' AND QA.TotalQuestions > 0 GROUP BY A.FullName HAVING (CAST(SUM(QA.CorrectAnswers) AS FLOAT) / SUM(QA.TotalQuestions)) < 0.5;"},
{"question":"List all courses and the ratio of enrollments that are completed","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title, AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Courses C LEFT JOIN Enrollments E ON C.CourseId = E.CourseId GROUP BY C.Title;"},
{"question":"Show courses where 100 percent of enrollments are completed","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title FROM Courses C JOIN Enrollments E ON C.CourseId = E.CourseId GROUP BY C.Title HAVING MIN(CAST(E.IsCompleted AS INT)) = 1;"},
{"question":"Get the total number of students and total number of instructors","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT Role, COUNT(AccountId) AS TotalCount FROM Accounts WHERE Role IN (N'Student', N'Instructor') GROUP BY Role;"},
{"question":"What is the ratio of active students to total students","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(IsActive AS FLOAT)) AS ActiveStudentRatio FROM Accounts WHERE Role = N'Student';"},
{"question":"Calculate the ratio of active instructors to total instructors","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(IsActive AS FLOAT)) AS ActiveInstructorRatio FROM Accounts WHERE Role = N'Instructor';"},
{"question":"How many courses have 100 percent completion rate but an average score below 60","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT C.Title, AVG(CAST(QA.Score AS FLOAT)) AS AverageScore FROM Courses C JOIN Enrollments E ON C.CourseId = E.CourseId LEFT JOIN Lessons L ON C.CourseId = L.CourseId LEFT JOIN Quizzes Q ON L.LessonId = Q.LessonId LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY C.Title HAVING MIN(CAST(E.IsCompleted AS INT)) = 1 AND AVG(CAST(QA.Score AS FLOAT)) < 60;"},
{"question":"Get the count of enrollments for each difficulty level","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Difficulty, COUNT(E.EnrollmentId) AS TotalEnrollments FROM Courses C LEFT JOIN Enrollments E ON C.CourseId = E.CourseId GROUP BY C.Difficulty;"},
{"question":"List the average rating for courses grouped by difficulty","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Difficulty, AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM Courses C LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId GROUP BY C.Difficulty;"},
{"question":"Show the pass rate for quizzes grouped by course difficulty","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT C.Difficulty, AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) AS PassRate FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId JOIN Courses C ON L.CourseId = C.CourseId GROUP BY C.Difficulty;"},
{"question":"Find the ratio of video lessons for all courses taught by instructor Jane","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN L.LessonType = N'video' THEN 1.0 ELSE 0.0 END) AS VideoLessonRatio FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.FullName = N'Instructor Jane';"},
{"question":"Get the total number of quiz questions in the Programming category","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT COUNT(QQ.QuestionId) AS TotalQuestions FROM QuizQuestions QQ JOIN Quizzes Q ON QQ.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId JOIN Courses C ON L.CourseId = C.CourseId JOIN Categories CAT ON C.CategoryId = CAT.CategoryId WHERE CAT.Name = N'Programming';"},
{"question":"List students who are enrolled but have not taken any quizzes","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT DISTINCT A.FullName FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId LEFT JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' AND QA.AttemptId IS NULL;"},
{"question":"Show students with 100 percent completion rate and average score over 90","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING MIN(CAST(E.IsCompleted AS INT)) = 1 AND AVG(CAST(QA.Score AS FLOAT)) > 90;"},
{"question":"Get the ratio of 5-star reviews to 1-star reviews for each course","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title, CAST(SUM(CASE WHEN CR.Rating = 5 THEN 1 ELSE 0 END) AS FLOAT) / SUM(CASE WHEN CR.Rating = 1 THEN 1 ELSE 0 END) AS ReviewRatio FROM Courses C LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId WHERE CR.Rating IN (1, 5) GROUP BY C.Title;"},
{"question":"List all courses and the percentage of lessons that are quizzes","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT C.Title, AVG(CASE WHEN L.LessonType = N'quiz' THEN 1.0 ELSE 0.0 END) * 100 AS QuizLessonPercentage FROM Courses C LEFT JOIN Lessons L ON C.CourseId = L.CourseId GROUP BY C.Title;"},
{"question":"Find courses where over 20 percent of lessons are quizzes","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT C.Title, AVG(CASE WHEN L.LessonType = N'quiz' THEN 1.0 ELSE 0.0 END) AS QuizLessonRatio FROM Courses C JOIN Lessons L ON C.CourseId = L.CourseId GROUP BY C.Title HAVING AVG(CASE WHEN L.LessonType = N'quiz' THEN 1.0 ELSE 0.0 END) > 0.2;"},
{"question":"Calculate the average quiz pass rate for each instructor","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) AS AveragePassRate FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN Lessons L ON C.CourseId = L.CourseId LEFT JOIN Quizzes Q ON L.LessonId = Q.LessonId LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId WHERE A.Role = N'Instructor' GROUP BY A.FullName;"},
{"question":"Find instructors whose courses have a quiz pass rate lower than 40 percent","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) AS AveragePassRate FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN Lessons L ON C.CourseId = L.CourseId LEFT JOIN Quizzes Q ON L.LessonId = Q.LessonId LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId WHERE A.Role = N'Instructor' GROUP BY A.FullName HAVING AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) < 0.4;"},
{"question":"Get total enrollments and total revenue for each course","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title, COUNT(E.EnrollmentId) AS TotalEnrollments, SUM(C.Price) AS TotalRevenue FROM Courses C LEFT JOIN Enrollments E ON C.CourseId = E.CourseId GROUP BY C.Title;"},
{"question":"List courses where total revenue from enrollments exceeds 500","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title, SUM(C.Price) AS TotalRevenue FROM Courses C JOIN Enrollments E ON C.CourseId = E.CourseId GROUP BY C.Title HAVING SUM(C.Price) > 500;"},
{"question":"Show average enrollment progress for active students in beginner courses","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT AVG(E.ProgressPercent) AS AverageProgress FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId JOIN Accounts A ON E.AccountId = A.AccountId WHERE C.Difficulty = N'beginner' AND A.IsActive = 1 AND A.Role = N'Student';"},
{"question":"Calculate the percentage of students that are active","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(IsActive AS FLOAT)) * 100 AS ActiveStudentPercentage FROM Accounts WHERE Role = N'Student';"},
{"question":"Find the percentage of courses that are published","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(IsPublished AS FLOAT)) * 100 AS PublishedCoursePercentage FROM Courses;"},
{"question":"Get the ratio of courses that are free","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN Price = 0 THEN 1.0 ELSE 0.0 END) AS FreeCourseRatio FROM Courses;"},
{"question":"What percentage of lessons are video type","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN LessonType = N'video' THEN 1.0 ELSE 0.0 END) * 100 AS VideoLessonPercentage FROM Lessons;"},
{"question":"Calculate the overall quiz pass rate","context":"CREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CASE WHEN Score >= 50 THEN 1.0 ELSE 0.0 END) AS OverallPassRate FROM QuizAttempts WHERE SubmittedAt IS NOT NULL;"},
{"question":"What is the overall course completion rate","context":"CREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT AVG(CAST(IsCompleted AS FLOAT)) AS OverallCompletionRate FROM Enrollments;"},
{"question":"Get the percentage of reviews that are 5-star","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN Rating = 5 THEN 1.0 ELSE 0.0 END) * 100 AS FiveStarPercentage FROM CourseReviews;"},
{"question":"Find the ratio of Lead instructors in the CourseInstructors table","context":"CREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT, RoleInCourse NVARCHAR(20));","answer":"SELECT AVG(CASE WHEN RoleInCourse = N'Lead' THEN 1.0 ELSE 0.0 END) AS LeadInstructorRatio FROM CourseInstructors;"},
{"question":"List students who have an average score but zero completed courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName FROM Accounts A LEFT JOIN Enrollments E ON A.AccountId = E.AccountId LEFT JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING COUNT(QA.AttemptId) > 0 AND SUM(CASE WHEN E.IsCompleted = 1 THEN 1 ELSE 0 END) = 0;"},
{"question":"Show instructors who teach beginner courses and have an average rating above 4","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT A.FullName, AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM Accounts A JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId WHERE A.Role = N'Instructor' AND C.Difficulty = N'beginner' GROUP BY A.FullName HAVING AVG(CAST(CR.Rating AS FLOAT)) > 4;"},
{"question":"Get the ratio of courses that are published for each category","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT C.Name, AVG(CAST(CO.IsPublished AS FLOAT)) AS PublishRate FROM Categories C LEFT JOIN Courses CO ON C.CategoryId = CO.CategoryId GROUP BY C.Name;"},
{"question":"Find categories where the course publish rate is 100 percent","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT C.Name FROM Categories C JOIN Courses CO ON C.CategoryId = CO.CategoryId GROUP BY C.Name HAVING AVG(CAST(CO.IsPublished AS FLOAT)) = 1;"},
{"question":"List the average number of lessons per course for each category","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT CAT.Name, (CAST(COUNT(L.LessonId) AS FLOAT) / COUNT(DISTINCT C.CourseId)) AS AvgLessonsPerCourse FROM Categories CAT LEFT JOIN Courses C ON CAT.CategoryId = C.CategoryId LEFT JOIN Lessons L ON C.CourseId = L.CourseId GROUP BY CAT.Name;"},
{"question":"Show total quiz questions and total quiz attempts for each course","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);\nCREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);","answer":"SELECT C.Title, COUNT(DISTINCT QQ.QuestionId) AS TotalQuestions, COUNT(QA.AttemptId) AS TotalAttempts FROM Courses C LEFT JOIN Lessons L ON C.CourseId = L.CourseId LEFT JOIN Quizzes Q ON L.LessonId = Q.LessonId LEFT JOIN QuizQuestions QQ ON Q.QuizId = QQ.QuizId LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId GROUP BY C.Title;"},
{"question":"Find the total revenue for beginner courses","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Difficulty = N'beginner';"},
{"question":"List students enrolled in more than 3 courses with an average score below 50","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.Role = N'Student' GROUP BY A.FullName HAVING COUNT(DISTINCT E.CourseId) > 3 AND AVG(CAST(QA.Score AS FLOAT)) < 50;"},
{"question":"Get the average rating for courses that are 100 percent completed","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title, AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM Courses C JOIN Enrollments E ON C.CourseId = E.CourseId LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId GROUP BY C.Title HAVING MIN(CAST(E.IsCompleted AS INT)) = 1;"},
{"question":"Show the ratio of 5-star reviews to total reviews for advanced courses","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN CR.Rating = 5 THEN 1.0 ELSE 0.0 END) AS FiveStarRatio FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId WHERE C.Difficulty = N'advanced';"},
{"question":"List all courses total lessons and the ratio of text lessons","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT C.Title, COUNT(L.LessonId) AS TotalLessons, AVG(CASE WHEN L.LessonType = N'text' THEN 1.0 ELSE 0.0 END) AS TextLessonRatio FROM Courses C LEFT JOIN Lessons L ON C.CourseId = L.CourseId GROUP BY C.Title;"},
{"question":"Find courses where zero percent of lessons are text lessons","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT C.Title FROM Courses C JOIN Lessons L ON C.CourseId = L.CourseId GROUP BY C.Title HAVING AVG(CASE WHEN L.LessonType = N'text' THEN 1.0 ELSE 0.0 END) = 0;"}
{"question":"List all courses with total students and total instructors","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount, COUNT(DISTINCT ci.AccountId) AS InstructorCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"Show course title and number of distinct students","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"Export courses with instructor names in one column","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS InstructorNames FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId GROUP BY c.Title;"}
{"question":"List courses created this month with student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200), CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE YEAR(c.CreatedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(c.CreatedAt)=MONTH(SYSUTCDATETIME()) GROUP BY c.Title;"}
{"question":"Show categories with total students across their courses","context":"CREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Courses (CourseId INT, CategoryId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT g.Name, COUNT(DISTINCT e.AccountId) AS TotalStudents FROM Categories g LEFT JOIN Courses c ON c.CategoryId=g.CategoryId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY g.Name;"}
{"question":"Get courses in the AI category with student count and instructor count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200), CategoryId INT);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount, COUNT(DISTINCT ci.AccountId) AS InstructorCount FROM Courses c JOIN Categories g ON g.CategoryId=c.CategoryId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE g.Name=N'AI' GROUP BY c.Title;"}
{"question":"Show all students with joined courses and completed courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS JoinedCourses, SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS CompletedCourses FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Find students who never joined any course","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND e.EnrollmentId IS NULL GROUP BY a.FullName;"}
{"question":"Find students who joined courses but have zero completed","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName FROM Accounts a JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName HAVING SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END)=0;"}
{"question":"Show students with completion rate below fifty percent among joined courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRate FROM Accounts a JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName HAVING COUNT(e.EnrollmentId)>0 AND CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) < 0.5;"}
{"question":"List courses with average progress and student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT, ProgressPercent REAL);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"Show courses with completion ratio","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT c.Title, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"Export courses with student count where title contains basics","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%basics%' GROUP BY c.Title;"}
{"question":"List courses with instructor names and student count for quick overview","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, STRING_AGG(DISTINCT a.FullName, N', ') AS InstructorNames, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"Show categories with number of courses instructors lessons and students","context":"CREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR(200), CategoryId INT);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT g.Name AS CategoryName, COUNT(DISTINCT c.CourseId) AS Courses, COUNT(DISTINCT ci.AccountId) AS Instructors, COUNT(DISTINCT l.LessonId) AS Lessons, COUNT(DISTINCT e.AccountId) AS Students FROM Categories g LEFT JOIN Courses c ON c.CategoryId=g.CategoryId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Lessons l ON l.CourseId=c.CourseId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY g.Name;"}
{"question":"Get top five courses by completion ratio","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT TOP 5 c.Title, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title ORDER BY CompletionRatio DESC;"}
{"question":"List students with attempts count and average score","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, COUNT(qa.AttemptId) AS Attempts, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Find students who joined at least two courses and completed none","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName FROM Accounts a JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName HAVING COUNT(*)>=2 AND SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END)=0;"}
{"question":"Show courses with number of quizzes per course","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT);","answer":"SELECT c.Title, COUNT(q.QuizId) AS QuizCount FROM Courses c LEFT JOIN Lessons l ON l.CourseId=c.CourseId LEFT JOIN Quizzes q ON q.LessonId=l.LessonId GROUP BY c.Title;"}
{"question":"Export courses with number of lessons and number of instructors","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(l.LessonId) AS LessonCount, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN Lessons l ON l.CourseId=c.CourseId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"List all courses with zero students and zero instructors","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId GROUP BY c.Title HAVING COUNT(e.EnrollmentId)=0 AND COUNT(ci.Id)=0;"}
{"question":"Show students with participation rate against all courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Courses (CourseId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);","answer":"SELECT a.FullName, CAST(COUNT(DISTINCT e.CourseId) AS DECIMAL(10,2))/NULLIF((SELECT COUNT(*) FROM Courses),0) AS ParticipationRate FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Show students with participation and completion counts","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined, SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS Completed FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"List students with completed courses sorted by completed descending","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS Completed FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName ORDER BY Completed DESC;"}
{"question":"Export courses with student count for titles that contain cloud","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%cloud%' GROUP BY c.Title;"}
{"question":"Show courses with student count where title starts with intro","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'Intro%' GROUP BY c.Title;"}
{"question":"List courses in the Data category with student count and lesson count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200), CategoryId INT);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(l.LessonId) AS LessonCount, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c JOIN Categories g ON g.CategoryId=c.CategoryId LEFT JOIN Lessons l ON l.CourseId=c.CourseId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE g.Name LIKE N'Data%' GROUP BY c.Title;"}
{"question":"Get students with average score across all attempts","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Show courses with number of distinct students who attempted quizzes","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT qa.AccountId) AS StudentsAttempted FROM Courses c JOIN Lessons l ON l.CourseId=c.CourseId JOIN Quizzes q ON q.LessonId=l.LessonId LEFT JOIN QuizAttempts qa ON qa.QuizId=q.QuizId GROUP BY c.Title;"}
{"question":"Export students and the list of course titles they joined","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT a.FullName, STRING_AGG(DISTINCT c.Title, N', ') AS CourseTitles FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId LEFT JOIN Courses c ON c.CourseId=e.CourseId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"List courses with instructor count where instructors have role Instructor","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, Role NVARCHAR(20));","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE a.Role=N'Instructor' GROUP BY c.Title;"}
{"question":"Show students with number of categories covered by their enrollments","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE Courses (CourseId INT, CategoryId INT);\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));","answer":"SELECT a.FullName, COUNT(DISTINCT g.Name) AS CategoriesCovered FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId LEFT JOIN Courses c ON c.CourseId=e.CourseId LEFT JOIN Categories g ON g.CategoryId=c.CategoryId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Return courses with student count and average score across their quizzes","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, Score INT);","answer":"SELECT c.Title, COUNT(DISTINCT qa.AccountId) AS StudentsAttempted, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Courses c JOIN Lessons l ON l.CourseId=c.CourseId JOIN Quizzes q ON q.LessonId=l.LessonId LEFT JOIN QuizAttempts qa ON qa.QuizId=q.QuizId GROUP BY c.Title;"}
{"question":"List students with joined courses completed courses and average score","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS JoinedCourses, SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS CompletedCourses, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Show students who joined but never attempted any quiz","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT a.FullName FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName HAVING COUNT(e.EnrollmentId)>0 AND COUNT(qa.AttemptId)=0;"}
{"question":"Export courses with five star review count and student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Rating INT);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount, SUM(CASE WHEN r.Rating=5 THEN 1 ELSE 0 END) AS FiveStarReviews FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId LEFT JOIN CourseReviews r ON r.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"Show courses with student count only for enrollments in the current month","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT, EnrolledOn DATETIME2);","answer":"SELECT c.Title, COUNT(DISTINCT CASE WHEN YEAR(e.EnrolledOn)=YEAR(SYSUTCDATETIME()) AND MONTH(e.EnrolledOn)=MONTH(SYSUTCDATETIME()) THEN e.AccountId END) AS CurrentMonthStudents FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"List courses with instructor count and student count sorted by student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT ci.AccountId) AS Instructors, COUNT(DISTINCT e.AccountId) AS Students FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title ORDER BY Students DESC;"}
{"question":"Show categories with course count and average course price","context":"CREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Price DECIMAL(12,2));","answer":"SELECT g.Name, COUNT(c.CourseId) AS CourseCount, AVG(CAST(c.Price AS DECIMAL(12,2))) AS AvgPrice FROM Categories g LEFT JOIN Courses c ON c.CategoryId=g.CategoryId GROUP BY g.Name;"}
{"question":"Export courses with instructor names where the course has at least one student","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, STRING_AGG(DISTINCT a.FullName, N', ') AS Instructors FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title HAVING COUNT(e.EnrollmentId) > 0;"}
{"question":"List students and the number of lessons across their joined courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT);","answer":"SELECT a.FullName, COUNT(DISTINCT l.LessonId) AS LessonsSeen FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId LEFT JOIN Lessons l ON l.CourseId=e.CourseId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Show courses with number of distinct students whose names contain Nguyen","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c JOIN Enrollments e ON e.CourseId=c.CourseId JOIN Accounts a ON a.AccountId=e.AccountId WHERE a.FullName LIKE N'%Nguyen%' GROUP BY c.Title;"}
{"question":"Export courses with student count for titles that end with advanced","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%advanced' GROUP BY c.Title;"}
{"question":"List students with number of quiz attempts made this month","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, SubmittedAt DATETIME2);","answer":"SELECT a.FullName, COUNT(*) AS AttemptsThisMonth FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND YEAR(qa.SubmittedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(qa.SubmittedAt)=MONTH(SYSUTCDATETIME()) GROUP BY a.FullName;"}
{"question":"Show courses with average score across all attempts in their quizzes","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, Score INT);","answer":"SELECT c.Title, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Courses c JOIN Lessons l ON l.CourseId=c.CourseId JOIN Quizzes q ON q.LessonId=l.LessonId LEFT JOIN QuizAttempts qa ON qa.QuizId=q.QuizId GROUP BY c.Title;"}
{"question":"Return courses with zero lessons","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Lessons (LessonId INT, CourseId INT);","answer":"SELECT c.* FROM Courses c LEFT JOIN Lessons l ON l.CourseId=c.CourseId WHERE l.LessonId IS NULL;"}
{"question":"List courses with instructor count where title contains api","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%api%' GROUP BY c.Title;"}
{"question":"Show students with courses joined and remaining courses to explore","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Courses (CourseId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);","answer":"SELECT a.FullName, COUNT(DISTINCT e.CourseId) AS Joined, (SELECT COUNT(*) FROM Courses) - COUNT(DISTINCT e.CourseId) AS Remaining FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Export categories with student count and average completion ratio per category","context":"CREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Courses (CourseId INT, CategoryId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT, AccountId INT);","answer":"SELECT g.Name, COUNT(DISTINCT e.AccountId) AS Students, AVG(CAST(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END AS DECIMAL(10,2))) AS AvgCompletion FROM Categories g LEFT JOIN Courses c ON c.CategoryId=g.CategoryId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY g.Name;"}
{"question":"Show courses with instructor names for those created in the last seven days","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200), CreatedAt DATETIME2);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS Instructors FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE c.CreatedAt>=DATEADD(DAY,-7,SYSUTCDATETIME()) GROUP BY c.Title;"}
{"question":"List students with completion rate and average score in the current month","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT, SubmittedAt DATETIME2);","answer":"SELECT a.FullName, CAST(SUM(CASE WHEN e.IsCompleted=1 AND YEAR(e.CompletionDate)=YEAR(SYSUTCDATETIME()) AND MONTH(e.CompletionDate)=MONTH(SYSUTCDATETIME()) THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(CASE WHEN YEAR(e.CompletionDate)=YEAR(SYSUTCDATETIME()) AND MONTH(e.CompletionDate)=MONTH(SYSUTCDATETIME()) THEN 1 END),0) AS CompletionRateThisMonth, AVG(CAST(CASE WHEN YEAR(qa.SubmittedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(qa.SubmittedAt)=MONTH(SYSUTCDATETIME()) THEN qa.Score END AS FLOAT)) AS AvgScoreThisMonth FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Show courses with student count for each category sorted by students descending","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200));\nCREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT g.Name AS CategoryName, COUNT(DISTINCT e.AccountId) AS Students FROM Categories g LEFT JOIN Courses c ON c.CategoryId=g.CategoryId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY g.Name ORDER BY Students DESC;"}
{"question":"Export courses with instructor count and five star reviews","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Rating INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount, SUM(CASE WHEN r.Rating=5 THEN 1 ELSE 0 END) AS FiveStarReviews FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN CourseReviews r ON r.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"List students with the latest attempt date and total attempts","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, SubmittedAt DATETIME2);","answer":"SELECT a.FullName, MAX(qa.SubmittedAt) AS LatestAttempt, COUNT(qa.AttemptId) AS TotalAttempts FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Show courses with the ratio of students who completed to all students in that course","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT c.Title, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"Get students with participation rate under fifty percent and completion rate under fifty percent","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Courses (CourseId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT a.FullName FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName HAVING CAST(COUNT(DISTINCT e.CourseId) AS DECIMAL(10,2))/NULLIF((SELECT COUNT(*) FROM Courses),0) < 0.5 AND CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) < 0.5;"}
{"question":"Export courses with instructor names where title contains machine learning","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS InstructorNames FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE c.Title LIKE N'%machine learning%' GROUP BY c.Title;"}
{"question":"Show categories with average progress across all enrollments","context":"CREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Courses (CourseId INT, CategoryId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);","answer":"SELECT g.Name, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Categories g LEFT JOIN Courses c ON c.CategoryId=g.CategoryId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY g.Name;"}
{"question":"List students with number of courses that have at least one quiz","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT);","answer":"SELECT a.FullName, COUNT(DISTINCT e.CourseId) AS CoursesWithQuiz FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId LEFT JOIN Lessons l ON l.CourseId=e.CourseId LEFT JOIN Quizzes q ON q.LessonId=l.LessonId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Show courses with the count of students who have at least one attempt","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT qa.AccountId) AS StudentsWithAttempts FROM Courses c JOIN Lessons l ON l.CourseId=c.CourseId JOIN Quizzes q ON q.LessonId=l.LessonId LEFT JOIN QuizAttempts qa ON qa.QuizId=q.QuizId GROUP BY c.Title;"}
{"question":"Export courses with student count limited to enrollments in the last thirty days","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT, EnrolledOn DATETIME2);","answer":"SELECT c.Title, COUNT(DISTINCT CASE WHEN e.EnrolledOn>=DATEADD(DAY,-30,SYSUTCDATETIME()) THEN e.AccountId END) AS RecentStudents FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"List categories with students who attempted quizzes and average score per category","context":"CREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Courses (CourseId INT, CategoryId INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, Score INT);","answer":"SELECT g.Name, COUNT(DISTINCT qa.AccountId) AS StudentsAttempted, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Categories g LEFT JOIN Courses c ON c.CategoryId=g.CategoryId LEFT JOIN Lessons l ON l.CourseId=c.CourseId LEFT JOIN Quizzes q ON q.LessonId=l.LessonId LEFT JOIN QuizAttempts qa ON qa.QuizId=q.QuizId GROUP BY g.Name;"}
{"question":"Show students with joined courses and completed courses only for this month","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, IsCompleted BIT, CompletionDate DATETIME2, EnrolledOn DATETIME2);","answer":"SELECT a.FullName, COUNT(CASE WHEN YEAR(e.EnrolledOn)=YEAR(SYSUTCDATETIME()) AND MONTH(e.EnrolledOn)=MONTH(SYSUTCDATETIME()) THEN 1 END) AS JoinedThisMonth, COUNT(CASE WHEN e.IsCompleted=1 AND YEAR(e.CompletionDate)=YEAR(SYSUTCDATETIME()) AND MONTH(e.CompletionDate)=MONTH(SYSUTCDATETIME()) THEN 1 END) AS CompletedThisMonth FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Get students sorted by participation rate then average score descending","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Courses (CourseId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT);\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, CAST(COUNT(DISTINCT e.CourseId) AS DECIMAL(10,2))/NULLIF((SELECT COUNT(*) FROM Courses),0) AS ParticipationRate, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName ORDER BY ParticipationRate DESC, AvgScore DESC;"}
{"question":"Show courses with instructor names where student count is at least ten","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, STRING_AGG(DISTINCT a.FullName, N', ') AS InstructorNames FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title HAVING COUNT(DISTINCT e.AccountId) >= 10;"}
{"question":"Export courses with student count and the number of quiz questions","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT);\nCREATE TABLE QuizQuestions (QuestionId INT, QuizId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount, COUNT(qq.QuestionId) AS QuestionCount FROM Courses c LEFT JOIN Lessons l ON l.CourseId=c.CourseId LEFT JOIN Quizzes q ON q.LessonId=l.LessonId LEFT JOIN QuizQuestions qq ON qq.QuizId=q.QuizId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"List students who have the highest number of attempts","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT TOP 1 a.FullName, COUNT(qa.AttemptId) AS Attempts FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName ORDER BY Attempts DESC;"}
{"question":"Show courses with student count restricted to students whose names start with Tran","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c JOIN Enrollments e ON e.CourseId=c.CourseId JOIN Accounts a ON a.AccountId=e.AccountId WHERE a.FullName LIKE N'Tran%' GROUP BY c.Title;"}
{"question":"Export categories with course count and student count where category starts with Web","context":"CREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Courses (CourseId INT, CategoryId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT g.Name, COUNT(DISTINCT c.CourseId) AS Courses, COUNT(DISTINCT e.AccountId) AS Students FROM Categories g LEFT JOIN Courses c ON c.CategoryId=g.CategoryId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE g.Name LIKE N'Web%' GROUP BY g.Name;"}
{"question":"Show students with courses joined and average progress across enrollments","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, ProgressPercent REAL);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"List courses with number of lessons and number of students who attempted at least one quiz","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(l.LessonId) AS LessonCount, COUNT(DISTINCT qa.AccountId) AS StudentsAttempted FROM Courses c LEFT JOIN Lessons l ON l.CourseId=c.CourseId LEFT JOIN Quizzes q ON q.LessonId=l.LessonId LEFT JOIN QuizAttempts qa ON qa.QuizId=q.QuizId GROUP BY c.Title;"}
{"question":"Get students with completion count and attempts count side by side","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT a.FullName, SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS CompletedCourses, COUNT(qa.AttemptId) AS Attempts FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Show courses with instructor count lesson count and completion ratio in one row","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Lessons (LessonId INT, CourseId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount, COUNT(l.LessonId) AS LessonCount, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRatio FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Lessons l ON l.CourseId=c.CourseId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"Export students with participation rate and completion rate in separate columns","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Courses (CourseId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT a.FullName, CAST(COUNT(DISTINCT e.CourseId) AS DECIMAL(10,2))/NULLIF((SELECT COUNT(*) FROM Courses),0) AS ParticipationRate, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRate FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"List courses with student count and instructor names for the current month only","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT, EnrolledOn DATETIME2);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, COUNT(DISTINCT CASE WHEN YEAR(e.EnrolledOn)=YEAR(SYSUTCDATETIME()) AND MONTH(e.EnrolledOn)=MONTH(SYSUTCDATETIME()) THEN e.AccountId END) AS StudentsThisMonth, STRING_AGG(a.FullName, N', ') AS Instructors FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId GROUP BY c.Title;"}
{"question":"Show categories with students who finished at least one course and those who did not","context":"CREATE TABLE Categories (CategoryId INT, Name NVARCHAR(120));\nCREATE TABLE Courses (CourseId INT, CategoryId INT);\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT g.Name, COUNT(DISTINCT CASE WHEN e.IsCompleted=1 THEN e.AccountId END) AS StudentsCompleted, COUNT(DISTINCT CASE WHEN e.IsCompleted=0 THEN e.AccountId END) AS StudentsNotCompleted FROM Categories g LEFT JOIN Courses c ON c.CategoryId=g.CategoryId LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY g.Name;"}
{"question":"Return courses with student count and number of reviews rated at least four","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, Rating INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount, SUM(CASE WHEN r.Rating>=4 THEN 1 ELSE 0 END) AS PositiveReviews FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId LEFT JOIN CourseReviews r ON r.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"Get students with the count of distinct courses where they achieved completion","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT a.FullName, COUNT(DISTINCT CASE WHEN e.IsCompleted=1 THEN e.CourseId END) AS CompletedCourses FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Show courses with student count and average completion flag cast to decimal for clarity","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount, AVG(CAST(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END AS DECIMAL(10,2))) AS AvgCompleted FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId GROUP BY c.Title;"}
{"question":"List students with attempts this week and total attempts so far","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, SubmittedAt DATETIME2);","answer":"SELECT a.FullName, COUNT(CASE WHEN DATEDIFF(WEEK, qa.SubmittedAt, SYSUTCDATETIME())=0 THEN 1 END) AS AttemptsThisWeek, COUNT(qa.AttemptId) AS TotalAttempts FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' GROUP BY a.FullName;"}
{"question":"Export courses with student count and instructor count for titles that contain sql","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount, COUNT(DISTINCT ci.AccountId) AS InstructorCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%sql%' GROUP BY c.Title;"}
{"question":"List students whose name contains Nguyen","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT * FROM Accounts WHERE Role=N'Student' AND FullName LIKE N'%Nguyen%';"}
{"question":"Show students whose name starts with Tran and include their id and name only","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Student' AND FullName LIKE N'Tran%';"}
{"question":"Get instructors whose name ends with Anh","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT * FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Anh';"}
{"question":"Find instructors with name containing Pham and show id and name","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Pham%';"}
{"question":"List courses whose title contains cloud","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT * FROM Courses WHERE Title LIKE N'%cloud%';"}
{"question":"Show course id and title for courses that start with Intro","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT CourseId, Title FROM Courses WHERE Title LIKE N'Intro%';"}
{"question":"Export courses where title ends with advanced","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT * FROM Courses WHERE Title LIKE N'%advanced';"}
{"question":"Find courses containing the word data and return id and title","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT CourseId, Title FROM Courses WHERE Title LIKE N'%data%';"}
{"question":"List courses with student count where course title contains api","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%api%' GROUP BY c.Title;"}
{"question":"Show instructor names teaching courses with title containing sql","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT DISTINCT a.FullName FROM Courses c JOIN CourseInstructors ci ON ci.CourseId=c.CourseId JOIN Accounts a ON a.AccountId=ci.AccountId WHERE a.Role=N'Instructor' AND c.Title LIKE N'%sql%';"}
{"question":"Get student count for courses with title containing machine learning","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%machine learning%' GROUP BY c.Title;"}
{"question":"Find students whose name contains Le and show joined course count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS JoinedCount FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Le%' GROUP BY a.FullName;"}
{"question":"List instructors with name containing Vo and count their courses","context":"CREATE TABLE Accounts (AccountId INT, AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CourseCount FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Vo%' GROUP BY a.FullName;"}
{"question":"Show students with name starting with Bui and completion count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS Completed FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Bui%' GROUP BY a.FullName;"}
{"question":"Export courses with average progress where title contains fundamentals","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT, ProgressPercent REAL);","answer":"SELECT c.Title, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%fundamentals%' GROUP BY c.Title;"}
{"question":"List courses with title starting with React and student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS Students FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'React%' GROUP BY c.Title;"}
{"question":"Find instructors whose name contains Dinh and show instructor id and name","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Dinh%';"}
{"question":"Show students whose name contains Quang and list id and name","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Student' AND FullName LIKE N'%Quang%';"}
{"question":"Get courses whose title contains agile with instructor count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%agile%' GROUP BY c.Title;"}
{"question":"List courses whose title contains python and return id and title","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT CourseId, Title FROM Courses WHERE Title LIKE N'%python%';"}
{"question":"Find students with name ending with Ly and joined count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS JoinedCount FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Ly' GROUP BY a.FullName;"}
{"question":"Show instructors with name starting with Nguyen and their course count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CourseCount FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'Nguyen%' GROUP BY a.FullName;"}
{"question":"Get courses where title contains security and student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS Students FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%security%' GROUP BY c.Title;"}
{"question":"List students with name containing Hang and completion rate","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRate FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Hang%' GROUP BY a.FullName;"}
{"question":"Show courses whose title contains azure with instructor names","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS Instructors FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE c.Title LIKE N'%azure%' GROUP BY c.Title;"}
{"question":"Find instructors whose name contains Hai and list instructor id and name","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Hai%';"}
{"question":"Export courses where title starts with Data and show student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'Data%' GROUP BY c.Title;"}
{"question":"List students with name containing Phuong and joined courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Phuong%' GROUP BY a.FullName;"}
{"question":"Show courses with title containing docker and number of instructors","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%docker%' GROUP BY c.Title;"}
{"question":"Get students whose name starts with Do and average progress","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, ProgressPercent REAL);","answer":"SELECT a.FullName, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Do%' GROUP BY a.FullName;"}
{"question":"Find courses with title containing kotlin and return id and title","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT CourseId, Title FROM Courses WHERE Title LIKE N'%kotlin%';"}
{"question":"List instructors with name ending with Son and course count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CourseCount FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Son' GROUP BY a.FullName;"}
{"question":"Show students with name containing Minh and attempt count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(qa.AttemptId) AS Attempts FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Minh%' GROUP BY a.FullName;"}
{"question":"Export courses where title contains server and completion ratio","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT c.Title, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%server%' GROUP BY c.Title;"}
{"question":"List students whose name contains Huy and completed courses count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS Completed FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Huy%' GROUP BY a.FullName;"}
{"question":"Show courses with title containing web and instructor names","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS Instructors FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE c.Title LIKE N'%web%' GROUP BY c.Title;"}
{"question":"Find students with name starting with Pham and joined count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS JoinedCount FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Pham%' GROUP BY a.FullName;"}
{"question":"Get courses whose title ends with basics and student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS Students FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%basics' GROUP BY c.Title;"}
{"question":"List instructors whose name contains Thao and show id and name","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Thao%';"}
{"question":"Show students whose name contains Yen and average score","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Yen%' GROUP BY a.FullName;"}
{"question":"Export courses with title containing devops and student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%devops%' GROUP BY c.Title;"}
{"question":"List students with name starting with Vo and completion rate","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRate FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Vo%' GROUP BY a.FullName;"}
{"question":"Get instructors with name containing Long and courses taught","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CoursesTaught FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Long%' GROUP BY a.FullName;"}
{"question":"Find courses where title contains java and list id and title","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT CourseId, Title FROM Courses WHERE Title LIKE N'%java%';"}
{"question":"Show students whose name contains Duyen and attempts count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(qa.AttemptId) AS Attempts FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Duyen%' GROUP BY a.FullName;"}
{"question":"Export courses where title contains design and instructor count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%design%' GROUP BY c.Title;"}
{"question":"List students with name starting with Tran and student id and name","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Student' AND FullName LIKE N'Tran%';"}
{"question":"Show courses whose title contains statistics and student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS Students FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%statistics%' GROUP BY c.Title;"}
{"question":"Get instructors whose name ends with Linh and course count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CourseCount FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Linh' GROUP BY a.FullName;"}
{"question":"Find students whose name contains Quyen and average progress","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, ProgressPercent REAL);","answer":"SELECT a.FullName, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Quyen%' GROUP BY a.FullName;"}
{"question":"List courses where title contains android and instructor names","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS InstructorNames FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE c.Title LIKE N'%android%' GROUP BY c.Title;"}
{"question":"Show students whose name contains Tien and joined count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Tien%' GROUP BY a.FullName;"}
{"question":"Export courses with title containing backend and completion ratio","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT c.Title, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%backend%' GROUP BY c.Title;"}
{"question":"List instructors whose name starts with Le and number of courses taught","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CoursesTaught FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'Le%' GROUP BY a.FullName;"}
{"question":"Get students with name containing Bao and attempts count this month","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, SubmittedAt DATETIME2);","answer":"SELECT a.FullName, COUNT(*) AS AttemptsThisMonth FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Bao%' AND YEAR(qa.SubmittedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(qa.SubmittedAt)=MONTH(SYSUTCDATETIME()) GROUP BY a.FullName;"}
{"question":"Find courses where title contains microservices and student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%microservices%' GROUP BY c.Title;"}
{"question":"Show students whose name starts with Hoang and completion count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS Completed FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Hoang%' GROUP BY a.FullName;"}
{"question":"Export courses with title containing analytics and instructor count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%analytics%' GROUP BY c.Title;"}
{"question":"List students whose name ends with An and joined courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%An' GROUP BY a.FullName;"}
{"question":"Get instructors with name containing Thu and course count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CourseCount FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Thu%' GROUP BY a.FullName;"}
{"question":"Find courses where title contains frontend and show id and title","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT CourseId, Title FROM Courses WHERE Title LIKE N'%frontend%';"}
{"question":"Show students whose name contains Nhan and average score","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Nhan%' GROUP BY a.FullName;"}
{"question":"Export courses with title containing csharp and student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%csharp%' GROUP BY c.Title;"}
{"question":"List instructors whose name starts with Phan and number of courses taught","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CoursesTaught FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'Phan%' GROUP BY a.FullName;"}
{"question":"Get students whose name contains Hien and completion rate","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRate FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Hien%' GROUP BY a.FullName;"}
{"question":"Find courses where title contains graphql and instructor names","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS InstructorNames FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE c.Title LIKE N'%graphql%' GROUP BY c.Title;"}
{"question":"Show students whose name starts with Truong and attempts count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(qa.AttemptId) AS Attempts FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Truong%' GROUP BY a.FullName;"}
{"question":"Export courses with title containing nosql and completion ratio","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT c.Title, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%nosql%' GROUP BY c.Title;"}
{"question":"List instructors whose name contains Khoa and course count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CourseCount FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Khoa%' GROUP BY a.FullName;"}
{"question":"Get students with name containing Phuc and joined courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Phuc%' GROUP BY a.FullName;"}
{"question":"Find courses where title contains pipeline and student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS Students FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%pipeline%' GROUP BY c.Title;"}
{"question":"Show students whose name contains Tuan and average progress","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, ProgressPercent REAL);","answer":"SELECT a.FullName, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Tuan%' GROUP BY a.FullName;"}
{"question":"How many students have names starting with A","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(AccountId) AS TotalStudents FROM Accounts WHERE Role = N'Student' AND FullName LIKE N'A%';"},
{"question":"Get the average score for students whose email is on gmail","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CAST(QA.Score AS FLOAT)) AS AverageScore FROM QuizAttempts QA JOIN Accounts A ON QA.AccountId = A.AccountId WHERE A.Email LIKE N'%@gmail.com';"},
{"question":"Find the total number of courses taught by instructors named David","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(C.CourseId) AS TotalCourses FROM Courses C JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.FullName LIKE N'David%';"},
{"question":"Show the completion rate for students whose names end with Smith","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Accounts A LEFT JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.FullName LIKE N'% Smith' GROUP BY A.FullName;"},
{"question":"Count enrollments for students with student.com emails","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(E.EnrollmentId) AS TotalEnrollments FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId WHERE A.Email LIKE N'%@student.com';"},
{"question":"What is the average rating for courses containing SQL","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId WHERE C.Title LIKE N'%SQL%';"},
{"question":"How many students are enrolled in courses about Python","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(E.EnrollmentId) AS TotalEnrollments FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Title LIKE N'%Python%';"},
{"question":"Get the average price for courses that mention Basics","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(C.Price) AS AveragePrice FROM Courses C WHERE C.Title LIKE N'%Basics%';"},
{"question":"Count all video lessons with Introduction in the title","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(LessonId) AS TotalLessons FROM Lessons WHERE LessonType = N'video' AND Title LIKE N'%Introduction%';"},
{"question":"What is the average score on quizzes that contain Final","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CAST(QA.Score AS FLOAT)) AS AverageScore FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = QA.QuizId WHERE Q.Title LIKE N'%Final%';"},
{"question":"Show the total number of lessons for courses about Java","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(L.LessonId) AS TotalLessons FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId WHERE C.Title LIKE N'%Java%';"},
{"question":"Find the completion rate for enrollments in courses containing Advanced","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Title LIKE N'%Advanced%';"},
{"question":"How many quizzes are there for lessons that mention Chapter 1","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT COUNT(Q.QuizId) AS TotalQuizzes FROM Quizzes Q JOIN Lessons L ON Q.LessonId = L.LessonId WHERE L.Title LIKE N'%Chapter 1%';"},
{"question":"Get the total number of questions for quizzes about Data","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);","answer":"SELECT COUNT(QQ.QuestionId) AS TotalQuestions FROM QuizQuestions QQ JOIN Quizzes Q ON QQ.QuizId = Q.QuizId WHERE Q.Title LIKE N'%Data%';"},
{"question":"List all courses containing React and their total enrollments","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title, COUNT(E.EnrollmentId) AS TotalEnrollments FROM Courses C LEFT JOIN Enrollments E ON C.CourseId = E.CourseId WHERE C.Title LIKE N'%React%' GROUP BY C.Title;"},
{"question":"Count 5-star reviews that contain the word excellent","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT COUNT(ReviewId) AS TotalReviews FROM CourseReviews WHERE Rating = 5 AND Comment LIKE N'%excellent%';"},
{"question":"What is the average rating for reviews that mention difficult","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(Rating AS FLOAT)) AS AverageRating FROM CourseReviews WHERE Comment LIKE N'%difficult%';"},
{"question":"How many reviews for SQL courses contain the word helpful","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT COUNT(CR.ReviewId) AS TotalHelpfulReviews FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId WHERE C.Title LIKE N'%SQL%' AND CR.Comment LIKE N'%helpful%';"},
{"question":"Get the total count of 1-star reviews mentioning poor","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT COUNT(ReviewId) AS TotalPoorReviews FROM CourseReviews WHERE Rating = 1 AND Comment LIKE N'%poor%';"},
{"question":"Show the average rating of courses where the summary mentions project","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId WHERE C.Summary LIKE N'%project%';"},
{"question":"Show students named John and their average quiz score","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, AVG(CAST(QA.Score AS FLOAT)) AS AverageScore FROM Accounts A LEFT JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.FullName LIKE N'John%' GROUP BY A.FullName;"},
{"question":"Get the completion rate for students with gmail.com emails","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId WHERE A.Email LIKE N'%@gmail.com';"},
{"question":"List instructors whose names start with M and their average course rating","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT A.FullName, AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId WHERE A.Role = N'Instructor' AND A.FullName LIKE N'M%' GROUP BY A.FullName;"},
{"question":"Find the pass rate for quizzes on Java courses","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) AS PassRate FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId JOIN Courses C ON L.CourseId = C.CourseId WHERE C.Title LIKE N'%Java%';"},
{"question":"Show the 5-star review ratio for courses containing Python","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN CR.Rating = 5 THEN 1.0 ELSE 0.0 END) AS FiveStarRatio FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId WHERE C.Title LIKE N'%Python%';"},
{"question":"Get the total revenue from enrollments for courses mentioning Database","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Title LIKE N'%Database%';"},
{"question":"How many courses containing SQL are taught by instructors named Jane","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(C.CourseId) AS TotalCourses FROM Courses C JOIN Accounts A ON C.InstructorId = A.AccountId WHERE C.Title LIKE N'%SQL%' AND A.FullName LIKE N'Jane%';"},
{"question":"Find the average progress for students whose names start with S on React courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(E.ProgressPercent) AS AverageProgress FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId JOIN Courses C ON E.CourseId = C.CourseId WHERE A.FullName LIKE N'S%' AND C.Title LIKE N'%React%';"},
{"question":"What is the ratio of video lessons in courses that contain Beginner","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN L.LessonType = N'video' THEN 1.0 ELSE 0.0 END) AS VideoLessonRatio FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId WHERE C.Title LIKE N'%Beginner%';"},
{"question":"Count students with edu emails who have a completion rate over 80 percent","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(DISTINCT A.AccountId) AS TotalStudents FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Email LIKE N'%.edu%' GROUP BY A.AccountId HAVING AVG(CAST(E.IsCompleted AS FLOAT)) > 0.8;"},
{"question":"List all courses about Art and their average rating","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title, AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM Courses C LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId WHERE C.Title LIKE N'%Art%' GROUP BY C.Title;"},
{"question":"How many enrollments for courses where summary contains hands-on","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(E.EnrollmentId) AS TotalEnrollments FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Summary LIKE N'%hands-on%';"},
{"question":"Average score for students named Emily on quizzes containing Test","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CAST(QA.Score AS FLOAT)) AS AverageScore FROM QuizAttempts QA JOIN Accounts A ON QA.AccountId = A.AccountId JOIN Quizzes Q ON QA.QuizId = Q.QuizId WHERE A.FullName LIKE N'Emily%' AND Q.Title LIKE N'%Test%';"},
{"question":"Total 5-star reviews for instructors whose name contains Professor","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT COUNT(CR.ReviewId) AS TotalFiveStarReviews FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.FullName LIKE N'%Professor%' AND CR.Rating = 5;"},
{"question":"Ratio of published courses for instructors with school.com emails","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(C.IsPublished AS FLOAT)) AS PublishRate FROM Courses C JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.Email LIKE N'%@school.com';"},
{"question":"Total lessons for courses containing JavaScript","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(L.LessonId) AS TotalLessons FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId WHERE C.Title LIKE N'%JavaScript%';"},
{"question":"Average completion rate for courses in categories matching Web","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId JOIN Categories CAT ON C.CategoryId = CAT.CategoryId WHERE CAT.Name LIKE N'%Web%';"},
{"question":"Total quiz attempts for courses containing C sharp","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(QA.AttemptId) AS TotalAttempts FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId JOIN Courses C ON L.CourseId = L.CourseId WHERE C.Title LIKE N'%C sharp%';"},
{"question":"Find 1-star reviews for courses mentioning Basics","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT CR.* FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId WHERE C.Title LIKE N'%Basics%' AND CR.Rating = 1;"},
{"question":"Percentage of active students whose full name contains Lee","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(A.IsActive AS FLOAT)) * 100 AS ActivePercentage FROM Accounts A WHERE A.Role = N'Student' AND A.FullName LIKE N'%Lee%';"},
{"question":"List all student names that contain 'Ann'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT FullName FROM Accounts WHERE Role = N'Student' AND FullName LIKE N'%Ann%';"},
{"question":"Show all course titles that start with 'Intro'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Title FROM Courses WHERE Title LIKE N'Intro%';"},
{"question":"Get all lesson titles that contain 'Setup'","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT Title FROM Lessons WHERE Title LIKE N'%Setup%';"},
{"question":"Find all quiz titles that end with 'Review'","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT Title FROM Quizzes WHERE Title LIKE N'%Review';"},
{"question":"List all review comments that mention 'amazing'","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT Comment FROM CourseReviews WHERE Comment LIKE N'%amazing%';"},
{"question":"Show all category names that contain 'Data'","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));","answer":"SELECT Name FROM Categories WHERE Name LIKE N'%Data%';"},
{"question":"Get all instructor names that start with 'Dr'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT FullName FROM Accounts WHERE Role = N'Instructor' AND FullName LIKE N'Dr%';"},
{"question":"Find all courses where the summary contains 'beginner friendly'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT Title, Summary FROM Courses WHERE Summary LIKE N'%beginner friendly%';"},
{"question":"List all quiz questions that start with 'What is'","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);","answer":"SELECT Question FROM QuizQuestions WHERE Question LIKE N'What is%';"},
{"question":"Show all student emails that contain 'test'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT Email FROM Accounts WHERE Role = N'Student' AND Email LIKE N'%test%';"},
{"question":"Get average rating for courses taught by instructors with 'edu' emails","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.Email LIKE N'%.edu';"},
{"question":"Count enrollments for courses in categories containing 'Software'","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(E.EnrollmentId) AS TotalEnrollments FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId JOIN Categories CAT ON C.CategoryId = CAT.CategoryId WHERE CAT.Name LIKE N'%Software%';"},
{"question":"Find the total revenue from students whose names contain 'Alex'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId JOIN Courses C ON E.CourseId = C.CourseId WHERE A.FullName LIKE N'%Alex%';"},
{"question":"What is the average score for quizzes containing 'Module 1'","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CAST(QA.Score AS FLOAT)) AS AverageScore FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId WHERE Q.Title LIKE N'%Module 1%';"},
{"question":"List courses containing 'Marketing' and their 5-star review count","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title, COUNT(CR.ReviewId) AS FiveStarReviews FROM Courses C LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId WHERE C.Title LIKE N'%Marketing%' AND CR.Rating = 5 GROUP BY C.Title;"},
{"question":"Get the pass rate for students whose names start with 'B'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) AS PassRate FROM QuizAttempts QA JOIN Accounts A ON QA.AccountId = A.AccountId WHERE A.FullName LIKE N'B%';"},
{"question":"Find the ratio of 'text' lessons in courses containing 'Full Stack'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN L.LessonType = N'text' THEN 1.0 ELSE 0.0 END) AS TextLessonRatio FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId WHERE C.Title LIKE N'%Full Stack%';"},
{"question":"How many completed enrollments for courses mentioning 'Cloud'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(E.EnrollmentId) AS TotalCompleted FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Title LIKE N'%Cloud%' AND E.IsCompleted = 1;"},
{"question":"Get the average rating from reviews that mention 'waste of time'","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(Rating AS FLOAT)) AS AverageRating FROM CourseReviews WHERE Comment LIKE N'%waste of time%';"},
{"question":"Count total quiz questions for lessons containing 'Security'","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);","answer":"SELECT COUNT(QQ.QuestionId) AS TotalQuestions FROM QuizQuestions QQ JOIN Quizzes Q ON QQ.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId WHERE L.Title LIKE N'%Security%';"},
{"question":"Find the total revenue from students with 'hotmail.com' emails","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId JOIN Courses C ON E.CourseId = C.CourseId WHERE A.Email LIKE N'%@hotmail.com';"},
{"question":"Show instructors named 'Chris' and their total published courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName, COUNT(C.CourseId) AS TotalPublished FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId WHERE A.FullName LIKE N'Chris%' AND C.IsPublished = 1 GROUP BY A.FullName;"},
{"question":"What is the average rating for instructors whose names contain 'Ph D'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.FullName LIKE N'%Ph D%';"},
{"question":"Count students named 'Alex' who have completed 100 percent of their courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(DISTINCT A.AccountId) AS TotalStudents FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.FullName LIKE N'Alex%' AND A.Role = N'Student' GROUP BY A.AccountId HAVING MIN(CAST(E.IsCompleted AS INT)) = 1;"},
{"question":"Get the ratio of free courses that contain 'Guide' in the title","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN C.Price = 0 THEN 1.0 ELSE 0.0 END) AS FreeCourseRatio FROM Courses C WHERE C.Title LIKE N'%Guide%';"},
{"question":"Find the average score for quizzes in lessons titled 'First Steps'","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CAST(QA.Score AS FLOAT)) AS AverageScore FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId WHERE L.Title LIKE N'%First Steps%';"},
{"question":"List categories containing 'Design' and their total number of lessons","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT CAT.Name, COUNT(L.LessonId) AS TotalLessons FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId JOIN Categories CAT ON C.CategoryId = CAT.CategoryId WHERE CAT.Name LIKE N'%Design%' GROUP BY CAT.Name;"},
{"question":"How many active students are named 'Sarah'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(AccountId) AS TotalStudents FROM Accounts WHERE Role = N'Student' AND IsActive = 1 AND FullName LIKE N'Sarah%';"},
{"question":"Get the total count of enrollments for courses mentioning 'Java' or 'Python'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(E.EnrollmentId) AS TotalEnrollments FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Title LIKE N'%Java%' OR C.Title LIKE N'%Python%';"},
{"question":"Find the average rating for reviews containing 'good' but not 'excellent'","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(Rating AS FLOAT)) AS AverageRating FROM CourseReviews WHERE Comment LIKE N'%good%' AND Comment NOT LIKE N'%excellent%';"},
{"question":"Show the total revenue from instructors whose names contain 'Smith'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.FullName LIKE N'%Smith%';"},
{"question":"How many 'video' lessons are in courses mentioning 'Framework'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(L.LessonId) AS TotalVideoLessons FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId WHERE C.Title LIKE N'%Framework%' AND L.LessonType = N'video';"},
{"question":"Get the average quiz score for students whose emails end in '.org'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CAST(QA.Score AS FLOAT)) AS AverageScore FROM QuizAttempts QA JOIN Accounts A ON QA.AccountId = A.AccountId WHERE A.Email LIKE N'%.org';"},
{"question":"List all students named 'Robert' and their enrollment completion rate","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Accounts A LEFT JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.FullName LIKE N'Robert%' GROUP BY A.FullName;"},
{"question":"Find the pass rate for quizzes in lessons containing 'Advanced Topic'","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) AS PassRate FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId WHERE L.Title LIKE N'%Advanced Topic%';"},
{"question":"Show the 1-star review ratio for courses taught by instructors named 'Michael'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN CR.Rating = 1 THEN 1.0 ELSE 0.0 END) AS OneStarRatio FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.FullName LIKE N'Michael%';"},
{"question":"How many courses containing 'API' are in the 'Backend' category","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(C.CourseId) AS TotalCourses FROM Courses C JOIN Categories CAT ON C.CategoryId = CAT.CategoryId WHERE C.Title LIKE N'%API%' AND CAT.Name = N'Backend';"},
{"question":"List instructors containing 'Dr' and their average course price","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName, AVG(C.Price) AS AveragePrice FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId WHERE A.FullName LIKE N'%Dr%' GROUP BY A.FullName;"},
{"question":"Get the total number of quiz questions for courses mentioning 'Management'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);","answer":"SELECT COUNT(QQ.QuestionId) AS TotalQuestions FROM QuizQuestions QQ JOIN Quizzes Q ON QQ.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId JOIN Courses C ON L.CourseId = L.CourseId WHERE C.Title LIKE N'%Management%';"},
{"question":"Find the average progress for students with 'uk' emails","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT AVG(E.ProgressPercent) AS AverageProgress FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId WHERE A.Email LIKE N'%.uk';"},
{"question":"How many 5-star reviews were written by students named 'James'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT COUNT(CR.ReviewId) AS TotalReviews FROM CourseReviews CR JOIN Accounts A ON CR.AccountId = A.AccountId WHERE A.FullName LIKE N'James%' AND CR.Rating = 5;"},
{"question":"List courses containing 'Marketing' and their average rating","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title, AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM Courses C LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId WHERE C.Title LIKE N'%Marketing%' GROUP BY C.Title;"},
{"question":"Get the completion rate for courses taught by instructors named 'Anna'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.FullName LIKE N'Anna%';"},
{"question":"Find the ratio of 'quiz' lessons for courses mentioning 'Project'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN L.LessonType = N'quiz' THEN 1.0 ELSE 0.0 END) AS QuizLessonRatio FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId WHERE C.Title LIKE N'%Project%';"},
{"question":"How many quiz attempts with scores over 80 are from students named 'Maria'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(QA.AttemptId) AS TotalAttempts FROM QuizAttempts QA JOIN Accounts A ON QA.AccountId = A.AccountId WHERE A.FullName LIKE N'Maria%' AND QA.Score > 80;"},
{"question":"Show the total revenue from students whose names contain 'J' or 'K'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId JOIN Courses C ON E.CourseId = C.CourseId WHERE A.FullName LIKE N'J%' OR A.FullName LIKE N'K%';"},
{"question":"What is the average rating for reviews containing 'easy' or 'simple'","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(Rating AS FLOAT)) AS AverageRating FROM CourseReviews WHERE Comment LIKE N'%easy%' OR Comment LIKE N'%simple%';"},
{"question":"Count total quiz questions for courses taught by instructors with 'edu' emails","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);","answer":"SELECT COUNT(QQ.QuestionId) AS TotalQuestions FROM QuizQuestions QQ JOIN Quizzes Q ON QQ.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId JOIN Courses C ON L.CourseId = C.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.Email LIKE N'%.edu';"},
{"question":"List courses containing 'AI' and their average enrollment progress","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title, AVG(E.ProgressPercent) AS AverageProgress FROM Courses C LEFT JOIN Enrollments E ON C.CourseId = E.CourseId WHERE C.Title LIKE N'%AI%' GROUP BY C.Title;"},
{"question":"How many students named 'Peter' have a completion rate below 50 percent","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(DISTINCT A.AccountId) AS TotalStudents FROM Accounts A JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.FullName LIKE N'Peter%' GROUP BY A.AccountId HAVING AVG(CAST(E.IsCompleted AS FLOAT)) < 0.5;"},
{"question":"Get the pass rate for quizzes containing 'Final' for students with 'gmail' emails","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) AS PassRate FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId JOIN Accounts A ON QA.AccountId = A.AccountId WHERE Q.Title LIKE N'%Final%' AND A.Email LIKE N'%gmail%';"},
{"question":"Show the ratio of 5-star reviews for courses where the summary mentions 'expert'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN CR.Rating = 5 THEN 1.0 ELSE 0.0 END) AS FiveStarRatio FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId WHERE C.Summary LIKE N'%expert%';"},
{"question":"How many courses mentioning 'Security' are taught by instructors named 'Admin'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(C.CourseId) AS TotalCourses FROM Courses C JOIN Accounts A ON C.InstructorId = A.AccountId WHERE C.Title LIKE N'%Security%' AND A.FullName LIKE N'Admin%';"},
{"question":"Find the total revenue from students whose names contain 'Robert' for courses on 'Finance'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId JOIN Courses C ON E.CourseId = C.CourseId WHERE A.FullName LIKE N'%Robert%' AND C.Title LIKE N'%Finance%';"},
{"question":"Get the average rating for reviews containing 'excellent' from students named 'Laura'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM CourseReviews CR JOIN Accounts A ON CR.AccountId = A.AccountId WHERE A.FullName LIKE N'Laura%' AND CR.Comment LIKE N'%excellent%';"},
{"question":"What is the completion rate for enrollments in courses containing 'Full Stack'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Title LIKE N'%Full Stack%';"}
{"question":"List students whose name contains Tien and show id and name","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Student' AND FullName LIKE N'%Tien%';"}
{"question":"Show students with names starting with Anh and include joined count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS JoinedCount FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Anh%' GROUP BY a.FullName;"}
{"question":"Get instructors whose name ends with Hoa and return id and name","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Hoa';"}
{"question":"Find instructors whose name contains Quoc and show course count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CourseCount FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Quoc%' GROUP BY a.FullName;"}
{"question":"List courses whose title contains graphql and return id and title","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT CourseId, Title FROM Courses WHERE Title LIKE N'%graphql%';"}
{"question":"Show courses with titles starting with Modern and include student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'Modern%' GROUP BY c.Title;"}
{"question":"Get courses whose title ends with essentials and list id and title","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT CourseId, Title FROM Courses WHERE Title LIKE N'%essentials';"}
{"question":"Find courses whose title contains clean code and show student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS Students FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%clean code%' GROUP BY c.Title;"}
{"question":"List students with name containing Binh and average progress","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, ProgressPercent REAL);","answer":"SELECT a.FullName, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Binh%' GROUP BY a.FullName;"}
{"question":"Show students whose name contains Thanh and joined courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Thanh%' GROUP BY a.FullName;"}
{"question":"Get instructors whose name contains Trung and show id and name","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Trung%';"}
{"question":"Find instructors with name starting with Vo and course count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CourseCount FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'Vo%' GROUP BY a.FullName;"}
{"question":"List courses with titles containing kubernetes and student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%kubernetes%' GROUP BY c.Title;"}
{"question":"Show course id and title for titles that start with Build","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT CourseId, Title FROM Courses WHERE Title LIKE N'Build%';"}
{"question":"Get courses where title ends with pro and include instructor count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%pro' GROUP BY c.Title;"}
{"question":"Find courses with title containing docker and average progress","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);","answer":"SELECT c.Title, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%docker%' GROUP BY c.Title;"}
{"question":"List students whose name contains Chau and attempts count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(qa.AttemptId) AS Attempts FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Chau%' GROUP BY a.FullName;"}
{"question":"Show students whose name ends with Nam and completed courses count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS Completed FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Nam' GROUP BY a.FullName;"}
{"question":"Get instructors whose name contains Phu and list course count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CourseCount FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Phu%' GROUP BY a.FullName;"}
{"question":"Find courses whose title contains data warehouse and student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS Students FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%data warehouse%' GROUP BY c.Title;"}
{"question":"List courses with title starting with Hands On and instructor names","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS InstructorNames FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE c.Title LIKE N'Hands On%' GROUP BY c.Title;"}
{"question":"Show students whose name contains Tam and average score","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Tam%' GROUP BY a.FullName;"}
{"question":"Get students with names starting with Nhat and joined count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Nhat%' GROUP BY a.FullName;"}
{"question":"Find instructors whose name contains My and list id and name","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%My%';"}
{"question":"List courses with title containing big data and completion ratio","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT c.Title, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%big data%' GROUP BY c.Title;"}
{"question":"Show courses whose title contains sql server and student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS Students FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%sql server%' GROUP BY c.Title;"}
{"question":"Get courses whose title ends with basics and instructor count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%basics' GROUP BY c.Title;"}
{"question":"Find courses with title starting with Learn and average progress","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);","answer":"SELECT c.Title, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'Learn%' GROUP BY c.Title;"}
{"question":"List students whose name contains Hanh and attempts this month","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, SubmittedAt DATETIME2);","answer":"SELECT a.FullName, COUNT(*) AS AttemptsThisMonth FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Hanh%' AND YEAR(qa.SubmittedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(qa.SubmittedAt)=MONTH(SYSUTCDATETIME()) GROUP BY a.FullName;"}
{"question":"Show students with names ending with Anh and joined courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Anh' GROUP BY a.FullName;"}
{"question":"Get instructors whose name contains Kiet and course count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CourseCount FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Kiet%' GROUP BY a.FullName;"}
{"question":"Find courses where title contains deep learning and student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%deep learning%' GROUP BY c.Title;"}
{"question":"List courses with titles starting with Foundations and instructor names","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS Instructors FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE c.Title LIKE N'Foundations%' GROUP BY c.Title;"}
{"question":"Show students whose name contains Phat and average score","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Phat%' GROUP BY a.FullName;"}
{"question":"Get students with names starting with Danh and completion count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS Completed FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Danh%' GROUP BY a.FullName;"}
{"question":"Find instructors whose name contains Loan and list id and name","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Loan%';"}
{"question":"List courses where title contains elasticsearch and completion ratio","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT c.Title, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%elasticsearch%' GROUP BY c.Title;"}
{"question":"Show courses whose title starts with Practical and student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS Students FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'Practical%' GROUP BY c.Title;"}
{"question":"Get courses with titles ending with guide and instructor count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%guide' GROUP BY c.Title;"}
{"question":"Find courses where title contains ui design and average progress","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);","answer":"SELECT c.Title, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%ui design%' GROUP BY c.Title;"}
{"question":"List students whose name contains Bao and attempts count this week","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, SubmittedAt DATETIME2);","answer":"SELECT a.FullName, COUNT(CASE WHEN DATEDIFF(WEEK, qa.SubmittedAt, SYSUTCDATETIME())=0 THEN 1 END) AS AttemptsThisWeek FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Bao%' GROUP BY a.FullName;"}
{"question":"Show students whose name ends with Thu and joined courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Thu' GROUP BY a.FullName;"}
{"question":"Get instructors whose name contains Quynh and course count taught","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CoursesTaught FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Quynh%' GROUP BY a.FullName;"}
{"question":"Find courses where title contains time series and student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%time series%' GROUP BY c.Title;"}
{"question":"List courses with title starting with Introductory and instructor names","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS Instructors FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE c.Title LIKE N'Introductory%' GROUP BY c.Title;"}
{"question":"Show students whose name contains Hai and average quiz score","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Hai%' GROUP BY a.FullName;"}
{"question":"Get students with names starting with Khoa and completion rate","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRate FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Khoa%' GROUP BY a.FullName;"}
{"question":"Find instructors whose name contains Phuong and list id and name","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Phuong%';"}
{"question":"List courses where title contains refactoring and completion ratio","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT c.Title, AVG(CAST(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END AS DECIMAL(10,2))) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%refactoring%' GROUP BY c.Title;"}
{"question":"Show courses with titles starting with Mastering and student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS Students FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'Mastering%' GROUP BY c.Title;"}
{"question":"Get courses whose title ends with workshop and instructor count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%workshop' GROUP BY c.Title;"}
{"question":"Find courses where title contains interview prep and average progress","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);","answer":"SELECT c.Title, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%interview prep%' GROUP BY c.Title;"}
{"question":"List students whose name contains Nhi and attempts count this month","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, SubmittedAt DATETIME2);","answer":"SELECT a.FullName, COUNT(*) AS AttemptsThisMonth FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Nhi%' AND YEAR(qa.SubmittedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(qa.SubmittedAt)=MONTH(SYSUTCDATETIME()) GROUP BY a.FullName;"}
{"question":"Show students whose name ends with Phuoc and joined courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Phuoc' GROUP BY a.FullName;"}
{"question":"Get instructors whose name contains Luu and courses taught count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CoursesTaught FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Luu%' GROUP BY a.FullName;"}
{"question":"Find courses where title contains concurrency and student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS Students FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%concurrency%' GROUP BY c.Title;"}
{"question":"List courses with titles starting with Applied and instructor names","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS InstructorNames FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE c.Title LIKE N'Applied%' GROUP BY c.Title;"}
{"question":"Show students whose name contains Khanh and average score overall","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Khanh%' GROUP BY a.FullName;"}
{"question":"Get students with names starting with Ngan and completion count total","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS Completed FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Ngan%' GROUP BY a.FullName;"}
{"question":"Find instructors whose name contains Tu and show id and name only","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Tu%';"}
{"question":"List courses where title contains objective c and completion ratio value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT c.Title, AVG(CAST(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END AS DECIMAL(10,2))) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%objective c%' GROUP BY c.Title;"}
{"question":"Show courses with titles starting with Getting Started and student count value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'Getting Started%' GROUP BY c.Title;"}
{"question":"Get courses whose title ends with lab and instructor count value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%lab' GROUP BY c.Title;"}
{"question":"Find courses where title contains automation testing and average progress value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);","answer":"SELECT c.Title, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%automation testing%' GROUP BY c.Title;"}
{"question":"List students whose name contains Tien and attempts count overall","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(qa.AttemptId) AS Attempts FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Tien%' GROUP BY a.FullName;"}
{"question":"Show students whose name ends with Giang and joined courses number","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Giang' GROUP BY a.FullName;"}
{"question":"Get instructors whose name contains Truong and courses taught number","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CoursesTaught FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Truong%' GROUP BY a.FullName;"}
{"question":"Find courses where title contains distributed systems and student count number","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%distributed systems%' GROUP BY c.Title;"}
{"question":"List courses with titles starting with Professional and instructor names list","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS InstructorNames FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE c.Title LIKE N'Professional%' GROUP BY c.Title;"}
{"question":"Show students whose name contains Loc and average score number","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Loc%' GROUP BY a.FullName;"}
{"question":"Get students with names starting with Kim and completion rate number","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRate FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Kim%' GROUP BY a.FullName;"}
{"question":"Find instructors whose name contains Cuong and show id and name set","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Cuong%';"}
{"question":"List courses where title contains agile scrum and completion ratio number","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT c.Title, AVG(CAST(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END AS DECIMAL(10,2))) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%agile scrum%' GROUP BY c.Title;"}
{"question":"Show courses with titles starting with Advanced and student count number","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'Advanced%' GROUP BY c.Title;"}
{"question":"Get courses whose title ends with reference and instructor count number","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%reference' GROUP BY c.Title;"}
{"question":"Find courses where title contains security testing and average progress number","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);","answer":"SELECT c.Title, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%security testing%' GROUP BY c.Title;"}
{"question":"List students whose name contains Vy and attempts count total number","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(qa.AttemptId) AS Attempts FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Vy%' GROUP BY a.FullName;"}
{"question":"Show students whose name ends with Quang and joined courses number value","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Quang' GROUP BY a.FullName;"}
{"question":"Get instructors whose name contains Nhan and course count value metric","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CourseCount FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Nhan%' GROUP BY a.FullName;"}
{"question":"Find courses where title contains programming language and student count metric","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%programming language%' GROUP BY c.Title;"}
{"question":"List courses with titles starting with Essential and instructor names metric","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS InstructorNames FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE c.Title LIKE N'Essential%' GROUP BY c.Title;"}
{"question":"Show students whose name contains Y and average score metric overall","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Y%' GROUP BY a.FullName;"}
{"question":"Get students with names starting with Mai and completion rate metric value","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRate FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Mai%' GROUP BY a.FullName;"}
{"question":"Find instructors whose name contains Thinh and show id and name listing","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Thinh%';"}
{"question":"List courses where title contains cloud native and completion ratio metric value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT c.Title, AVG(CAST(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END AS DECIMAL(10,2))) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%cloud native%' GROUP BY c.Title;"}
{"question":"Show courses with titles starting with Practical Guide and student count metric value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'Practical Guide%' GROUP BY c.Title;"}
{"question":"Get courses whose title ends with cookbook and instructor count metric value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%cookbook' GROUP BY c.Title;"}
{"question":"Find courses where title contains graph algorithms and average progress metric value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);","answer":"SELECT c.Title, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%graph algorithms%' GROUP BY c.Title;"}
{"question":"List students whose name contains Uyen and attempts count metric overall","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(qa.AttemptId) AS Attempts FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Uyen%' GROUP BY a.FullName;"}
{"question":"Show students whose name ends with Vy and joined courses metric overall","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Vy' GROUP BY a.FullName;"}
{"question":"Get instructors whose name contains Ngoc and course count metric overall","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CourseCount FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Ngoc%' GROUP BY a.FullName;"}
{"question":"Find courses where title contains reinforcement learning and student count metric overall","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%reinforcement learning%' GROUP BY c.Title;"}
{"question":"List courses with titles starting with Clean Architecture and instructor names list output","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS InstructorNames FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE c.Title LIKE N'Clean Architecture%' GROUP BY c.Title;"}
{"question":"Show students whose name contains Hang and average score metric output","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Hang%' GROUP BY a.FullName;"}
{"question":"Get students with names starting with Xuan and completion rate metric output","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRate FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Xuan%' GROUP BY a.FullName;"}
{"question":"Find instructors whose name contains Duy and list id and name output only","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Duy%';"}
{"question":"List courses where title contains software testing and completion ratio metric output","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT c.Title, AVG(CAST(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END AS DECIMAL(10,2))) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%software testing%' GROUP BY c.Title;"}
{"question":"Show courses with titles starting with Quick Start and student count metric output","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'Quick Start%' GROUP BY c.Title;"}
{"question":"Get courses whose title ends with notes and instructor count metric output","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%notes' GROUP BY c.Title;"}
{"question":"Find courses where title contains micro frontend and average progress metric output","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);","answer":"SELECT c.Title, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%micro frontend%' GROUP BY c.Title;"}
{"question":"List students whose name contains Thuy and attempts count metric output total","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(qa.AttemptId) AS Attempts FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Thuy%' GROUP BY a.FullName;"}
{"question":"Show students whose name ends with Hieu and joined courses metric output sum","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Hieu' GROUP BY a.FullName;"}
{"question":"Get instructors whose name contains Thao and courses taught metric output sum","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CoursesTaught FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Thao%' GROUP BY a.FullName;"}
{"question":"Find courses where title contains service mesh and student count metric output sum","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%service mesh%' GROUP BY c.Title;"}
{"question":"List courses with titles starting with Pattern and instructor names metric output list","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS InstructorNames FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE c.Title LIKE N'Pattern%' GROUP BY c.Title;"}
{"question":"Show students whose name contains Thuong and average score metric output avg","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Thuong%' GROUP BY a.FullName;"}
{"question":"Get students with names starting with Huu and completion rate metric output avg","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRate FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Huu%' GROUP BY a.FullName;"}
{"question":"Find instructors whose name contains Quoc Anh and list id and name metric output","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Quoc Anh%';"}
{"question":"List courses where title contains natural language and completion ratio metric output","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT c.Title, AVG(CAST(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END AS DECIMAL(10,2))) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%natural language%' GROUP BY c.Title;"}
{"question":"Show courses with titles starting with Ultimate and student count metric output total","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'Ultimate%' GROUP BY c.Title;"}
{"question":"Get courses whose title ends with handbook and instructor count metric output total","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%handbook' GROUP BY c.Title;"}
{"question":"Find courses where title contains prompt engineering and average progress metric output total","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);","answer":"SELECT c.Title, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%prompt engineering%' GROUP BY c.Title;"}
{"question":"List students whose name contains Linh and attempts count metric output total value","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(qa.AttemptId) AS Attempts FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Linh%' GROUP BY a.FullName;"}
{"question":"Show students whose name ends with Tinh and joined courses metric output total value","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Tinh' GROUP BY a.FullName;"}
{"question":"Get instructors whose name contains Dung and course count metric output total value","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CourseCount FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Dung%' GROUP BY a.FullName;"}
{"question":"Find courses where title contains streaming and student count metric output total value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%streaming%' GROUP BY c.Title;"}
{"question":"List courses with titles starting with Core and instructor names metric output total list","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS InstructorNames FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE c.Title LIKE N'Core%' GROUP BY c.Title;"}
{"question":"Show students whose name contains Dat and average score metric output total value","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Dat%' GROUP BY a.FullName;"}
{"question":"Get students with names starting with Phu and completion rate metric output total value","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRate FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Phu%' GROUP BY a.FullName;"}
{"question":"Find instructors whose name contains Hoai and show id and name metric output plain","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Hoai%';"}
{"question":"List courses where title contains event driven and completion ratio metric output value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT c.Title, AVG(CAST(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END AS DECIMAL(10,2))) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%event driven%' GROUP BY c.Title;"}
{"question":"Show courses with titles starting with Spring Boot and student count metric output value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'Spring Boot%' GROUP BY c.Title;"}
{"question":"Get courses whose title ends with primer and instructor count metric output value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%primer' GROUP BY c.Title;"}
{"question":"Find courses where title contains message queue and average progress metric output value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);","answer":"SELECT c.Title, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%message queue%' GROUP BY c.Title;"}
{"question":"List students whose name contains Bao Tran and attempts count metric output value total","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(qa.AttemptId) AS Attempts FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Bao Tran%' GROUP BY a.FullName;"}
{"question":"Show students whose name ends with Phong and joined courses metric output value total","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Phong' GROUP BY a.FullName;"}
{"question":"Get instructors whose name contains Thien and course count metric output value total","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CourseCount FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Thien%' GROUP BY a.FullName;"}
{"question":"Find courses where title contains recommendation system and student count metric output value total","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%recommendation system%' GROUP BY c.Title;"}
{"question":"List courses with titles starting with Functional and instructor names metric output value total list","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS InstructorNames FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE c.Title LIKE N'Functional%' GROUP BY c.Title;"}
{"question":"Show students whose name contains Khang and average score metric output value total avg","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Khang%' GROUP BY a.FullName;"}
{"question":"Get students with names starting with Hanh and completion rate metric output value total avg","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRate FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Hanh%' GROUP BY a.FullName;"}
{"question":"How many students have names starting with J","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(AccountId) AS TotalStudents FROM Accounts WHERE Role = N'Student' AND FullName LIKE N'J%';"},
{"question":"What is the average price for courses containing SQL","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(Price) AS AveragePrice FROM Courses WHERE Title LIKE N'%SQL%';"},
{"question":"Get the completion rate for courses about Python","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Title LIKE N'%Python%';"},
{"question":"Find the total number of reviews for courses taught by instructor Ben","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT COUNT(CR.ReviewId) AS TotalReviews FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.FullName LIKE N'Ben%';"},
{"question":"List courses about Management and their average rating","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title, AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM Courses C LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId WHERE C.Title LIKE N'%Management%' GROUP BY C.Title;"},
{"question":"Show the pass rate for quizzes containing Module 2","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) AS PassRate FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId WHERE Q.Title LIKE N'%Module 2%';"},
{"question":"How many active instructors have names starting with D","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(AccountId) AS TotalInstructors FROM Accounts WHERE Role = N'Instructor' AND IsActive = 1 AND FullName LIKE N'D%';"},
{"question":"Get the total revenue from students with edu emails","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId JOIN Courses C ON E.CourseId = C.CourseId WHERE A.Email LIKE N'%.edu';"},
{"question":"What is the 5-star review ratio for courses mentioning project","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN CR.Rating = 5 THEN 1.0 ELSE 0.0 END) AS FiveStarRatio FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId WHERE C.Summary LIKE N'%project%';"},
{"question":"Count 1-star reviews that contain the word bad","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT COUNT(ReviewId) AS TotalBadReviews FROM CourseReviews WHERE Rating = 1 AND Comment LIKE N'%bad%';"},
{"question":"Show the average price for courses in categories containing Design","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(C.Price) AS AveragePrice FROM Courses C JOIN Categories CAT ON C.CategoryId = CAT.CategoryId WHERE CAT.Name LIKE N'%Design%';"},
{"question":"List students named Maria and their average progress","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, AVG(E.ProgressPercent) AS AverageProgress FROM Accounts A LEFT JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.FullName LIKE N'Maria%' GROUP BY A.FullName;"},
{"question":"How many total lessons are in courses mentioning 'Full Stack'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(L.LessonId) AS TotalLessons FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId WHERE C.Title LIKE N'%Full Stack%';"},
{"question":"Find the ratio of text lessons for courses about 'Cloud'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN L.LessonType = N'text' THEN 1.0 ELSE 0.0 END) AS TextLessonRatio FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId WHERE C.Title LIKE N'%Cloud%';"},
{"question":"Get the total number of quiz attempts for lessons containing 'Introduction'","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(QA.AttemptId) AS TotalAttempts FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId WHERE L.Title LIKE N'%Introduction%';"},
{"question":"Count quiz questions that contain the word 'which'","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);","answer":"SELECT COUNT(QuestionId) AS TotalQuestions FROM QuizQuestions WHERE Question LIKE N'%which%';"},
{"question":"Show the average rating for reviews from students named 'Chris'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM CourseReviews CR JOIN Accounts A ON CR.AccountId = A.AccountId WHERE A.FullName LIKE N'Chris%';"},
{"question":"List courses containing 'Data' and their total enrollments","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title, COUNT(E.EnrollmentId) AS TotalEnrollments FROM Courses C LEFT JOIN Enrollments E ON C.CourseId = E.CourseId WHERE C.Title LIKE N'%Data%' GROUP BY C.Title;"},
{"question":"Get the 1-star review ratio for courses taught by instructors named 'Paul'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN CR.Rating = 1 THEN 1.0 ELSE 0.0 END) AS OneStarRatio FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.FullName LIKE N'Paul%';"},
{"question":"How many students with 'uk' emails are enrolled in 'Finance' courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(DISTINCT E.AccountId) AS TotalStudents FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId JOIN Courses C ON E.CourseId = C.CourseId WHERE A.Email LIKE N'%.uk' AND C.Title LIKE N'%Finance%';"},
{"question":"List courses mentioning 'Art' and their average rating","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title, AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM Courses C LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId WHERE C.Title LIKE N'%Art%' GROUP BY C.Title;"},
{"question":"What is the total revenue from courses containing 'Machine Learning'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Title LIKE N'%Machine Learning%';"},
{"question":"How many 'video' lessons are in courses about 'JavaScript'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(L.LessonId) AS TotalVideoLessons FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId WHERE C.Title LIKE N'%JavaScript%' AND L.LessonType = N'video';"},
{"question":"Get the pass rate for students whose names contain 'Lee'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) AS PassRate FROM QuizAttempts QA JOIN Accounts A ON QA.AccountId = A.AccountId WHERE A.FullName LIKE N'%Lee%';"},
{"question":"Show the 1-star review ratio for courses containing 'Guide'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN CR.Rating = 1 THEN 1.0 ELSE 0.0 END) AS OneStarRatio FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId WHERE C.Title LIKE N'%Guide%';"},
{"question":"Count students named 'Anna' who completed courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(DISTINCT E.AccountId) AS TotalStudents FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId WHERE A.FullName LIKE N'Anna%' AND E.IsCompleted = 1;"},
{"question":"What is the average price for courses starting with 'Learn'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(Price) AS AveragePrice FROM Courses WHERE Title LIKE N'Learn%';"},
{"question":"How many 'text' lessons are in courses taught by instructor 'Emily'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(L.LessonId) AS TotalTextLessons FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.FullName LIKE N'Emily%' AND L.LessonType = N'text';"},
{"question":"Get the total number of quiz attempts for courses containing 'Security'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(QA.AttemptId) AS TotalAttempts FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId JOIN Courses C ON L.CourseId = L.CourseId WHERE C.Title LIKE N'%Security%';"},
{"question":"Find the average rating for reviews containing 'awesome'","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(Rating AS FLOAT)) AS AverageRating FROM CourseReviews WHERE Comment LIKE N'%awesome%';"},
{"question":"List all students with 'edu' emails and their average progress","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, AVG(E.ProgressPercent) AS AverageProgress FROM Accounts A LEFT JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Email LIKE N'%.edu' GROUP BY A.FullName;"},
{"question":"How many quiz attempts with scores over 90 are for 'SQL' quizzes","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(QA.AttemptId) AS TotalAttempts FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId WHERE Q.Title LIKE N'%SQL%' AND QA.Score > 90;"},
{"question":"Get the completion rate for students whose names contain 'Kim'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId WHERE A.FullName LIKE N'%Kim%';"},
{"question":"List courses containing 'Marketing' and their instructor name","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT C.Title, A.FullName FROM Courses C JOIN Accounts A ON C.InstructorId = A.AccountId WHERE C.Title LIKE N'%Marketing%';"},
{"question":"Show total enrollments for courses starting with 'Advanced'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(E.EnrollmentId) AS TotalEnrollments FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Title LIKE N'Advanced%';"},
{"question":"What is the average rating given by students with 'yahoo.com' emails","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM CourseReviews CR JOIN Accounts A ON CR.AccountId = A.AccountId WHERE A.Email LIKE N'%@yahoo.com';"},
{"question":"How many 'quiz' lessons are in courses containing 'Data'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(L.LessonId) AS TotalQuizLessons FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId WHERE C.Title LIKE N'%Data%' AND L.LessonType = N'quiz';"},
{"question":"Get the pass rate for quizzes containing 'Part 1'","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) AS PassRate FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId WHERE Q.Title LIKE N'%Part 1%';"},
{"question":"Show the 5-star review count for courses mentioning 'UX Design'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT COUNT(CR.ReviewId) AS FiveStarReviews FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId WHERE C.Title LIKE N'%UX Design%' AND CR.Rating = 5;"},
{"question":"List students named 'Tom' and their total completed courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, SUM(CASE WHEN E.IsCompleted = 1 THEN 1 ELSE 0 END) AS TotalCompleted FROM Accounts A LEFT JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.FullName LIKE N'Tom%' GROUP BY A.FullName;"},
{"question":"How many courses contain 'JavaScript' or 'JS'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(CourseId) AS TotalCourses FROM Courses WHERE Title LIKE N'%JavaScript%' OR Title LIKE N'%JS%';"},
{"question":"Get the average rating for reviews mentioning 'great' and 'easy'","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(Rating AS FLOAT)) AS AverageRating FROM CourseReviews WHERE Comment LIKE N'%great%' AND Comment LIKE N'%easy%';"},
{"question":"What is the total revenue from students whose names start with 'P'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId JOIN Courses C ON E.CourseId = C.CourseId WHERE A.Role = N'Student' AND A.FullName LIKE N'P%';"},
{"question":"Find the total number of quiz attempts for courses taught by 'Dr. Brown'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(QA.AttemptId) AS TotalAttempts FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId JOIN Courses C ON L.CourseId = C.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.FullName LIKE N'Dr. Brown%';"},
{"question":"Show the ratio of published courses that contain 'Pro'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(IsPublished AS FLOAT)) AS PublishRate FROM Courses WHERE Title LIKE N'%Pro%';"},
{"question":"List courses taught by 'Admin' and their total lessons","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT C.Title, COUNT(L.LessonId) AS TotalLessons FROM Courses C LEFT JOIN Lessons L ON C.CourseId = L.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.FullName LIKE N'Admin%' GROUP BY C.Title;"},
{"question":"Get the average rating for reviews mentioning 'confusing'","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(Rating AS FLOAT)) AS AverageRating FROM CourseReviews WHERE Comment LIKE N'%confusing%';"},
{"question":"How many 'beginner' courses are in the 'Data' category","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(C.CourseId) AS TotalCourses FROM Courses C JOIN Categories CAT ON C.CategoryId = CAT.CategoryId WHERE C.Difficulty = N'beginner' AND CAT.Name LIKE N'%Data%';"},
{"question":"Find the total enrollments for courses starting with 'The'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(E.EnrollmentId) AS TotalEnrollments FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Title LIKE N'The %';"},
{"question":"List students named 'Mike' and their total quiz attempts","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, COUNT(QA.AttemptId) AS TotalAttempts FROM Accounts A LEFT JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.FullName LIKE N'Mike%' GROUP BY A.FullName;"},
{"question":"What is the average price for courses in the 'Development' category","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(C.Price) AS AveragePrice FROM Courses C JOIN Categories CAT ON C.CategoryId = CAT.CategoryId WHERE CAT.Name LIKE N'%Development%';"},
{"question":"How many 5-star reviews mention the word 'fast'","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT COUNT(ReviewId) AS TotalReviews FROM CourseReviews WHERE Rating = 5 AND Comment LIKE N'%fast%';"},
{"question":"Show the completion rate for students with '.com' emails","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId WHERE A.Email LIKE N'%.com';"},
{"question":"Get the ratio of 'quiz' lessons for courses taught by 'Professor'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN L.LessonType = N'quiz' THEN 1.0 ELSE 0.0 END) AS QuizLessonRatio FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.FullName LIKE N'%Professor%';"},
{"question":"Count quiz attempts with scores under 30 for quizzes containing 'Basic'","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(QA.AttemptId) AS TotalAttempts FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId WHERE Q.Title LIKE N'%Basic%' AND QA.Score < 30;"},
{"question":"Find total enrollments for 'advanced' courses mentioning 'Python'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(E.EnrollmentId) AS TotalEnrollments FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Difficulty = N'advanced' AND C.Title LIKE N'%Python%';"},
{"question":"What is the average rating for courses that start with 'Complete'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId WHERE C.Title LIKE N'Complete%';"},
{"question":"Show instructors named 'Sarah' and their total number of lessons","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName, COUNT(L.LessonId) AS TotalLessons FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN Lessons L ON C.CourseId = L.CourseId WHERE A.FullName LIKE N'Sarah%' GROUP BY A.FullName;"},
{"question":"How many students named 'Robert' have an average score above 80","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(A.AccountId) AS TotalStudents FROM (SELECT A.AccountId FROM Accounts A JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.FullName LIKE N'Robert%' GROUP BY A.AccountId HAVING AVG(CAST(QA.Score AS FLOAT)) > 80) AS SubQuery;"},
{"question":"Get the pass rate for quizzes in courses mentioning 'C++'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) AS PassRate FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId JOIN Courses C ON L.CourseId = L.CourseId WHERE C.Title LIKE N'%C++%';"},
{"question":"What is the total revenue from students whose names end with 'son'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId JOIN Courses C ON E.CourseId = C.CourseId WHERE A.FullName LIKE N'%son';"},
{"question":"List courses containing 'Test' and their average quiz score","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT C.Title, AVG(CAST(QA.Score AS FLOAT)) AS AverageScore FROM Courses C LEFT JOIN Lessons L ON C.CourseId = L.CourseId LEFT JOIN Quizzes Q ON L.LessonId = Q.LessonId LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId WHERE C.Title LIKE N'%Test%' GROUP BY C.Title;"},
{"question":"How many students with 'gov' emails are enrolled in 'Security' courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(DISTINCT E.AccountId) AS TotalStudents FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId JOIN Courses C ON E.CourseId = C.CourseId WHERE A.Email LIKE N'%.gov' AND C.Title LIKE N'%Security%';"},
{"question":"Show the 5-star review ratio for courses taught by instructors named 'Kim'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN CR.Rating = 5 THEN 1.0 ELSE 0.0 END) AS FiveStarRatio FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.FullName LIKE N'Kim%';"},
{"question":"Find the average rating for reviews mentioning 'beginner'","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(Rating AS FLOAT)) AS AverageRating FROM CourseReviews WHERE Comment LIKE N'%beginner%';"},
{"question":"How many 'video' lessons are in the 'Business' category","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(L.LessonId) AS TotalVideoLessons FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId JOIN Categories CAT ON C.CategoryId = CAT.CategoryId WHERE CAT.Name = N'Business' AND L.LessonType = N'video';"},
{"question":"Get the total number of quiz attempts for students named 'Linda'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(QA.AttemptId) AS TotalAttempts FROM QuizAttempts QA JOIN Accounts A ON QA.AccountId = A.AccountId WHERE A.FullName LIKE N'Linda%';"},
{"question":"List courses containing 'Math' and their average student progress","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title, AVG(E.ProgressPercent) AS AverageProgress FROM Courses C LEFT JOIN Enrollments E ON C.CourseId = E.CourseId WHERE C.Title LIKE N'%Math%' GROUP BY C.Title;"},
{"question":"Show the completion rate for students whose email contains 'school'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId WHERE A.Email LIKE N'%school%';"},
{"question":"How many courses containing 'Design' are taught by 'Dr. Evans'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(C.CourseId) AS TotalCourses FROM Courses C JOIN Accounts A ON C.InstructorId = A.AccountId WHERE C.Title LIKE N'%Design%' AND A.FullName = N'Dr. Evans';"},
{"question":"What is the average rating for reviews mentioning 'outdated'","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(Rating AS FLOAT)) AS AverageRating FROM CourseReviews WHERE Comment LIKE N'%outdated%';"},
{"question":"Get the pass rate for quizzes on 'DevOps' courses","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) AS PassRate FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId JOIN Courses C ON L.CourseId = L.CourseId WHERE C.Title LIKE N'%DevOps%';"},
{"question":"Count students named 'Daniel' who are enrolled in 'Java' courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(DISTINCT E.AccountId) AS TotalStudents FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId JOIN Courses C ON E.CourseId = C.CourseId WHERE A.FullName LIKE N'Daniel%' AND C.Title LIKE N'%Java%';"},
{"question":"Find the ratio of 'quiz' lessons for courses containing 'Test'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN L.LessonType = N'quiz' THEN 1.0 ELSE 0.0 END) AS QuizLessonRatio FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId WHERE C.Title LIKE N'%Test%';"},
{"question":"How many quiz attempts with score 100 are for quizzes mentioning 'Exam'","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(QA.AttemptId) AS TotalPerfectScores FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId WHERE Q.Title LIKE N'%Exam%' AND QA.Score = 100;"},
{"question":"Show the total revenue from courses containing 'Cloud' or 'AWS'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Title LIKE N'%Cloud%' OR C.Title LIKE N'%AWS%';"},
{"question":"What is the average rating for reviews mentioning 'great' from 'edu' students","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM CourseReviews CR JOIN Accounts A ON CR.AccountId = A.AccountId WHERE A.Email LIKE N'%.edu' AND CR.Comment LIKE N'%great%';"},
{"question":"List instructors named 'Susan' and their average course completion rate","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN Enrollments E ON C.CourseId = E.CourseId WHERE A.FullName LIKE N'Susan%' GROUP BY A.FullName;"},
{"question":"How many 'video' lessons are in courses mentioning 'Art'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(L.LessonId) AS TotalVideoLessons FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId WHERE C.Title LIKE N'%Art%' AND L.LessonType = N'video';"},
{"question":"Find the total enrollments for courses in categories containing 'Science'","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(E.EnrollmentId) AS TotalEnrollments FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId JOIN Categories CAT ON C.CategoryId = CAT.CategoryId WHERE CAT.Name LIKE N'%Science%';"},
{"question":"Get the average score for students named 'Kevin'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CAST(QA.Score AS FLOAT)) AS AverageScore FROM QuizAttempts QA JOIN Accounts A ON QA.AccountId = A.AccountId WHERE A.FullName LIKE N'Kevin%';"},
{"question":"Show total 1-star reviews for courses mentioning 'Music'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT COUNT(CR.ReviewId) AS OneStarReviews FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId WHERE C.Title LIKE N'%Music%' AND CR.Rating = 1;"},
{"question":"List courses containing 'Finance' and their total number of quizzes","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT C.Title, COUNT(Q.QuizId) AS TotalQuizzes FROM Courses C LEFT JOIN Lessons L ON C.CourseId = L.CourseId LEFT JOIN Quizzes Q ON L.LessonId = L.LessonId WHERE C.Title LIKE N'%Finance%' GROUP BY C.Title;"},
{"question":"How many students with names ending in 'son' have a pass rate above 70 percent","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(A.AccountId) AS TotalStudents FROM (SELECT A.AccountId FROM Accounts A JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.FullName LIKE N'%son' GROUP BY A.AccountId HAVING AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) > 0.7) AS SubQuery;"},
{"question":"Get the ratio of published courses for categories containing 'Business'","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(C.IsPublished AS FLOAT)) AS PublishRate FROM Courses C JOIN Categories CAT ON C.CategoryId = CAT.CategoryId WHERE CAT.Name LIKE N'%Business%';"},
{"question":"Find the total revenue from students named 'Jennifer' on 'SQL' courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId JOIN Courses C ON E.CourseId = C.CourseId WHERE A.FullName LIKE N'Jennifer%' AND C.Title LIKE N'%SQL%';"},
{"question":"How many lessons containing 'Setup' are in 'beginner' courses","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(L.LessonId) AS TotalLessons FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId WHERE L.Title LIKE N'%Setup%' AND C.Difficulty = N'beginner';"},
{"question":"Show the average rating for reviews mentioning 'love' from active students","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM CourseReviews CR JOIN Accounts A ON CR.AccountId = A.AccountId WHERE A.IsActive = 1 AND CR.Comment LIKE N'%love%';"},
{"question":"What is the average number of lessons for courses containing 'Guide'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT AVG(T.LessonCount) AS AverageLessons FROM (SELECT C.CourseId, COUNT(L.LessonId) AS LessonCount FROM Courses C LEFT JOIN Lessons L ON C.CourseId = L.CourseId WHERE C.Title LIKE N'%Guide%' GROUP BY C.CourseId) AS T;"},
{"question":"List instructors named 'Robert' and their total course revenue","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, SUM(C.Price) AS TotalRevenue FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN Enrollments E ON C.CourseId = E.CourseId WHERE A.FullName LIKE N'Robert%' GROUP BY A.FullName;"},
{"question":"How many 'quiz' lessons are in courses taught by instructors with 'org' emails","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(L.LessonId) AS TotalQuizLessons FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.Email LIKE N'%.org' AND L.LessonType = N'quiz';"},
{"question":"Get the pass rate for students named 'Jessica'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) AS PassRate FROM QuizAttempts QA JOIN Accounts A ON QA.AccountId = A.AccountId WHERE A.FullName LIKE N'Jessica%';"},
{"question":"Show the 1-star review ratio for courses in the 'Marketing' category","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN CR.Rating = 1 THEN 1.0 ELSE 0.0 END) AS OneStarRatio FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId JOIN Categories CAT ON C.CategoryId = CAT.CategoryId WHERE CAT.Name = N'Marketing';"},
{"question":"Find the total revenue from 'advanced' courses mentioning 'Java'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Difficulty = N'advanced' AND C.Title LIKE N'%Java%';"},
{"question":"How many quiz attempts with scores below 20 are from students named 'Student'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(QA.AttemptId) AS TotalAttempts FROM QuizAttempts QA JOIN Accounts A ON QA.AccountId = A.AccountId WHERE A.FullName LIKE N'Student%' AND QA.Score < 20;"},
{"question":"Get the average rating for reviews mentioning 'terrible'","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(Rating AS FLOAT)) AS AverageRating FROM CourseReviews WHERE Comment LIKE N'%terrible%';"},
{"question":"List courses containing 'Test' and their total number of 5-star reviews","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title, COUNT(CR.ReviewId) AS FiveStarReviews FROM Courses C LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId WHERE C.Title LIKE N'%Test%' AND CR.Rating = 5 GROUP BY C.Title;"},
{"question":"How many 'quiz' lessons are in courses taught by 'Professor Smith'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(L.LessonId) AS TotalQuizLessons FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.FullName = N'Professor Smith' AND L.LessonType = N'quiz';"},
{"question":"Get the completion rate for students whose names start with 'Z'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId WHERE A.FullName LIKE N'Z%';"},
{"question":"Find the total revenue from 'Data' courses sold to students with 'gmail' emails","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId JOIN Courses C ON E.CourseId = C.CourseId WHERE A.Email LIKE N'%gmail%' AND C.Title LIKE N'%Data%';"},
{"question":"Show the ratio of 5-star reviews for courses mentioning 'Exam Prep'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN CR.Rating = 5 THEN 1.0 ELSE 0.0 END) AS FiveStarRatio FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId WHERE C.Title LIKE N'%Exam Prep%';"},
{"question":"How many 'video' lessons are in courses in the 'Software' category","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(L.LessonId) AS TotalVideoLessons FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId JOIN Categories CAT ON C.CategoryId = CAT.CategoryId WHERE CAT.Name = N'Software' AND L.LessonType = N'video';"},
{"question":"List students named 'Amanda' and their average quiz score","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, AVG(CAST(QA.Score AS FLOAT)) AS AverageScore FROM Accounts A LEFT JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.FullName LIKE N'Amanda%' GROUP BY A.FullName;"},
{"question":"What is the average price for courses starting with 'Ultimate'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(Price) AS AveragePrice FROM Courses WHERE Title LIKE N'Ultimate%';"},
{"question":"Get the completion rate for students with '.net' emails","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId WHERE A.Email LIKE N'%.net';"}
{"question":"How many students have names ending with 'son'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(AccountId) AS TotalStudents FROM Accounts WHERE Role = N'Student' AND FullName LIKE N'%son';"},
{"question":"Get the average price for courses that start with 'Learn'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(Price) AS AveragePrice FROM Courses WHERE Title LIKE N'Learn%';"},
{"question":"Find the total enrollments for courses mentioning 'Python'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(E.EnrollmentId) AS TotalEnrollments FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Title LIKE N'%Python%';"},
{"question":"Show the average rating for reviews posted by students named 'Sarah'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM CourseReviews CR JOIN Accounts A ON CR.AccountId = A.AccountId WHERE A.FullName LIKE N'Sarah%';"},
{"question":"List courses containing 'JavaScript' and their total lesson count","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT C.Title, COUNT(L.LessonId) AS TotalLessons FROM Courses C LEFT JOIN Lessons L ON C.CourseId = L.CourseId WHERE C.Title LIKE N'%JavaScript%' GROUP BY C.Title;"},
{"question":"What is the average score for quizzes titled 'Chapter 1 Quiz'","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CAST(QA.Score AS FLOAT)) AS AverageScore FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId WHERE Q.Title = N'Chapter 1 Quiz';"},
{"question":"How many active students have 'edu' emails","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT COUNT(AccountId) AS TotalStudents FROM Accounts WHERE Role = N'Student' AND IsActive = 1 AND Email LIKE N'%.edu';"},
{"question":"Get the total revenue from courses taught by instructors named 'Michael'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.FullName LIKE N'Michael%';"},
{"question":"Show the 1-star review ratio for courses mentioning 'Java'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN CR.Rating = 1 THEN 1.0 ELSE 0.0 END) AS OneStarRatio FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId WHERE C.Title LIKE N'%Java%';"},
{"question":"Count 5-star reviews that contain the word 'perfect'","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT COUNT(ReviewId) AS TotalPerfectReviews FROM CourseReviews WHERE Rating = 5 AND Comment LIKE N'%perfect%';"},
{"question":"What is the average price for courses in the 'Software' category","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(C.Price) AS AveragePrice FROM Courses C JOIN Categories CAT ON C.CategoryId = CAT.CategoryId WHERE CAT.Name = N'Software';"},
{"question":"List students named 'James' and their average course completion rate","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Accounts A LEFT JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.FullName LIKE N'James%' GROUP BY A.FullName;"},
{"question":"How many total lessons are in courses mentioning 'Guide'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(L.LessonId) AS TotalLessons FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId WHERE C.Title LIKE N'%Guide%';"},
{"question":"Find the ratio of video lessons for courses about 'Design'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN L.LessonType = N'video' THEN 1.0 ELSE 0.0 END) AS VideoLessonRatio FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId WHERE C.Title LIKE N'%Design%';"},
{"question":"Get the total quiz attempts for lessons containing 'Final'","context":"CREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(QA.AttemptId) AS TotalAttempts FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId WHERE L.Title LIKE N'%Final%';"},
{"question":"Count quiz questions that contain the word 'database'","context":"CREATE TABLE QuizQuestions (QuestionId INT, QuizId INT, Question NVARCHAR(500), OptionA NVARCHAR(200), OptionB NVARCHAR(200), OptionC NVARCHAR(200), OptionD NVARCHAR(200), CorrectOption TINYINT);","answer":"SELECT COUNT(QuestionId) AS TotalQuestions FROM QuizQuestions WHERE Question LIKE N'%database%';"},
{"question":"Show the average rating for reviews from students named 'Jennifer'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM CourseReviews CR JOIN Accounts A ON CR.AccountId = A.AccountId WHERE A.FullName LIKE N'Jennifer%';"},
{"question":"List courses containing 'Cloud' and their total enrollments","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title, COUNT(E.EnrollmentId) AS TotalEnrollments FROM Courses C LEFT JOIN Enrollments E ON C.CourseId = E.CourseId WHERE C.Title LIKE N'%Cloud%' GROUP BY C.Title;"},
{"question":"Get the 1-star review ratio for courses taught by instructors named 'Smith'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN CR.Rating = 1 THEN 1.0 ELSE 0.0 END) AS OneStarRatio FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.FullName LIKE N'%Smith';"},
{"question":"How many students with 'ca' emails are enrolled in 'Data' courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(DISTINCT E.AccountId) AS TotalStudents FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId JOIN Courses C ON E.CourseId = C.CourseId WHERE A.Email LIKE N'%.ca' AND C.Title LIKE N'%Data%';"},
{"question":"List courses mentioning 'Security' and their average rating","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title, AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM Courses C LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId WHERE C.Title LIKE N'%Security%' GROUP BY C.Title;"},
{"question":"What is the total revenue from courses containing 'AI'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Title LIKE N'%AI%';"},
{"question":"How many 'text' lessons are in courses about 'History'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(L.LessonId) AS TotalTextLessons FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId WHERE C.Title LIKE N'%History%' AND L.LessonType = N'text';"},
{"question":"Get the pass rate for students whose names contain 'Brown'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) AS PassRate FROM QuizAttempts QA JOIN Accounts A ON QA.AccountId = A.AccountId WHERE A.FullName LIKE N'%Brown%';"},
{"question":"Show the 1-star review ratio for courses containing 'Masterclass'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN CR.Rating = 1 THEN 1.0 ELSE 0.0 END) AS OneStarRatio FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId WHERE C.Title LIKE N'%Masterclass%';"},
{"question":"Count students named 'Olivia' who completed courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(DISTINCT E.AccountId) AS TotalStudents FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId WHERE A.FullName LIKE N'Olivia%' AND E.IsCompleted = 1;"},
{"question":"What is the average price for courses starting with 'Mobile'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(Price) AS AveragePrice FROM Courses WHERE Title LIKE N'Mobile%';"},
{"question":"How many 'video' lessons are in courses taught by instructor 'Ryan'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(L.LessonId) AS TotalVideoLessons FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.FullName LIKE N'Ryan%' AND L.LessonType = N'video';"},
{"question":"Get the total number of quiz attempts for courses containing 'Finance'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(QA.AttemptId) AS TotalAttempts FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId JOIN Courses C ON L.CourseId = C.CourseId WHERE C.Title LIKE N'%Finance%';"},
{"question":"Find the average rating for reviews containing 'basic'","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(Rating AS FLOAT)) AS AverageRating FROM CourseReviews WHERE Comment LIKE N'%basic%';"},
{"question":"List all students with 'org' emails and their average progress","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, AVG(E.ProgressPercent) AS AverageProgress FROM Accounts A LEFT JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.Email LIKE N'%.org' GROUP BY A.FullName;"},
{"question":"How many quiz attempts with scores over 90 are for 'Python' quizzes","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(QA.AttemptId) AS TotalAttempts FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId WHERE Q.Title LIKE N'%Python%' AND QA.Score > 90;"},
{"question":"Get the completion rate for students whose names contain 'Taylor'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId WHERE A.FullName LIKE N'%Taylor%';"},
{"question":"List courses containing 'Business' and their instructor name","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);","answer":"SELECT C.Title, A.FullName FROM Courses C JOIN Accounts A ON C.InstructorId = A.AccountId WHERE C.Title LIKE N'%Business%';"},
{"question":"Show total enrollments for courses starting with 'Complete'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(E.EnrollmentId) AS TotalEnrollments FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Title LIKE N'Complete%';"},
{"question":"What is the average rating given by students with 'outlook.com' emails","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM CourseReviews CR JOIN Accounts A ON CR.AccountId = A.AccountId WHERE A.Email LIKE N'%@outlook.com';"},
{"question":"How many 'quiz' lessons are in courses containing 'Music'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(L.LessonId) AS TotalQuizLessons FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId WHERE C.Title LIKE N'%Music%' AND L.LessonType = N'quiz';"},
{"question":"Get the pass rate for quizzes containing 'Part 2'","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) AS PassRate FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId WHERE Q.Title LIKE N'%Part 2%';"},
{"question":"Show the 5-star review count for courses mentioning 'Photography'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT COUNT(CR.ReviewId) AS FiveStarReviews FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId WHERE C.Title LIKE N'%Photography%' AND CR.Rating = 5;"},
{"question":"List students named 'William' and their total completed courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, SUM(CASE WHEN E.IsCompleted = 1 THEN 1 ELSE 0 END) AS TotalCompleted FROM Accounts A LEFT JOIN Enrollments E ON A.AccountId = E.AccountId WHERE A.FullName LIKE N'William%' GROUP BY A.FullName;"},
{"question":"How many courses contain 'Data' or 'Analytics'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(CourseId) AS TotalCourses FROM Courses WHERE Title LIKE N'%Data%' OR Title LIKE N'%Analytics%';"},
{"question":"Get the average rating for reviews mentioning 'slow' and 'boring'","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(Rating AS FLOAT)) AS AverageRating FROM CourseReviews WHERE Comment LIKE N'%slow%' AND Comment LIKE N'%boring%';"},
{"question":"What is the total revenue from students whose names start with 'L'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId JOIN Courses C ON E.CourseId = C.CourseId WHERE A.Role = N'Student' AND A.FullName LIKE N'L%';"},
{"question":"Find the total quiz attempts for courses taught by 'Dr. Lee'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(QA.AttemptId) AS TotalAttempts FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId JOIN Courses C ON L.CourseId = L.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.FullName LIKE N'Dr. Lee%';"},
{"question":"Show the ratio of published courses that contain 'Bootcamp'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(IsPublished AS FLOAT)) AS PublishRate FROM Courses WHERE Title LIKE N'%Bootcamp%';"},
{"question":"List courses taught by 'Support' and their total lessons","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT C.Title, COUNT(L.LessonId) AS TotalLessons FROM Courses C LEFT JOIN Lessons L ON C.CourseId = L.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.FullName LIKE N'Support%' GROUP BY C.Title;"},
{"question":"Get the average rating for reviews mentioning 'helpful'","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(Rating AS FLOAT)) AS AverageRating FROM CourseReviews WHERE Comment LIKE N'%helpful%';"},
{"question":"How many 'advanced' courses are in the 'Technology' category","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(C.CourseId) AS TotalCourses FROM Courses C JOIN Categories CAT ON C.CategoryId = CAT.CategoryId WHERE C.Difficulty = N'advanced' AND CAT.Name LIKE N'%Technology%';"},
{"question":"Find the total enrollments for courses starting with 'Introduction'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(E.EnrollmentId) AS TotalEnrollments FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Title LIKE N'Introduction%';"},
{"question":"List students named 'Daniel' and their total quiz attempts","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, COUNT(QA.AttemptId) AS TotalAttempts FROM Accounts A LEFT JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.FullName LIKE N'Daniel%' GROUP BY A.FullName;"},
{"question":"What is the average price for courses in the 'Finance' category","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(C.Price) AS AveragePrice FROM Courses C JOIN Categories CAT ON C.CategoryId = CAT.CategoryId WHERE CAT.Name LIKE N'%Finance%';"},
{"question":"How many 5-star reviews mention the word 'clear'","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT COUNT(ReviewId) AS TotalReviews FROM CourseReviews WHERE Rating = 5 AND Comment LIKE N'%clear%';"},
{"question":"Show the completion rate for students with 'au' emails","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId WHERE A.Email LIKE N'%.au';"},
{"question":"Get the ratio of 'quiz' lessons for courses taught by 'Admin'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN L.LessonType = N'quiz' THEN 1.0 ELSE 0.0 END) AS QuizLessonRatio FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.FullName LIKE N'Admin%';"},
{"question":"Count quiz attempts with scores under 30 for quizzes containing 'Advanced'","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(QA.AttemptId) AS TotalAttempts FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId WHERE Q.Title LIKE N'%Advanced%' AND QA.Score < 30;"},
{"question":"Find total enrollments for 'intermediate' courses mentioning 'React'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(E.EnrollmentId) AS TotalEnrollments FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Difficulty = N'intermediate' AND C.Title LIKE N'%React%';"},
{"question":"What is the average rating for courses that start with 'Professional'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId WHERE C.Title LIKE N'Professional%';"},
{"question":"Show instructors named 'Laura' and their total number of lessons","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT A.FullName, COUNT(L.LessonId) AS TotalLessons FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN Lessons L ON C.CourseId = L.CourseId WHERE A.FullName LIKE N'Laura%' GROUP BY A.FullName;"},
{"question":"How many students named 'David' have an average score above 85","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(A.AccountId) AS TotalStudents FROM (SELECT A.AccountId FROM Accounts A JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.FullName LIKE N'David%' GROUP BY A.AccountId HAVING AVG(CAST(QA.Score AS FLOAT)) > 85) AS SubQuery;"},
{"question":"Get the pass rate for quizzes in courses mentioning 'Node'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) AS PassRate FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId JOIN Courses C ON L.CourseId = C.CourseId WHERE C.Title LIKE N'%Node%';"},
{"question":"What is the total revenue from students whose names end with 'Lee'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId JOIN Courses C ON E.CourseId = C.CourseId WHERE A.FullName LIKE N'%Lee';"},
{"question":"List courses containing 'Workshop' and their average quiz score","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT C.Title, AVG(CAST(QA.Score AS FLOAT)) AS AverageScore FROM Courses C LEFT JOIN Lessons L ON C.CourseId = L.CourseId LEFT JOIN Quizzes Q ON L.LessonId = Q.LessonId LEFT JOIN QuizAttempts QA ON Q.QuizId = QA.QuizId WHERE C.Title LIKE N'%Workshop%' GROUP BY C.Title;"},
{"question":"How many students with 'org' emails are enrolled in 'History' courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(DISTINCT E.AccountId) AS TotalStudents FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId JOIN Courses C ON E.CourseId = C.CourseId WHERE A.Email LIKE N'%.org' AND C.Title LIKE N'%History%';"},
{"question":"Show the 5-star review ratio for courses taught by instructors named 'Emma'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN CR.Rating = 5 THEN 1.0 ELSE 0.0 END) AS FiveStarRatio FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.FullName LIKE N'Emma%';"},
{"question":"Find the average rating for reviews mentioning 'advanced'","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(Rating AS FLOAT)) AS AverageRating FROM CourseReviews WHERE Comment LIKE N'%advanced%';"},
{"question":"How many 'video' lessons are in the 'Art' category","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(L.LessonId) AS TotalVideoLessons FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId JOIN Categories CAT ON C.CategoryId = CAT.CategoryId WHERE CAT.Name = N'Art' AND L.LessonType = N'video';"},
{"question":"Get the total number of quiz attempts for students named 'Mark'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(QA.AttemptId) AS TotalAttempts FROM QuizAttempts QA JOIN Accounts A ON QA.AccountId = A.AccountId WHERE A.FullName LIKE N'Mark%';"},
{"question":"List courses containing 'Physics' and their average student progress","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT C.Title, AVG(E.ProgressPercent) AS AverageProgress FROM Courses C LEFT JOIN Enrollments E ON C.CourseId = E.CourseId WHERE C.Title LIKE N'%Physics%' GROUP BY C.Title;"},
{"question":"Show the completion rate for students whose email contains 'mail.com'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId WHERE A.Email LIKE N'%mail.com';"},
{"question":"How many courses containing 'Python' are taught by 'Dr. White'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(C.CourseId) AS TotalCourses FROM Courses C JOIN Accounts A ON C.InstructorId = A.AccountId WHERE C.Title LIKE N'%Python%' AND A.FullName = N'Dr. White';"},
{"question":"What is the average rating for reviews mentioning 'unclear'","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(Rating AS FLOAT)) AS AverageRating FROM CourseReviews WHERE Comment LIKE N'%unclear%';"},
{"question":"Get the pass rate for quizzes on 'Cybersecurity' courses","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) AS PassRate FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId JOIN Lessons L ON Q.LessonId = L.LessonId JOIN Courses C ON L.CourseId = C.CourseId WHERE C.Title LIKE N'%Cybersecurity%';"},
{"question":"Count students named 'Grace' who are enrolled in 'Python' courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(DISTINCT E.AccountId) AS TotalStudents FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId JOIN Courses C ON E.CourseId = C.CourseId WHERE A.FullName LIKE N'Grace%' AND C.Title LIKE N'%Python%';"},
{"question":"Find the ratio of 'quiz' lessons for courses containing 'Final Project'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN L.LessonType = N'quiz' THEN 1.0 ELSE 0.0 END) AS QuizLessonRatio FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId WHERE C.Title LIKE N'%Final Project%';"},
{"question":"How many quiz attempts with score 100 are for quizzes mentioning 'Final'","context":"CREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(QA.AttemptId) AS TotalPerfectScores FROM QuizAttempts QA JOIN Quizzes Q ON QA.QuizId = Q.QuizId WHERE Q.Title LIKE N'%Final%' AND QA.Score = 100;"},
{"question":"Show the total revenue from courses containing 'Azure' or 'AWS'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Title LIKE N'%Azure%' OR C.Title LIKE N'%AWS%';"},
{"question":"What is the average rating for reviews mentioning 'fantastic' from 'edu' students","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM CourseReviews CR JOIN Accounts A ON CR.AccountId = A.AccountId WHERE A.Email LIKE N'%.edu' AND CR.Comment LIKE N'%fantastic%';"},
{"question":"List instructors named 'Jason' and their average course completion rate","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN Enrollments E ON C.CourseId = E.CourseId WHERE A.FullName LIKE N'Jason%' GROUP BY A.FullName;"},
{"question":"How many 'video' lessons are in courses mentioning 'Drawing'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(L.LessonId) AS TotalVideoLessons FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId WHERE C.Title LIKE N'%Drawing%' AND L.LessonType = N'video';"},
{"question":"Find the total enrollments for courses in categories containing 'Health'","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT COUNT(E.EnrollmentId) AS TotalEnrollments FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId JOIN Categories CAT ON C.CategoryId = CAT.CategoryId WHERE CAT.Name LIKE N'%Health%';"},
{"question":"Get the average score for students named 'Ethan'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CAST(QA.Score AS FLOAT)) AS AverageScore FROM QuizAttempts QA JOIN Accounts A ON QA.AccountId = A.AccountId WHERE A.FullName LIKE N'Ethan%';"},
{"question":"Show total 1-star reviews for courses mentioning 'Language'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT COUNT(CR.ReviewId) AS OneStarReviews FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId WHERE C.Title LIKE N'%Language%' AND CR.Rating = 1;"},
{"question":"List courses containing 'Economics' and their total number of quizzes","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);\nCREATE TABLE Quizzes (QuizId INT, LessonId INT, Title NVARCHAR(200), TotalQuestions INT);","answer":"SELECT C.Title, COUNT(Q.QuizId) AS TotalQuizzes FROM Courses C LEFT JOIN Lessons L ON C.CourseId = L.CourseId LEFT JOIN Quizzes Q ON L.LessonId = L.LessonId WHERE C.Title LIKE N'%Economics%' GROUP BY C.Title;"},
{"question":"How many students with names ending in 'ez' have a pass rate above 70 percent","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(A.AccountId) AS TotalStudents FROM (SELECT A.AccountId FROM Accounts A JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.FullName LIKE N'%ez' GROUP BY A.AccountId HAVING AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) > 0.7) AS SubQuery;"},
{"question":"Get the ratio of published courses for categories containing 'Art'","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(C.IsPublished AS FLOAT)) AS PublishRate FROM Courses C JOIN Categories CAT ON C.CategoryId = CAT.CategoryId WHERE CAT.Name LIKE N'%Art%';"},
{"question":"Find the total revenue from students named 'Sophia' on 'Python' courses","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId JOIN Courses C ON E.CourseId = C.CourseId WHERE A.FullName LIKE N'Sophia%' AND C.Title LIKE N'%Python%';"},
{"question":"How many lessons containing 'Module' are in 'intermediate' courses","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(L.LessonId) AS TotalLessons FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId WHERE L.Title LIKE N'%Module%' AND C.Difficulty = N'intermediate';"},
{"question":"Show the average rating for reviews mentioning 'love' from active instructors","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(CR.Rating AS FLOAT)) AS AverageRating FROM CourseReviews CR JOIN Accounts A ON CR.AccountId = A.AccountId WHERE A.IsActive = 1 AND A.Role = N'Instructor' AND CR.Comment LIKE N'%love%';"},
{"question":"What is the average number of lessons for courses containing 'Complete'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT AVG(T.LessonCount) AS AverageLessons FROM (SELECT C.CourseId, COUNT(L.LessonId) AS LessonCount FROM Courses C LEFT JOIN Lessons L ON C.CourseId = L.CourseId WHERE C.Title LIKE N'%Complete%' GROUP BY C.CourseId) AS T;"},
{"question":"List instructors named 'William' and their total course revenue","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT A.FullName, SUM(C.Price) AS TotalRevenue FROM Accounts A LEFT JOIN Courses C ON A.AccountId = C.InstructorId LEFT JOIN Enrollments E ON C.CourseId = E.CourseId WHERE A.FullName LIKE N'William%' GROUP BY A.FullName;"},
{"question":"How many 'quiz' lessons are in courses taught by instructors with 'edu' emails","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(L.LessonId) AS TotalQuizLessons FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.Email LIKE N'%.edu' AND L.LessonType = N'quiz';"},
{"question":"Get the pass rate for students named 'Henry'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT AVG(CASE WHEN QA.Score >= 50 THEN 1.0 ELSE 0.0 END) AS PassRate FROM QuizAttempts QA JOIN Accounts A ON QA.AccountId = A.AccountId WHERE A.FullName LIKE N'Henry%';"},
{"question":"Show the 1-star review ratio for courses in the 'Business' category","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN CR.Rating = 1 THEN 1.0 ELSE 0.0 END) AS OneStarRatio FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId JOIN Categories CAT ON C.CategoryId = CAT.CategoryId WHERE CAT.Name = N'Business';"},
{"question":"Find the total revenue from 'advanced' courses mentioning 'React'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Courses C ON E.CourseId = C.CourseId WHERE C.Difficulty = N'advanced' AND C.Title LIKE N'%React%';"},
{"question":"How many quiz attempts with scores below 20 are from students named 'Admin'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT COUNT(QA.AttemptId) AS TotalAttempts FROM QuizAttempts QA JOIN Accounts A ON QA.AccountId = QA.AccountId WHERE A.FullName LIKE N'Admin%' AND QA.Score < 20;"},
{"question":"Get the average rating for reviews mentioning 'boring'","context":"CREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CAST(Rating AS FLOAT)) AS AverageRating FROM CourseReviews WHERE Comment LIKE N'%boring%';"},
{"question":"List courses containing 'Node' and their total number of 5-star reviews","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT C.Title, COUNT(CR.ReviewId) AS FiveStarReviews FROM Courses C LEFT JOIN CourseReviews CR ON C.CourseId = CR.CourseId WHERE C.Title LIKE N'%Node%' AND CR.Rating = 5 GROUP BY C.Title;"},
{"question":"How many 'quiz' lessons are in courses taught by 'Professor Jones'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(L.LessonId) AS TotalQuizLessons FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId JOIN Accounts A ON C.InstructorId = A.AccountId WHERE A.FullName = N'Professor Jones' AND L.LessonType = N'quiz';"},
{"question":"Get the completion rate for students whose names start with 'X'","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId WHERE A.FullName LIKE N'X%';"},
{"question":"Find the total revenue from 'Design' courses sold to students with 'yahoo' emails","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT SUM(C.Price) AS TotalRevenue FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId JOIN Courses C ON E.CourseId = C.CourseId WHERE A.Email LIKE N'%yahoo%' AND C.Title LIKE N'%Design%';"},
{"question":"Show the ratio of 5-star reviews for courses mentioning 'Certification'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE CourseReviews (ReviewId INT, CourseId INT, AccountId INT, Rating INT, Comment NVARCHAR(800), CreatedAt DATETIME2);","answer":"SELECT AVG(CASE WHEN CR.Rating = 5 THEN 1.0 ELSE 0.0 END) AS FiveStarRatio FROM CourseReviews CR JOIN Courses C ON CR.CourseId = C.CourseId WHERE C.Title LIKE N'%Certification%';"},
{"question":"How many 'video' lessons are in the 'Data Science' category","context":"CREATE TABLE Categories (CategoryId INT, Code NVARCHAR(30), Name NVARCHAR(120), Description NVARCHAR(400));\nCREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);\nCREATE TABLE Lessons (LessonId INT, CourseId INT, LessonType NVARCHAR(20), Title NVARCHAR(250), Ordering INT, CreatedAt DATETIME2);","answer":"SELECT COUNT(L.LessonId) AS TotalVideoLessons FROM Lessons L JOIN Courses C ON L.CourseId = C.CourseId JOIN Categories CAT ON C.CategoryId = CAT.CategoryId WHERE CAT.Name = N'Data Science' AND L.LessonType = N'video';"},
{"question":"List students named 'Mia' and their average quiz score","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE QuizAttempts (AttemptId INT, QuizId INT, AccountId INT, StartedAt DATETIME2, SubmittedAt DATETIME2, Score INT, CorrectAnswers INT, TotalQuestions INT);","answer":"SELECT A.FullName, AVG(CAST(QA.Score AS FLOAT)) AS AverageScore FROM Accounts A LEFT JOIN QuizAttempts QA ON A.AccountId = QA.AccountId WHERE A.FullName LIKE N'Mia%' GROUP BY A.FullName;"},
{"question":"What is the average price for courses starting with 'Drawing'","context":"CREATE TABLE Courses (CourseId INT, CategoryId INT, Title NVARCHAR(200), Summary NVARCHAR(500), Difficulty NVARCHAR(20), Price DECIMAL(12,2), IsPublished BIT, InstructorId INT, CreatedAt DATETIME2);","answer":"SELECT AVG(Price) AS AveragePrice FROM Courses WHERE Title LIKE N'Drawing%';"},
{"question":"Get the completion rate for students with '.ca' emails","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Email NVARCHAR(120), PasswordHash NVARCHAR(255), Role NVARCHAR(20), IsActive BIT, CreatedAt DATETIME2);\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, CourseId INT, EnrolledOn DATETIME2, ProgressPercent REAL, IsCompleted BIT, CompletionDate DATETIME2);","answer":"SELECT AVG(CAST(E.IsCompleted AS FLOAT)) AS CompletionRate FROM Enrollments E JOIN Accounts A ON E.AccountId = A.AccountId WHERE A.Email LIKE N'%.ca';"}
{"question":"Show students whose name contains Tan and list id and name","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Student' AND FullName LIKE N'%Tan%';"}
{"question":"List students with names starting with Nhan and include joined count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS JoinedCount FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Nhan%' GROUP BY a.FullName;"}
{"question":"Get instructors whose name ends with Khang and return id and name","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Khang';"}
{"question":"Find instructors whose name contains Quan and show course count","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CourseCount FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Quan%' GROUP BY a.FullName;"}
{"question":"List courses whose title contains microservice and return id and title","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT CourseId, Title FROM Courses WHERE Title LIKE N'%microservice%';"}
{"question":"Show courses with titles starting with Design and include student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'Design%' GROUP BY c.Title;"}
{"question":"Get courses whose title ends with advanced and list id and title","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT CourseId, Title FROM Courses WHERE Title LIKE N'%advanced';"}
{"question":"Find courses whose title contains api gateway and show student count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS Students FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%api gateway%' GROUP BY c.Title;"}
{"question":"List students with name containing Thao and average progress","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, ProgressPercent REAL);","answer":"SELECT a.FullName, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Thao%' GROUP BY a.FullName;"}
{"question":"Show students whose name contains Dung and joined courses total","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Dung%' GROUP BY a.FullName;"}
{"question":"Get instructors whose name contains Huy and show id and name only","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Huy%';"}
{"question":"Find instructors with name starting with Bui and course count total","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CourseCount FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'Bui%' GROUP BY a.FullName;"}
{"question":"List courses with titles containing mongodb and student count total","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%mongodb%' GROUP BY c.Title;"}
{"question":"Show course id and title for titles that start with Build Your","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));","answer":"SELECT CourseId, Title FROM Courses WHERE Title LIKE N'Build Your%';"}
{"question":"Get courses where title ends with essentials and include instructor count","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%essentials' GROUP BY c.Title;"}
{"question":"Find courses with title containing docker swarm and average progress value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);","answer":"SELECT c.Title, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%docker swarm%' GROUP BY c.Title;"}
{"question":"List students whose name contains Nhu and attempts count total","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(qa.AttemptId) AS Attempts FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Nhu%' GROUP BY a.FullName;"}
{"question":"Show students whose name ends with Kiet and completed courses count total","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS Completed FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Kiet' GROUP BY a.FullName;"}
{"question":"Get instructors whose name contains Pham and list course count value","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CourseCount FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Pham%' GROUP BY a.FullName;"}
{"question":"Find courses whose title contains data engineering and student count value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS Students FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%data engineering%' GROUP BY c.Title;"}
{"question":"List courses with title starting with Hands On Machine and instructor names list","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS InstructorNames FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE c.Title LIKE N'Hands On Machine%' GROUP BY c.Title;"}
{"question":"Show students whose name contains Hung and average score overall value","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Hung%' GROUP BY a.FullName;"}
{"question":"Get students with names starting with Hoai and joined count total value","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Hoai%' GROUP BY a.FullName;"}
{"question":"Find instructors whose name contains Nhat and list id and name set value","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Nhat%';"}
{"question":"List courses where title contains data mining and completion ratio numeric","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT c.Title, AVG(CAST(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END AS DECIMAL(10,2))) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%data mining%' GROUP BY c.Title;"}
{"question":"Show courses whose title contains sql azure and student count numeric","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS Students FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%sql azure%' GROUP BY c.Title;"}
{"question":"Get courses whose title ends with starter and instructor count numeric","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%starter' GROUP BY c.Title;"}
{"question":"Find courses with title starting with Learn C and average progress numeric","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);","answer":"SELECT c.Title, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'Learn C%' GROUP BY c.Title;"}
{"question":"List students whose name contains Ngan and attempts this month numeric value","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, SubmittedAt DATETIME2);","answer":"SELECT a.FullName, COUNT(*) AS AttemptsThisMonth FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Ngan%' AND YEAR(qa.SubmittedAt)=YEAR(SYSUTCDATETIME()) AND MONTH(qa.SubmittedAt)=MONTH(SYSUTCDATETIME()) GROUP BY a.FullName;"}
{"question":"Show students with names ending with Long and joined courses total numeric","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Long' GROUP BY a.FullName;"}
{"question":"Get instructors whose name contains Dzung and courses taught numeric total","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CoursesTaught FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Dzung%' GROUP BY a.FullName;"}
{"question":"Find courses where title contains data pipeline and student count numeric total","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%data pipeline%' GROUP BY c.Title;"}
{"question":"List courses with titles starting with Practical Data and instructor names concat list","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS InstructorNames FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE c.Title LIKE N'Practical Data%' GROUP BY c.Title;"}
{"question":"Show students whose name contains An and average score numeric total","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%An%' GROUP BY a.FullName;"}
{"question":"Get students with names starting with Quynh and completion rate numeric total","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRate FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Quynh%' GROUP BY a.FullName;"}
{"question":"Find instructors whose name contains Tien and show id and name plain output","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Tien%';"}
{"question":"List courses where title contains code review and completion ratio numeric output","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT c.Title, AVG(CAST(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END AS DECIMAL(10,2))) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%code review%' GROUP BY c.Title;"}
{"question":"Show courses with titles starting with Advanced Java and student count numeric output","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'Advanced Java%' GROUP BY c.Title;"}
{"question":"Get courses whose title ends with compendium and instructor count numeric output","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%compendium' GROUP BY c.Title;"}
{"question":"Find courses where title contains end to end and average progress numeric output","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);","answer":"SELECT c.Title, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%end to end%' GROUP BY c.Title;"}
{"question":"List students whose name contains Phuc and attempts count numeric output total","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(qa.AttemptId) AS Attempts FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Phuc%' GROUP BY a.FullName;"}
{"question":"Show students whose name ends with Phat and joined courses numeric output total","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Phat' GROUP BY a.FullName;"}
{"question":"Get instructors whose name contains Ly and course count numeric output total","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CourseCount FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Ly%' GROUP BY a.FullName;"}
{"question":"Find courses where title contains serverless and student count numeric output total","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%serverless%' GROUP BY c.Title;"}
{"question":"List courses with titles starting with Testing and instructor names aggregate list","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS InstructorNames FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE c.Title LIKE N'Testing%' GROUP BY c.Title;"}
{"question":"Show students whose name contains Thu and average score numeric output avg","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Thu%' GROUP BY a.FullName;"}
{"question":"Get students with names starting with Linh and completion rate numeric output avg","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRate FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Linh%' GROUP BY a.FullName;"}
{"question":"Find instructors whose name contains Hanh and show id and name simple","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Hanh%';"}
{"question":"List courses where title contains kanban and completion ratio numeric output avg","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT c.Title, AVG(CAST(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END AS DECIMAL(10,2))) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%kanban%' GROUP BY c.Title;"}
{"question":"Show courses with titles starting with Kotlin and student count numeric output value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'Kotlin%' GROUP BY c.Title;"}
{"question":"Get courses whose title ends with reference guide and instructor count numeric output value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%reference guide' GROUP BY c.Title;"}
{"question":"Find courses where title contains test driven and average progress numeric output value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);","answer":"SELECT c.Title, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%test driven%' GROUP BY c.Title;"}
{"question":"List students whose name contains Tinh and attempts count numeric output value total","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(qa.AttemptId) AS Attempts FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Tinh%' GROUP BY a.FullName;"}
{"question":"Show students whose name ends with Anh and joined courses numeric output value total","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Anh' GROUP BY a.FullName;"}
{"question":"Get instructors whose name contains Bao and course count numeric output value total","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CourseCount FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Bao%' GROUP BY a.FullName;"}
{"question":"Find courses where title contains kotlin coroutines and student count numeric output value total","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%kotlin coroutines%' GROUP BY c.Title;"}
{"question":"List courses with titles starting with Core Java and instructor names aggregated","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS InstructorNames FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE c.Title LIKE N'Core Java%' GROUP BY c.Title;"}
{"question":"Show students whose name contains Vi and average score numeric overall average","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Vi%' GROUP BY a.FullName;"}
{"question":"Get students with names starting with Quoc and completion rate numeric overall average","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRate FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Quoc%' GROUP BY a.FullName;"}
{"question":"Find instructors whose name contains Tuan and show id and name simple output","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Tuan%';"}
{"question":"List courses where title contains monitoring and completion ratio numeric overall average","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT c.Title, AVG(CAST(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END AS DECIMAL(10,2))) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%monitoring%' GROUP BY c.Title;"}
{"question":"Show courses with titles starting with Clean Code and student count numeric overall value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'Clean Code%' GROUP BY c.Title;"}
{"question":"Get courses whose title ends with handbook pro and instructor count numeric overall value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%handbook pro' GROUP BY c.Title;"}
{"question":"Find courses where title contains message broker and average progress numeric overall value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);","answer":"SELECT c.Title, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%message broker%' GROUP BY c.Title;"}
{"question":"List students whose name contains Nam and attempts count numeric overall value total","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(qa.AttemptId) AS Attempts FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Nam%' GROUP BY a.FullName;"}
{"question":"Show students whose name ends with An and joined courses numeric overall value total","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%An' GROUP BY a.FullName;"}
{"question":"Get instructors whose name contains Son and course count numeric overall value total","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CourseCount FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Son%' GROUP BY a.FullName;"}
{"question":"Find courses where title contains graphql api and student count numeric overall value total","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%graphql api%' GROUP BY c.Title;"}
{"question":"List courses with titles starting with Practical SQL and instructor names combined list","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS InstructorNames FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE c.Title LIKE N'Practical SQL%' GROUP BY c.Title;"}
{"question":"Show students whose name contains Phuong and average score numeric overall value average","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Phuong%' GROUP BY a.FullName;"}
{"question":"Get students with names starting with Vy and completion rate numeric overall value average","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRate FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Vy%' GROUP BY a.FullName;"}
{"question":"Find instructors whose name contains Giang and show id and name neat output","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Giang%';"}
{"question":"List courses where title contains web api and completion ratio numeric overall value average","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT c.Title, AVG(CAST(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END AS DECIMAL(10,2))) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%web api%' GROUP BY c.Title;"}
{"question":"Show courses with titles starting with Intro to React and student count numeric overall total","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'Intro to React%' GROUP BY c.Title;"}
{"question":"Get courses whose title ends with cheatsheet and instructor count numeric overall total","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%cheatsheet' GROUP BY c.Title;"}
{"question":"Find courses where title contains secure coding and average progress numeric overall total","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);","answer":"SELECT c.Title, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%secure coding%' GROUP BY c.Title;"}
{"question":"List students whose name contains Quyen and attempts count numeric overall total value","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(qa.AttemptId) AS Attempts FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Quyen%' GROUP BY a.FullName;"}
{"question":"Show students whose name ends with Yen and joined courses numeric overall total value","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Yen' GROUP BY a.FullName;"}
{"question":"Get instructors whose name contains Minh and course count numeric overall total value","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CourseCount FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Minh%' GROUP BY a.FullName;"}
{"question":"Find courses where title contains restful and student count numeric overall total value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%restful%' GROUP BY c.Title;"}
{"question":"List courses with titles starting with Mastering SQL and instructor names combined string","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS InstructorNames FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE c.Title LIKE N'Mastering SQL%' GROUP BY c.Title;"}
{"question":"Show students whose name contains Hieu and average score numeric overall total average","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Hieu%' GROUP BY a.FullName;"}
{"question":"Get students with names starting with Hung and completion rate numeric overall total average","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRate FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Hung%' GROUP BY a.FullName;"}
{"question":"Find instructors whose name contains Khoa and show id and name tidy output","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Khoa%';"}
{"question":"List courses where title contains functional programming and completion ratio numeric overall total average","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT c.Title, AVG(CAST(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END AS DECIMAL(10,2))) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%functional programming%' GROUP BY c.Title;"}
{"question":"Show courses with titles starting with Azure and student count numeric overall grand total","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'Azure%' GROUP BY c.Title;"}
{"question":"Get courses whose title ends with basics pro and instructor count numeric overall grand total","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%basics pro' GROUP BY c.Title;"}
{"question":"Find courses where title contains stream processing and average progress numeric overall grand total","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);","answer":"SELECT c.Title, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%stream processing%' GROUP BY c.Title;"}
{"question":"List students whose name contains Quoc and attempts count numeric overall grand total value","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(qa.AttemptId) AS Attempts FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Quoc%' GROUP BY a.FullName;"}
{"question":"Show students whose name ends with Lan and joined courses numeric overall grand total value","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Lan' GROUP BY a.FullName;"}
{"question":"Get instructors whose name contains Ha and course count numeric overall grand total value","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CourseCount FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Ha%' GROUP BY a.FullName;"}
{"question":"Find courses where title contains data visualization and student count numeric overall grand total value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%data visualization%' GROUP BY c.Title;"}
{"question":"List courses with titles starting with Building and instructor names aggregated string list","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS InstructorNames FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE c.Title LIKE N'Building%' GROUP BY c.Title;"}
{"question":"Show students whose name contains Tien Dat and average score numeric overall grand total average","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Tien Dat%' GROUP BY a.FullName;"}
{"question":"Get students with names starting with Bao and completion rate numeric overall grand total average","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRate FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Bao%' GROUP BY a.FullName;"}
{"question":"Find instructors whose name contains Phuong Anh and show id and name simple clean","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Phuong Anh%';"}
{"question":"List courses where title contains cloud architecture and completion ratio numeric overall grand total average","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT c.Title, AVG(CAST(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END AS DECIMAL(10,2))) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%cloud architecture%' GROUP BY c.Title;"}
{"question":"Show courses with titles starting with Algorithms and student count numeric overall final value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'Algorithms%' GROUP BY c.Title;"}
{"question":"Get courses whose title ends with cookbook pro and instructor count numeric overall final value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%cookbook pro' GROUP BY c.Title;"}
{"question":"Find courses where title contains memory model and average progress numeric overall final value","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);","answer":"SELECT c.Title, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%memory model%' GROUP BY c.Title;"}
{"question":"List students whose name contains Nhi and attempts count numeric overall final value sum","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(qa.AttemptId) AS Attempts FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Nhi%' GROUP BY a.FullName;"}
{"question":"Show students whose name ends with Tuan and joined courses numeric overall final value sum","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(e.EnrollmentId) AS Joined FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Tuan' GROUP BY a.FullName;"}
{"question":"Get instructors whose name contains Thang and course count numeric overall final value sum","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT a.FullName, COUNT(ci.Id) AS CourseCount FROM Accounts a LEFT JOIN CourseInstructors ci ON ci.AccountId=a.AccountId WHERE a.Role=N'Instructor' AND a.FullName LIKE N'%Thang%' GROUP BY a.FullName;"}
{"question":"Find courses where title contains neural network and student count numeric overall final value sum","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%neural network%' GROUP BY c.Title;"}
{"question":"List courses with titles starting with Data Structures and instructor names combined output","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);\nCREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120));","answer":"SELECT c.Title, STRING_AGG(a.FullName, N', ') AS InstructorNames FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId LEFT JOIN Accounts a ON a.AccountId=ci.AccountId WHERE c.Title LIKE N'Data Structures%' GROUP BY c.Title;"}
{"question":"Show students whose name contains Le and average score numeric overall final value average","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE QuizAttempts (AttemptId INT, AccountId INT, Score INT);","answer":"SELECT a.FullName, AVG(CAST(qa.Score AS FLOAT)) AS AvgScore FROM Accounts a LEFT JOIN QuizAttempts qa ON qa.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'%Le%' GROUP BY a.FullName;"}
{"question":"Get students with names starting with Hien and completion rate numeric overall final value average","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));\nCREATE TABLE Enrollments (EnrollmentId INT, AccountId INT, IsCompleted BIT);","answer":"SELECT a.FullName, CAST(SUM(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END) AS DECIMAL(10,2))/NULLIF(COUNT(e.EnrollmentId),0) AS CompletionRate FROM Accounts a LEFT JOIN Enrollments e ON e.AccountId=a.AccountId WHERE a.Role=N'Student' AND a.FullName LIKE N'Hien%' GROUP BY a.FullName;"}
{"question":"Find instructors whose name contains Ngu and show id and name concise output","context":"CREATE TABLE Accounts (AccountId INT, FullName NVARCHAR(120), Role NVARCHAR(20));","answer":"SELECT AccountId, FullName FROM Accounts WHERE Role=N'Instructor' AND FullName LIKE N'%Ngu%';"}
{"question":"List courses where title contains data modeling and completion ratio numeric overall final value average","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, IsCompleted BIT);","answer":"SELECT c.Title, AVG(CAST(CASE WHEN e.IsCompleted=1 THEN 1 ELSE 0 END AS DECIMAL(10,2))) AS CompletionRatio FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%data modeling%' GROUP BY c.Title;"}
{"question":"Show courses with titles starting with Hands On Azure and student count numeric overall final total","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(DISTINCT e.AccountId) AS StudentCount FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'Hands On Azure%' GROUP BY c.Title;"}
{"question":"Get courses whose title ends with primer pro and instructor count numeric overall final total","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE CourseInstructors (Id INT, CourseId INT, AccountId INT);","answer":"SELECT c.Title, COUNT(ci.Id) AS InstructorCount FROM Courses c LEFT JOIN CourseInstructors ci ON ci.CourseId=c.CourseId WHERE c.Title LIKE N'%primer pro' GROUP BY c.Title;"}
{"question":"Find courses where title contains unit testing and average progress numeric overall final total","context":"CREATE TABLE Courses (CourseId INT, Title NVARCHAR(200));\nCREATE TABLE Enrollments (EnrollmentId INT, CourseId INT, ProgressPercent REAL);","answer":"SELECT c.Title, AVG(CAST(e.ProgressPercent AS DECIMAL(10,2))) AS AvgProgress FROM Courses c LEFT JOIN Enrollments e ON e.CourseId=c.CourseId WHERE c.Title LIKE N'%unit testing%' GROUP BY c.Title;"}
